<?xml version="1.0" encoding="UTF-8"?>
<unload unload_date="2018-04-30 19:46:47">
<sys_remote_update_set action="INSERT_OR_UPDATE">
<application display_value="Global">global</application>
<application_name>Global</application_name>
<application_scope>global</application_scope>
<application_version/>
<collisions/>
<commit_date/>
<deleted/>
<description>This update set will fix the SCTVs for Kingston. I also modernized the styles to utilize bootstrap. This also allows these to be used in Service Portal. If you want to take advantage of the Service Portal implementation, you will need to run the fix script "Setup CTVs for Service Portal" once to setup the proper widget links.</description>
<inserted/>
<name>2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027</name>
<origin_sys_id/>
<release_date/>
<remote_sys_id>d85f4093db691f04cbe7fb37bf9619ea</remote_sys_id>
<state>loaded</state>
<summary/>
<sys_class_name>sys_remote_update_set</sys_class_name>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d30e8de1dbf91744cbe7fb37bf96198e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<update_set display_value=""/>
<update_source display_value=""/>
<updated/>
</sys_remote_update_set>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_js_include_22fc8e964fe4130032617e918110c73b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_js_include"><sp_js_include action="INSERT_OR_UPDATE"><display_name>SCVarTblUtil</display_name><source>local</source><sys_class_name>sp_js_include</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 04:58:54</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>22fc8e964fe4130032617e918110c73b</sys_id><sys_mod_count>1</sys_mod_count><sys_name>SCVarTblUtil</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_ui_script display_value="SPSCVarTblUtil">f912165a4fe4130032617e918110c77a</sys_ui_script><sys_update_name>sp_js_include_22fc8e964fe4130032617e918110c73b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 05:22:22</sys_updated_on><url/></sp_js_include></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>130e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblUtil</target_name>
<type>JS Include</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_single_column_u_read_only_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_read_only" label="Read Only" language="en" table="u_catalog_table_single_column"><sys_documentation action="INSERT_OR_UPDATE"><element>u_read_only</element><help/><hint/><label>Read Only</label><language>en</language><name>u_catalog_table_single_column</name><plural>Read Onlies</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>96f609634f24130032617e918110c7ba</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Read Only</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_single_column_u_read_only_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>130e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_single_column</table>
<target_name>Catalog table single column.Read Only</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_a5c0db1b7d23150066b727b89dcacb8c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description/&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_date_time&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;alf_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-03-24 22:08:11&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;a5c0db1b7d23150066b727b89dcacb8c&lt;/sys_id&gt;&lt;sys_mod_count&gt;7&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_date_time&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_a5c0db1b7d23150066b727b89dcacb8c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-03 14:09:12&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
  &lt;g:macro name="date_time" value="${gs.nowDateTime()}" readonly="false" onchange="onChange('${jvar_name}');" /&gt;
  &lt;label for="${jvar_name}" style="display:none"&gt;${jvar_name}&lt;/label&gt;
  &lt;j:if test="${jvar_readonly == 'false'}"&gt;
	  &lt;span class="input-group "&gt;
		  &lt;input type="text" class="form-control text-align-right-ltr" id="${jvar_name}" data-type="glide_element_date_time" onchange="${jvar_onchange}" aria-required="false" name="${jvar_name}" value="${jvar_value}" style=";" /&gt;
		  &lt;span class="input-group-btn"&gt;
			  &lt;a class="btn btn-default btn-ref date_time_trigger" tabindex="-1" href="javascript:void(0)" onclick="new GwtDateTimePicker('${jvar_name}', '$[gs.getDateTimeFormat()]', true);" role="button" title="Select date and time" data-original-title="Select date"&gt;
				  &lt;span class="icon-calendar icon" aria-hidden="true"&gt;&lt;/span&gt;
				  &lt;span class="sr-only"&gt;Select date and time&lt;/span&gt;
			  &lt;/a&gt;
		  &lt;/span&gt;
	  &lt;/span&gt;
  &lt;/j:if&gt;
  &lt;j:if test="${jvar_readonly == 'true'}"&gt;
    &lt;input id="${jvar_name}" type="text" name="${jvar_name}" value="${jvar_value}" class="form-control cat_item_option" readonly="readonly" disabled="true"/&gt;
    &lt;span style="margin: 2px" /&gt;
  &lt;/j:if&gt;
  &lt;j:set var="jvar_value" value="" /&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>130e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_date_time</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_variable_u_variable_set</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_variable_set" table="u_catalog_table_variable"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Variable set</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_variable_set</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="Reference">reference</internal_type><mandatory>false</mandatory><max_length>32</max_length><name>u_catalog_table_variable</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference display_value="" name="item_option_new_set">item_option_new_set</reference><reference_cascade_rule>clear</reference_cascade_rule><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>snc-services_SHARE</sys_created_by><sys_created_on>2014-02-25 20:49:33</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>210f4053db691f04cbe7fb37bf96194f</sys_id><sys_mod_count>2</sys_mod_count><sys_name>Variable set</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_variable_u_variable_set</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-25 16:14:57</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>170e0125dbf91744cbe7fb37bf96191f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.u_variable_set</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_26a9ad123126950053e0a5578f24cfef</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Creates a date field with a calendar selector&amp;#13;
&amp;#13;
Attributes: &amp;#13;
name= name of the input field&amp;#13;
value= initial value of the field (defaults to now)&amp;#13;
readonly = defaults to false&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_date&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;steve.wilson@cs_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-30 18:59:54&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;26a9ad123126950053e0a5578f24cfef&lt;/sys_id&gt;&lt;sys_mod_count&gt;8&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_date&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_26a9ad123126950053e0a5578f24cfef&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-03 14:09:00&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
  &lt;g:macro name="date" value="${gs.now()}" readonly="false" onchange="onChange('${jvar_name}');" /&gt;
  &lt;label for="${jvar_name}" style="display:none"&gt;${jvar_name}&lt;/label&gt;
  &lt;j:if test="${jvar_readonly == 'false'}"&gt;
	  &lt;span class="input-group "&gt;
		  &lt;input type="text" class="form-control text-align-right-ltr" id="${jvar_name}" data-type="glide_element_date_time" aria-required="false" onchange="${jvar_onchange}" name="${jvar_name}" value="${jvar_value}" style=";" /&gt;
		  &lt;span class="input-group-btn"&gt;
			  &lt;a class="btn btn-default btn-ref date_time_trigger" tabindex="-1" href="javascript:void(0)" onclick="new GwtDateTimePicker('${jvar_name}', '$[gs.getDateFormat()]', false);" role="button" title="Select date and time" data-original-title="Select date"&gt;
				  &lt;span class="icon-calendar icon" aria-hidden="true"&gt;&lt;/span&gt;
				  &lt;span class="sr-only"&gt;Select date and time&lt;/span&gt;
			  &lt;/a&gt;
		  &lt;/span&gt;
	  &lt;/span&gt;
    &lt;!-- user / system date format
    &lt;a onclick="new GwtDateTimePicker('${jvar_name}', '$[gs.getDateFormat()]', false);"&gt;
      &lt;img height="16" width="16" class="button" src="images/small_calendar.gifx" alt="${gs.getMessage('Choose date...')}" title="${gs.getMessage('Choose date...')}"
        name="anchor${jvar_name}x" id="anchor${jvar_name}x" border="0" /&gt;
    &lt;/a&gt;--&gt;
  &lt;/j:if&gt;
  &lt;j:if test="${jvar_readonly == 'true'}"&gt;
    &lt;input id="${jvar_name}" type="text" name="${jvar_name}" value="${jvar_value}" class="form-control cat_item_option" readonly="readonly" disabled="true" /&gt;
  &lt;/j:if&gt;
  &lt;j:set var="jvar_value" value="" /&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>170e0125dbf91744cbe7fb37bf961922</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_date</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_43dd507804c311003a07ea20df4f9fa3</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="43dd507804c311003a07ea20df4f9fa3" sys_domain="global" table="u_catalog_table_variable" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>u_short_description</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4998e8ef4fa0130032617e918110c745</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4198e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_title</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c198e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_variable_set</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4598e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_ui_macro_name</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c598e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_result_variable</element><position>5</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4998e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_max_rows</element><position>6</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c998e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_button_position</element><position>7</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4d98e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>8</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>cd98e8ef4fa0130032617e918110c746</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_initial_table_header</element><position>9</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4198e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_allow_multiple_occurrences</element><position>10</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c198e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_disable_after_ordered</element><position>11</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4598e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_visible_summary</element><position>12</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c598e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_focus_new_row</element><position>13</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4998e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_allow_copy</element><position>14</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c998e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>15</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4d98e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_when_row_added</element><position>16</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>cd98e8ef4fa0130032617e918110c747</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_when_row_deleted</element><position>17</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4198e8ef4fa0130032617e918110c748</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>12M.u_catalog_table_variable.u_catalog_table_field.u_catalog_table_variable</element><position>18</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>c198e8ef4fa0130032617e918110c748</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type>list</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>12M.u_catalog_table_variable.u_catalog_table_single_column.u_catalog_table_variable</element><position>19</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 18:52:25</sys_created_on><sys_id>4598e8ef4fa0130032617e918110c748</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_variable" sys_domain="global" view="Default view">43dd507804c311003a07ea20df4f9fa3</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 18:52:25</sys_updated_on><sys_user/><type>list</type></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>u_catalog_table_variable</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>snc-services_SHARE</sys_created_by><sys_created_on>2014-02-19 18:10:02</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>43dd507804c311003a07ea20df4f9fa3</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_catalog_table_variable</sys_name><sys_overrides display_value="">global</sys_overrides><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_43dd507804c311003a07ea20df4f9fa3</sys_update_name><sys_updated_by>snc-services_SHARE</sys_updated_by><sys_updated_on>2014-02-19 18:10:02</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>170e0125dbf91744cbe7fb37bf961925</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_variable_u_allow_copy</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_allow_copy" table="u_catalog_table_variable"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Allow Copy</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_allow_copy</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="">boolean</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_variable</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 14:59:00</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>d933c67d4fe8130032617e918110c706</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Allow Copy</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_variable_u_allow_copy</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 14:59:00</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1b0e0125dbf91744cbe7fb37bf96191e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Allow Copy</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_script_include_8069d825048711003a07ea20df4f9f9d</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_include"&gt;&lt;sys_script_include action="INSERT_OR_UPDATE"&gt;&lt;access&gt;public&lt;/access&gt;&lt;active&gt;true&lt;/active&gt;&lt;api_name&gt;global.SCVarTblHelper&lt;/api_name&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;description/&gt;&lt;name&gt;SCVarTblHelper&lt;/name&gt;&lt;script&gt;&lt;![CDATA[var SCVarTblHelper = Class.create();

/*
SCVarTblHelper.getSCVarTblHTML('sc_req_item', '5fd55425048711003a07ea20df4f9fcf', 'ea332c7804c311003a07ea20df4f9f3a');

var gr = new GlideRecord('sc_req_item');
if (gr.get('72d39a6c6556a100075e41d38e33741f')) {
  var text = SCVarTblHelper.getSCVarTblText(gr.variable_pool.items_result);
gs.log(text);
}
*/

SCVarTblHelper.getAllCTVVariables = function() {
	var ret = [], sets = [];
	var gr = new GlideRecord('u_catalog_table_variable');
	gr.addNotNullQuery('u_variable_set');
	gr.query();
	while (gr.next()) {
		sets.push(gr.getValue('u_variable_set'));
	}
	gr = new GlideRecord('item_option_new');
	gr.addQuery('variable_set', 'IN', sets.join(','));
	gr.query();
	while (gr.next()) {
		ret.push(gr.getUniqueValue());
	}
	return ret;
};

SCVarTblHelper.getSCVarTblHTML = function(taskTbl, taskID, catTblVarID) {
  var jr = new GlideJellyRunner();
  jr.setEscaping(false);
  var macroStr = "&lt;g:inline template='SCVarTblDisplay' task_table='" + taskTbl + "' task_id='" + taskID + "' catalog_table_id='" + catTblVarID + "' /&gt;";
  var html = jr.runFromScript(macroStr);

  gs.log("taskTbl=" + taskTbl + " taskID=" + taskID + " catTblVarID=" + catTblVarID, "SCVarTblHelper");
  gs.log(html);
  return html;
};

SCVarTblHelper.getSCVarTblText = function(tableString) {

  var textLines = [];

  var svth = new SCVarTblHelper(tableString);
  svth.setMinColWidths();
  gs.log("group width=" + svth.colWidth.group);

  var rows = svth.getRows();
  for (var i = 0; i &lt; rows.length; i++) {
    var row = rows[i];
    var group = svth.getCell(row, 'group');
    var device = svth.getCell(row, 'device');
    var item = svth.getCell(row, 'item');
    var price = svth.getCell(row, 'price');
    var quantity = svth.getCell(row, 'quantity');
    var total_cost = svth.getCell(row, 'total_cost');

    if (i === 0) {
      var titleParts = [];
      var titleUnderScoreParts = [];
      titleParts.push(svth.formatColumnEntry(group.label, 'group'));
      titleParts.push(svth.formatColumnEntry(device.label, 'device'));
      titleParts.push(svth.formatColumnEntry(item.label, 'item'));
      titleParts.push(svth.formatColumnEntry(price.label, 'price'));
      titleParts.push(svth.formatColumnEntry(quantity.label, 'quantity'));
      titleParts.push(svth.formatColumnEntry(total_cost.label, 'total_cost'));

      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', group.label.length, '-'), 'group'));
      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', device.label.length, '-'), 'device'));
      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', item.label.length, '-'), 'item'));
      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', price.label.length, '-'), 'price'));
      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', quantity.label.length, '-'), 'quantity'));
      titleUnderScoreParts.push(svth.formatColumnEntry(svth.padString('', total_cost.label.length, '-'), 'total_cost'));

      textLines.push('&lt;pre style="margin: auto;"&gt;' + titleParts.join("  ") + '&lt;/pre&gt;');
      textLines.push('&lt;pre style="margin: auto;"&gt;' + titleUnderScoreParts.join("  ") + '&lt;/pre&gt;');
    }

    var rowParts = [];

    rowParts.push(svth.formatColumnEntry(group.display, 'group'));
    rowParts.push(svth.formatColumnEntry(device.display, 'device'));
    rowParts.push(svth.formatColumnEntry(item.display, 'item'));
    rowParts.push(svth.formatColumnEntry(price.display, 'price'));
    rowParts.push(svth.formatColumnEntry(quantity.display, 'quantity'));
    rowParts.push(svth.formatColumnEntry(total_cost.display, 'total_cost'));

    textLines.push('&lt;pre style="margin: auto;"&gt;' + rowParts.join("  ") + '&lt;/pre&gt;');
  }

  var str = textLines.join("\n");
  return str;
};

SCVarTblHelper.isTableVariableQuestion = function(questionID) {
  // Checks if the question id is for a results variable that would be
  // part of a catalog table variable configuration
  var gr = new GlideRecord('u_catalog_table_variable');
  if (gr.get('u_result_variable', questionID)) {
    return true;
  }
  return false;
};

SCVarTblHelper.prototype = {
  initialize: function(resultText) {
    this.tables = new JSON().decode(resultText);
    this.table = null;
    this.colWidth = {};
    if (this.tables.length &gt; 0) {
      this.table = this.tables[0];
    }
    /*
    [{
      "hdr" : "",
      "forElement" : "",
      "preFields" : [],
      "rows" : [[{
                "field" : "group",
                "label" : "Group",
                "mandatory" : true,
                "type" : "choice",
                "giveFocus" : "",
                "reference" : "u_consumable_group",
                "choiceOptions" : [{
                      "label" : "Lenovo Accessories",
                      "value" : "a12fb846654a2100075e41d38e3374eb"
                    }],
                "refQual" : "",
                "onChangeFunc" : "group_onChange",
                "cellCSS" : "min-width: 200px; max-width: 200px; padding-right: 5px;",
                "labelCSS" : "",
                "show" : "always",
                "value" : "a12fb846654a2100075e41d38e3374eb",
                "display" : "Lenovo Accessories",
                "relatedTable" : "",
                "disabled" : false
              }]]
    }]
      */

  },

  formatColumnEntry: function(value, field) {
    gs.log("format column " + field);
    return this.padStringWithSpaces(value, this.colWidth[field]);
  },

  setMinColWidths: function() {

    this.colWidth = {};

    var rows = this.getRows();
    for (var i = 0; i &lt; rows.length; i++) {
      var row = rows[i];
      for (var j = 0; j &lt; row.length; j++) {
        var cell = row[j];
        gs.log("check width for column " + cell.field);

        if (i === 0) {
          this.colWidth[cell.field] = cell.label.length;
        }

        if (cell.display.length &gt; this.colWidth[cell.field]) {
          this.colWidth[cell.field] = cell.display.length;
        }
      }
    }
  },

  padStringWithSpaces: function(n, p) {
    return this.padString(n, p, ' ');
  },

  padString: function(n, p, c) {
    var padChar = typeof c !== 'undefined' ? c : '0';
    var pad = new Array(1 + p).join(padChar);
    return (n + pad).substr(0, pad.length);
  },

  getTables: function() {
    return this.tables;
  },

  setTable: function(idx) {
    if (idx &gt;= this.tables.length) {
      this.table = null;
      return null;
    }
    this.table = this.tables[idx];
    return this.table;
  },

  getTable: function() {
    return this.table;
  },

  getRows: function() {
    if (this.table !== null) {
      return this.table.rows;
    }
    return [];
  },

  getCell: function(row, colName) {
    for (var i = 0; i &lt; row.length; i++) {
      var cell = row[i];
      if (cell.field == colName) {
        return cell;
      }
    }
    return null;
  },

  getPreFields: function() {
    if (this.table !== null) {
      return this.table.preFields;
    }
    return [];
  },

  type: "SCVarTblHelper"
};
]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_include&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-02-22 01:46:09&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;8069d825048711003a07ea20df4f9f9d&lt;/sys_id&gt;&lt;sys_mod_count&gt;6&lt;/sys_mod_count&gt;&lt;sys_name&gt;SCVarTblHelper&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_include_8069d825048711003a07ea20df4f9f9d&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-10 00:42:09&lt;/sys_updated_on&gt;&lt;/sys_script_include&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1b0e0125dbf91744cbe7fb37bf961921</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblHelper</target_name>
<type>Script Include</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_policy_4ceb55624fac130032617e918110c7b2</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_policy"&gt;&lt;sys_ui_policy action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;conditions table="u_catalog_table_field"&gt;u_typeINtext^EQ&lt;item endquery="false" field="u_type" goto="false" newquery="false" operator="IN" or="false" value="text"/&gt;&lt;item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/&gt;&lt;/conditions&gt;&lt;description/&gt;&lt;global&gt;true&lt;/global&gt;&lt;inherit&gt;false&lt;/inherit&gt;&lt;model_id/&gt;&lt;model_table/&gt;&lt;on_load&gt;true&lt;/on_load&gt;&lt;order&gt;100&lt;/order&gt;&lt;reverse_if_false&gt;true&lt;/reverse_if_false&gt;&lt;run_scripts&gt;false&lt;/run_scripts&gt;&lt;script_false&gt;&lt;![CDATA[function onCondition() {

}]]&gt;&lt;/script_false&gt;&lt;script_true&gt;&lt;![CDATA[function onCondition() {

}]]&gt;&lt;/script_true&gt;&lt;set_values/&gt;&lt;short_description&gt;Show Max Chars&lt;/short_description&gt;&lt;sys_class_name&gt;sys_ui_policy&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-02 20:02:59&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;4ceb55624fac130032617e918110c7b2&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Show Max Chars&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_policy_4ceb55624fac130032617e918110c7b2&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-02 22:52:21&lt;/sys_updated_on&gt;&lt;table&gt;u_catalog_table_field&lt;/table&gt;&lt;ui_type&gt;0&lt;/ui_type&gt;&lt;view/&gt;&lt;/sys_ui_policy&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1b0e0125dbf91744cbe7fb37bf961924</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Show Max Chars</target_name>
<type>UI Policy</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_field_u_max_chars</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_max_chars" table="u_catalog_table_field"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Max Chars</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_max_chars</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="Integer">integer</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_field</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>83bb5de24fec130032617e918110c774</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Max Chars</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_field_u_max_chars</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1f0e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column.Max Chars</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_variable_u_max_rows_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_max_rows" label="Max Rows" language="en" table="u_catalog_table_variable"><sys_documentation action="INSERT_OR_UPDATE"><element>u_max_rows</element><help>Maximum Rows allowed per table</help><hint>Maximum rows allowed per table</hint><label>Max Rows</label><language>en</language><name>u_catalog_table_variable</name><plural>Max Rows</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:31:34</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>1bd56fed4f64130032617e918110c722</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Max Rows</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_variable_u_max_rows_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 15:00:39</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1f0e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Max Rows</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_e329d825048711003a07ea20df4f9f1c</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description/&gt;&lt;media_type/&gt;&lt;name&gt;SCVarTblDisplay&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-02-22 01:45:37&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;e329d825048711003a07ea20df4f9f1c&lt;/sys_id&gt;&lt;sys_mod_count&gt;14&lt;/sys_mod_count&gt;&lt;sys_name&gt;SCVarTblDisplay&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_e329d825048711003a07ea20df4f9f1c&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-10 15:14:00&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
  &lt;g:evaluate&gt;
    var tableVarGR = new GlideRecord('u_catalog_table_variable');
    tableVarGR.get('${jvar_catalog_table_id}');
	var ctvSysID = tableVarGR.getUniqueValue();
	var title = tableVarGR.getValue('u_title') || '';
  &lt;/g:evaluate&gt;
  &lt;style&gt;
    @media screen and (max-width: 767px) {
	  
		}
		
		.table-responsive {
		  min-height: .01%;
		  overflow-x: auto;
		}
		
		div.sc-cat-var {
		  padding-top: 10px;
		}
		
		div.sc-cat-var:nth-of-type(1) {
		  padding-top: 0px;
		}
		
		.sc-var-table th {
		  font-size: 1em; 
		  white-space: nowrap;
		}
		
		.sc_editor .panel-ctv {
		  margin-left: 15px;
		  margin-right: 15px;
		}
		
		.panel-ctv .panel-heading h4 {
		  margin-top: 0px;
		  margin-bottom: 0px;
		}
		
		.item_action {
		  white-space: nowrap !important;
		  text-align: right !important;
		}
		
		.sc-cat-var .icon-add {
		  margin-right: 0px !important;
		}
		
		.sc-cat-prefields {
		  border-top-width: 0px;
		  border-bottom-width: 0px;
		  margin-top: 0px;
		  margin-bottom: 0px;
		  border-radius: 0px;
		}
		
		.sc-cat-prefields .panel-body {
		  padding: 5px;
		}
		
		.sc-cat-prefields .form-group {
		  margin-left: 0px;
		  margin-right: 0px;
		}
  &lt;/style&gt;
  &lt;j:set var="jvar_table_id" value="scvartbl_table_${ctvSysID}" /&gt;
  &lt;j:set var="jvar_table_marker" value="var_tables_${ctvSysID}" /&gt;

  &lt;g:evaluate jelly="true"&gt;
    var task = new GlideRecord(jelly.jvar_task_table);
    task.get(jelly.jvar_task_id);
    var jsonText = '' + task.variable_pool[tableVarGR.u_result_variable.name];
    var json = new JSON();
    var tables = json.decode(jsonText);
  &lt;/g:evaluate&gt;

  &lt;div class="panel panel-default panel-ctv"&gt;
	&lt;j:if test="${!tableVarGR.u_title.nil()}"&gt;
	  &lt;div class="panel-heading"&gt;
		  &lt;h4&gt;${tableVarGR.getValue('u_title')}&lt;/h4&gt;
	  &lt;/div&gt;
    &lt;/j:if&gt;
	&lt;div class="panel-body sc-var-container" id="${jvar_table_marker}" style="padding:5px;"&gt;
    &lt;j:forEach items="${tables}" var="jvar_table" indexVar="jvar_table_idx"&gt;
      &lt;g:evaluate jelly="true"&gt;
        var tableObj = jelly.jvar_table;
        var preFields = tableObj.preFields;
        var tableRows = tableObj.rows;

        var hdrTemplate = [];
        if (tableRows.length &gt; 0) {
          hdrTemplate = tableRows[0];
        }
      &lt;/g:evaluate&gt;
      &lt;j:forEach items="${preFields}" var="jvar_prefield"&gt;
        &lt;g:evaluate jelly="true"&gt;
          var preField = jelly.jvar_prefield;
          var id = preField.field;
          var label = preField.label;
          var mandatory = preField.mandatory;
          var type = preField.type;
          var reference = preField.reference;
          var refQual = preField.refQual;
          var cellCSS = preField.cellCSS;
          var labelCSS = preField.labelCSS;
          var show = preField.show;
          var choiceOptions = preField.choiceOptions;
          var value = preField.value;
          var displayValue = preField.display;
        &lt;/g:evaluate&gt;
          
      &lt;/j:forEach&gt;
      &lt;j:if test="${hdrTemplate.length &gt; 0}"&gt;
        &lt;table class="table table-striped table-bordered sc-var-table" style="margin-bottom: 0px;"&gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;j:forEach items="${hdrTemplate}" var="jvar_hdr_cell"&gt;
                &lt;g:evaluate jelly="true"&gt;
                  var cell = jelly.jvar_hdr_cell;
                  var id = cell.field;
                  var label = cell.label;
                  labelCSS = cell.labelCSS;

                  var show = cell.show;

                  var useField = true;
                  if (show != '' &amp;amp;&amp;amp; show != 'always') {
                    if (show == 'first' &amp;amp;&amp;amp; jelly.jvar_table_idx != 0) {
                      useField = false;
                    } else if (show == 'not_first' &amp;amp;&amp;amp; jelly.jvar_table_idx == 0) {
                      useField = false;
                    }
                  }
                &lt;/g:evaluate&gt;
                &lt;j:if test="${useField}"&gt;
                  &lt;th style="${labelCSS}"&gt;${label}&lt;/th&gt;
                &lt;/j:if&gt;
              &lt;/j:forEach&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;j:forEach items="${tableRows}" var="jvar_row"&gt;
            &lt;g:evaluate jelly="true"&gt;
              var cells = jelly.jvar_row;
            &lt;/g:evaluate&gt;
            &lt;tr&gt;
              &lt;j:forEach items="${cells}" var="jvar_cell"&gt;
                  &lt;g:evaluate jelly="true"&gt;
                    var cell = jelly.jvar_cell;
                    var id = cell.field;
                    var label = cell.label;
                    var mandatory = cell.mandatory;
                    var type = cell.type;
                    var reference = cell.reference;
                    var refQual = cell.refQual;
                    var cellCSS = cell.cellCSS;
                    var show = cell.show;
                    var choiceOptions = cell.choiceOptions;
                    var value = cell.value;
                    var displayValue = cell.display;

                    var useField = true;
                    if (show != '' &amp;amp;&amp;amp; show != 'always') {
                      if (show == 'first' &amp;amp;&amp;amp; jelly.jvar_table_idx != 0) {
                        useField = false;
                      } else if (show == 'not_first' &amp;amp;&amp;amp; jelly.jvar_table_idx == 0) {
                        useField = false;
                      }
                    }
                  &lt;/g:evaluate&gt;
				  &lt;td style="${cellCSS}"&gt;${displayValue}&lt;/td&gt;
              &lt;/j:forEach&gt;
            &lt;/tr&gt;
          &lt;/j:forEach&gt;
        &lt;/table&gt;
      &lt;/j:if&gt;
&lt;/j:forEach&gt;
&lt;/div&gt;
	&lt;/div&gt;
&lt;/j:jelly&gt;]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>1f0e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblDisplay</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_variable_u_max_rows</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_max_rows" table="u_catalog_table_variable"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Max Rows</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_max_rows</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="Integer">integer</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_variable</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:31:34</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>5bd56fed4f64130032617e918110c721</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Max Rows</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_variable_u_max_rows</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 03:31:34</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>530e0125dbf91744cbe7fb37bf96191f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Max Rows</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_list_u_catalog_table_field_u_catalog_table_variable_null</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_list parent="u_catalog_table_variable" relationship="" sys_domain="global" table="u_catalog_table_field" version="2" view=""><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_id</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>0</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>d75e4e2d4fa0130032617e918110c7c5</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_label</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>1</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>9f5e4e2d4fa0130032617e918110c7c5</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_type</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>2</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>135e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_order</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>3</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>935e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_mandatory</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>4</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>175e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_read_only</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>5</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>975e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_referenced_table</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>6</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>1b5e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list_element action="INSERT_OR_UPDATE"><average_value>false</average_value><element>u_reference_qualifier</element><list_id display_value="u_catalog_table_field" element="NULL" name="u_catalog_table_field" parent="u_catalog_table_variable" relationship="NULL" sys_domain="global" view="Default view">f73c19fc04c311003a07ea20df4f9f90</list_id><max_value>false</max_value><min_value>false</min_value><position>7</position><sum>false</sum><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_id>9b5e4e2d4fa0130032617e918110c7c6</sys_id><sys_mod_count>0</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on></sys_ui_list_element><sys_ui_list action="INSERT_OR_UPDATE"><average_value>false</average_value><element/><max_value>false</max_value><min_value>false</min_value><name>u_catalog_table_field</name><parent>u_catalog_table_variable</parent><position/><relationship/><sum>false</sum><sys_class_name>sys_ui_list</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:09:16</sys_created_on><sys_customer_update>false</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>f73c19fc04c311003a07ea20df4f9f90</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_catalog_table_field</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_list_u_catalog_table_field_u_catalog_table_variable_null</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:09:16</sys_updated_on><sys_user/><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_list></sys_ui_list></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>530e0125dbf91744cbe7fb37bf961922</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Variable.Catalog Table Column</target_name>
<type>List Layout</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view>Default view</view>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_script_f912165a4fe4130032617e918110c77a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_script"&gt;&lt;sys_ui_script action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;description&gt;This is a service portal implementation of some of the primary functions in SCVarTbl, but the work is done in the controller&lt;/description&gt;&lt;global&gt;false&lt;/global&gt;&lt;name&gt;SPSCVarTblUtil&lt;/name&gt;&lt;script&gt;&lt;![CDATA[function SPSCVarTblUtil() {}

SPSCVarTblUtil.prototype = {
	initialize: function(scope, g_form) {
		this.scope = scope;
		this.g_form = g_form;
		this.changingFields = {};
	},
	
	setScope: function(scope) {
		this.scope = scope;
	},
	
	setGlideForm: function(gf) {
		this.g_form = gf;
	},
	
	setFieldChanging: function(id, changing) {
		this.changingFields[id] = changing;
	},
	
	isFieldChanging: function(id) {
		return this.changingFields[id];
	},
	
	// I don't believe we will need to replicate this as it is handled in the controller
	// but leaving it here as a placeholder just in case
	createTable: function(tableHeader, tableForElementID) {
		console.warn('An implementation of this function was not carried over to Service Portal');
	},
	
	// I don't believe we will need to replicate this as it is handled in the controller
	// but leaving it here as a placeholder just in case
	deleteTable: function(element) {
		console.warn('An implementation of this function was not carried over to Service Portal');
	},
	
	setMandatory: function(fieldID, mandatory) {
		this.scope.setMandatory(fieldID, mandatory);
	},
	
	// TODO: see if this needs to be modified
	isValidDate: function(ctl) {
		var dateVal = ctl.value;
		if (dateVal &amp;&amp; dateVal !== '' &amp;&amp; !isDate(dateVal, this.userDateTimeFormat)) {
			alert("Invalid date value");
			ctl.focus();
			ctl.select();
		}
	},
	
	// this implementation was built in the controller and unlikely to be used in scripts
	// so not converted over
	clearTable: function(tbl) {
		console.warn('An implementation of this function was not carried over to Service Portal');
	},
	
	// this implementation was built in the controller and unlikely to be used in scripts
	// so not converted over
	deleteRow: function(table, e) {
		console.warn('An implementation of this function was not carried over to Service Portal');
	},
	
	getClassName: function() {
		return "SPSCVarTblUtil";
	},
	
	disableAllRows: function() {
		this.scope.c.isReadOnly = true;
	},
	
	hideAnElement: function(fldID, hide) {
		this.g_form.setDisplay(fldID, hide);
	},
	
	getResult: function() {
		return JSON.stringify(this.scope.c.buildResult().result);
	},
	
	getValue: function(fieldName, tblSeq, rowID) {
		return this.g_form.getValue(fieldName + "." + tblSeq + "." + rowID);
	},
	
	_getFieldDefinition: function(fields, fieldName) {
		for (var i = 0; i &lt; this.scope.data.fields.length; i++) {
			var field = fields[i];
			if (field.var_name == fieldName) {
				return field;
			}
		}
		return null;
	},
	
	setMandatoryCheck: function(bool) {
		this.scope.c.setCheckMandatory(bool);
	},
	
	_checkMandatoryFields: function() {
		return this.scope.c.buildResult().passMandatory;
	},
	
	setResult: function() {
		this.scope.c.setResult();
	},
	
	getTableNumberFromID: function(id) {
		// Get the number from the end of the id value. This tells us the table number
		var tableNum = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.tableSeq !== '') {
			tableNum = elementParts.tableSeq;
		}
		return tableNum;
	},
	
	getRowIDFromRow: function(dataRow, tableSeq) {
		var field;
		var firstField = null;
		for (var fIdx = 0; fIdx &lt; this.tableFields.length; fIdx++) {
			field = this.tableFields[fIdx];
			
			if (this._useField(field, tableSeq)) {
				firstField = fIdx * 1;
				break;
			}
		}
		
		if (firstField !== null) {
			var cell = dataRow.cells[firstField];
			var cellNodes = cell.childNodes;
			var cellNode = cellNodes[0];
			var type = field.type;
			
			if (field.type == 'date' || field.type == 'datetime') {
				cellNode = cellNodes[1];
			}
			
			if (cellNode !== null) {
				return this.getRowID(cellNode.id);
			}
		}
		return '-1';
	},
	
	getRowNumber: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		var rowNbr = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.rowNumber !== '') {
			rowNbr = elementParts.rowNumber;
		}
		return rowNbr;
	},
	
	getRowID: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		var rowID = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.tableSeq !== '') {
			rowID = elementParts.tableSeq;
			if (elementParts.rowNumber !== '') {
				rowID += '.' + elementParts.rowNumber;
			}
		}
		return rowID;
	},
	
	_getElementIDParts: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		if (id.substr(0, 3) == 'ni.') {
			id = id.substr(3);
		}
		var parts = id.split('.');
		
		var elementParts = {
		};
		elementParts.fieldName = parts[0];
		elementParts.tableSeq = '';
		elementParts.rowNumber = '';
		
		if (parts.length &gt; 1) {
			elementParts.tableSeq = parts[1];
			if (parts.length &gt; 2) {
				elementParts.rowNumber = parts[2];
			}
		}
		return elementParts;
	},
	
	toggleTableDisplay: function(tableID, onOff) {
		var table = this.getTableElement(tableID);
		if (table) {
			var parentDiv = table.parentNode;
			this.toggleDisplay(parentDiv, onOff);
		}
	},
	
	_getRealFieldID: function(fieldName) {
		var realName = fieldName;
		var parts = realName.split('.');
		if (parts.length &gt; 1) {
			realName = parts[1];
		}
		realName = realName.replace(/[._0-9]+$/, '');
		return realName;
	},
	
	type: "SCVarTblUtil"
};]]&gt;&lt;/script&gt;&lt;script_name/&gt;&lt;sys_class_name&gt;sys_ui_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-02 05:21:19&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;f912165a4fe4130032617e918110c77a&lt;/sys_id&gt;&lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;&lt;sys_name&gt;SPSCVarTblUtil&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_script_f912165a4fe4130032617e918110c77a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-05 14:52:02&lt;/sys_updated_on&gt;&lt;use_scoped_format&gt;false&lt;/use_scoped_format&gt;&lt;/sys_ui_script&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>530e0125dbf91744cbe7fb37bf961925</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SPSCVarTblUtil</target_name>
<type>UI Script</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_single_column_u_read_only</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_read_only" table="u_catalog_table_single_column"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Read Only</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_read_only</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="">boolean</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_single_column</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>d6f609634f24130032617e918110c7b9</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Read Only</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_single_column_u_read_only</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>570e0125dbf91744cbe7fb37bf96191e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_single_column</table>
<target_name>Catalog table single column.Read Only</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_script_fix_ac25441e4fa0130032617e918110c749</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_script_fix"&gt;&lt;sys_script_fix action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;before&gt;false&lt;/before&gt;&lt;description&gt;This script will create the necessary widgets to replace the macros in CTVs&lt;/description&gt;&lt;flush_cache&gt;false&lt;/flush_cache&gt;&lt;name&gt;Setup CTVs for Service Portal&lt;/name&gt;&lt;run_once&gt;true&lt;/run_once&gt;&lt;script&gt;&lt;![CDATA[var grCTV = new GlideRecord('u_catalog_table_variable');
grCTV.query();
while (grCTV.next()) {
	var macroID = grCTV.getValue('u_ui_macro_name');	
	// get the related macro variable
	// and update it with a widget if it doesn't have one
	var varGR = new GlideRecord('item_option_new');
	varGR.addQuery('type', 14);
	varGR.addQuery('macro', macroID);
	varGR.addNullQuery('sp_widget');
	varGR.query();
	while (varGR.next()) {
		var widgetID = '';
		var grWidget = new GlideRecord('sp_widget');
		if (grWidget.isValid()) {
			// if we don't get here, that means SP isn't installed on this instance
			grWidget.addQuery('name', 'CTV ' + grCTV.u_short_description);
			grWidget.query();
			if (!grWidget.next()) {
				grWidget.setValue('name', 'CTV ' + grCTV.u_short_description);
				grWidget.setValue('template', '&lt;sp-widget widget="data.ctvWidget"&gt;&lt;/sp-widget&gt;');
				grWidget.setValue('script', '(function() {data.ctvWidget = $sp.getWidget("catalog-table-variable", {var_id: "' + grCTV.sys_id + '"});})();');
				grWidget.insert();
			}
			widgetID = grWidget.getUniqueValue();
			if (JSUtil.notNil(widgetID)) {
				varGR.setValue('sp_widget', widgetID);
				if (varGR.changes()) {
					varGR.update();
					gs.info('SP Widget Created for ' + grCTV.u_short_description);
				}
			}
		}
	}
}]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script_fix&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-01 19:18:05&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;ac25441e4fa0130032617e918110c749&lt;/sys_id&gt;&lt;sys_mod_count&gt;1&lt;/sys_mod_count&gt;&lt;sys_name&gt;Setup CTVs for Service Portal&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_fix_ac25441e4fa0130032617e918110c749&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-01 19:20:31&lt;/sys_updated_on&gt;&lt;unloadable&gt;false&lt;/unloadable&gt;&lt;/sys_script_fix&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>570e0125dbf91744cbe7fb37bf961921</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>Setup CTVs for Service Portal</target_name>
<type>Fix Script</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_e8b01fda0fffb500d7ebc09ce1050e7e</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom choice input field used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_cell_choice_input_field&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2015-05-05 22:11:40&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;e8b01fda0fffb500d7ebc09ce1050e7e&lt;/sys_id&gt;&lt;sys_mod_count&gt;2&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_cell_choice_input_field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_e8b01fda0fffb500d7ebc09ce1050e7e&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-02-09 04:53:19&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
   &lt;g:macro name="REQUIRED" label="REQUIRED" value="" onchange="onChange('${jvar_name}');" onclick_label="" mandatory="false"/&gt;
	&lt;select name="${jvar_name}" id="${jvar_name}" onChange="${jvar_onchange}" class="form-control ${jvar_className}" style="${jvar_style}"&gt;		 
		&lt;!-- xml for element type inserted here... --&gt;
		&lt;g:insert/&gt;
	&lt;/select&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>570e0125dbf91744cbe7fb37bf961924</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_cell_choice_input_field</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_field_u_label</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_label" table="u_catalog_table_field"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Label</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>true</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_label</element><element_reference>false</element_reference><foreign_database/><internal_type display_value="String">string</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_field</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>snc-services_SHARE</sys_created_by><sys_created_on>2014-02-19 18:49:38</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>b40f0053db691f04cbe7fb37bf961944</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Label</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_field_u_label</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 23:17:08</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5b0e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column.u_label</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_variable_u_focus_new_row_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_focus_new_row" label="Focus New Row" language="en" table="u_catalog_table_variable"><sys_documentation action="INSERT_OR_UPDATE"><element>u_focus_new_row</element><help>Put focus on new added rows. This can cause the screen to jump to where the new row is</help><hint>Put focus on new added rows. This can cause the screen to jump to where the new row is</hint><label>Focus New Row</label><language>en</language><name>u_catalog_table_variable</name><plural>Focus New Rows</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:53:30</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>a4eaeba14fa4130032617e918110c7e3</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Focus New Row</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_variable_u_focus_new_row_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 14:59:51</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5b0e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Focus New Row</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_d1bf681c3196150053e0a5578f24cfaa</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom form label field used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_form_label&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services2_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-11 23:25:17&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;d1bf681c3196150053e0a5578f24cfaa&lt;/sys_id&gt;&lt;sys_mod_count&gt;9&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_form_label&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_d1bf681c3196150053e0a5578f24cfaa&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-05 20:44:43&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null"&gt;
	&lt;j:set var="jvar_mandatory" value="${jvar_mandatory}"/&gt;
    &lt;label for="${jvar_for}" dir="${jvar_label_dir}" class="control-label"&gt;
		&lt;span id="status.${jvar_for}" title="" mandatory="true" class="required-marker" data-original-title=""&gt;&lt;/span&gt;
		&lt;span title="" class="label-text" data-html="false" data-original-title=""&gt;
			&lt;g:insert/&gt;
		&lt;/span&gt;
	&lt;/label&gt;
&lt;/j:jelly&gt;]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5b0e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_form_label</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_dependency_90ec4e964fe4130032617e918110c704</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_dependency"><sp_dependency action="INSERT_OR_UPDATE"><module/><name>SCVarTblUtil</name><page_load>false</page_load><sp_portals/><sys_class_name>sp_dependency</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 04:58:35</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>90ec4e964fe4130032617e918110c704</sys_id><sys_mod_count>0</sys_mod_count><sys_name>SCVarTblUtil</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sp_dependency_90ec4e964fe4130032617e918110c704</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 04:58:35</sys_updated_on></sp_dependency></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5f0e0125dbf91744cbe7fb37bf96191c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblUtil</target_name>
<type>Widget Dependency</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_single_column_u_max_chars_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_max_chars" label="Max Chars" language="en" table="u_catalog_table_single_column"><sys_documentation action="INSERT_OR_UPDATE"><element>u_max_chars</element><help/><hint/><label>Max Chars</label><language>en</language><name>u_catalog_table_single_column</name><plural>Max Chars</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:02:07</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>fc468d234f24130032617e918110c7ff</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Max Chars</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_single_column_u_max_chars_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:02:07</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5f0e0125dbf91744cbe7fb37bf96191f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_single_column</table>
<target_name>Catalog table single column.Max Chars</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_883e4fa48782910059fb552509434d34</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom reference field used by Table variable.&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_custom_ui_reference&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2013-12-31 19:19:30&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;883e4fa48782910059fb552509434d34&lt;/sys_id&gt;&lt;sys_mod_count&gt;11&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_custom_ui_reference&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_883e4fa48782910059fb552509434d34&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-19 23:32:46&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
    &lt;g:macro name="" table="" value="" displayvalue="" show_popup="true" show_lookup="true" completer="" columns="" order_by="" query="" onchange=""/&gt;
    &lt;j:set var="jvar_question_name" value="${jvar_name}"/&gt; 
    &lt;j:set var="jvar_question_reference" value="${jvar_table}"/&gt; 
    &lt;j:set var="ref" value="${jvar_question_reference}"/&gt; 
    &lt;j:set var="jvar_question_value" value="${jvar_value}"/&gt; 
    &lt;j:set var="jvar_question_display" value="${jvar_displayvalue}"/&gt;
    &lt;j:set var="jvar_lightweight_reference_class" value="questionsetreference form-control"/&gt;
    &lt;j:if test="${!empty(jvar_query)}"&gt;
        &lt;j:set var="jvar_ref_filter" value="${jvar_query}"/&gt;
		&lt;j:set var="jvar_question_reference_qual" value="QUERY:${jvar_query}"/&gt;
    &lt;/j:if&gt;
    &lt;j:set var="jvar_show_lookup" value="${jvar_show_lookup}"/&gt;
    &lt;j:set var="jvar_show_popup" value="${jvar_show_popup}"/&gt;
    &lt;g:inline template="lightweight_reference.xml"/&gt;
&lt;/j:jelly&gt;]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>5f0e0125dbf91744cbe7fb37bf961922</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_custom_ui_reference</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_single_column_u_max_chars</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_max_chars" table="u_catalog_table_single_column"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Max Chars</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_max_chars</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="Integer">integer</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_single_column</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:02:07</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>7c468d234f24130032617e918110c7fe</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Max Chars</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_single_column_u_max_chars</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:02:07</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>930e0125dbf91744cbe7fb37bf96191e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_single_column</table>
<target_name>Catalog table single column.Max Chars</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_script_67ecf970040711003a07ea20df4f9fca</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_script"&gt;&lt;sys_script action="INSERT_OR_UPDATE"&gt;&lt;abort_action&gt;false&lt;/abort_action&gt;&lt;access/&gt;&lt;action_delete&gt;false&lt;/action_delete&gt;&lt;action_insert&gt;true&lt;/action_insert&gt;&lt;action_query&gt;false&lt;/action_query&gt;&lt;action_update&gt;true&lt;/action_update&gt;&lt;active&gt;true&lt;/active&gt;&lt;add_message&gt;false&lt;/add_message&gt;&lt;advanced&gt;true&lt;/advanced&gt;&lt;change_fields&gt;false&lt;/change_fields&gt;&lt;client_callable&gt;false&lt;/client_callable&gt;&lt;collection&gt;u_catalog_table_variable&lt;/collection&gt;&lt;condition/&gt;&lt;description/&gt;&lt;execute_function&gt;false&lt;/execute_function&gt;&lt;filter_condition/&gt;&lt;is_rest&gt;false&lt;/is_rest&gt;&lt;message/&gt;&lt;name&gt;Build variable set and ui macro&lt;/name&gt;&lt;order&gt;100&lt;/order&gt;&lt;priority&gt;100&lt;/priority&gt;&lt;rest_method/&gt;&lt;rest_method_text/&gt;&lt;rest_service/&gt;&lt;rest_service_text/&gt;&lt;rest_variables/&gt;&lt;role_conditions/&gt;&lt;script&gt;&lt;![CDATA[// updated to correct itself if anything goes missing

var macroName = current.u_short_description.toLowerCase();
macroName = macroName.toLowerCase().replace(/[^a-zA-Z0-9_]/g, '_');

// Create the variable set if required
var varset = current.getValue('u_variable_set');
if (current.u_variable_set.nil()) {
	var varSetGR = new GlideRecord('item_option_new_set');
	varSetGR.initialize();
	varSetGR.name = "CTV " + current.u_short_description;
	varset = varSetGR.insert();
	current.u_variable_set.setValue(varset);
}

// Create the ui macro
var macroString = '&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null"&gt;&lt;style&gt;tr[parent_container_id="' + varset + '"] {display: none;}&lt;/style&gt;&lt;tr&gt;&lt;td&gt;&lt;g:inline template="sc_var_table" catalog_table_id="' + current.sys_id + '" /&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/j:jelly&gt;';

var macroID = '';
var uiMacroGR = new GlideRecord('sys_ui_macro');
if (!uiMacroGR.get('name', macroName)) {
	uiMacroGR.initialize();
	uiMacroGR.name = macroName;
	uiMacroGR.xml = macroString;
}
uiMacroGR.description = 'Macro for Catalog Table Variable ' + current.u_short_description + ' [' + current.sys_id + ']';
if (uiMacroGR.isNewRecord()) {
	uiMacroGR.insert();
} else {
	uiMacroGR.update();
}
macroID = uiMacroGR.getUniqueValue();
current.u_ui_macro_name = macroID;

// create the widget if SP exists
var widgetID = '';
var grWidget = new GlideRecord('sp_widget');
if (grWidget.isValid()) {
	grWidget.addQuery('name', 'CTV ' + current.u_short_description);
	grWidget.query();
	if (!grWidget.next()) {
		grWidget.setValue('name', 'CTV ' + current.u_short_description);
		grWidget.setValue('template', '&lt;sp-widget widget="data.ctvWidget"&gt;&lt;/sp-widget&gt;');
		grWidget.setValue('script', '(function() {data.ctvWidget = $sp.getWidget("catalog-table-variable", {var_id: "' + current.sys_id + '"});})();');
		grWidget.insert();
	}
	widgetID = grWidget.getUniqueValue();
}

// Create the macro variable
var varGR = new GlideRecord('item_option_new');
varGR.addQuery('type', 14);
varGR.addQuery('name', macroName);
varGR.addQuery('macro', macroID);
varGR.query();
if (!varGR.next()) {
	varGR.initialize();
	varGR.type = 14;
	varGR.name = macroName;
	varGR.macro = macroID;
}
if (JSUtil.notNil(widgetID)) {
	varGR.sp_widget = widgetID;
}
varGR.question_text = current.u_short_description;
varGR.variable_set = varset;
varGR.visible_summary = false;
varGR.order = 100;
if (varGR.isNewRecord()) {
	varGR.insert();
} else {
	varGR.update();
}

// Create the result variable
varGR = new GlideRecord('item_option_new');
varGR.addQuery('type', 2);
varGR.addQuery('name', macroName + '_result');
varGR.query();
if (!varGR.next()) {
	varGR.initialize();
	varGR.type = 2;
	varGR.name = macroName + '_result';
}
varGR.question_text = current.u_short_description + " Result";
varGR.variable_set = varset;
varGR.visible_summary = true;
varGR.order = 999;
if (varGR.isNewRecord()) {
	varGR.insert();
} else {
	varGR.update();
}

current.u_result_variable = varGR.sys_id;]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-02-20 01:21:56&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;67ecf970040711003a07ea20df4f9fca&lt;/sys_id&gt;&lt;sys_mod_count&gt;15&lt;/sys_mod_count&gt;&lt;sys_name&gt;Build variable set and ui macro&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_script_67ecf970040711003a07ea20df4f9fca&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-08 20:05:53&lt;/sys_updated_on&gt;&lt;template/&gt;&lt;when&gt;before&lt;/when&gt;&lt;/sys_script&gt;&lt;sys_translated_text action="delete_multiple" query="documentkey=67ecf970040711003a07ea20df4f9fca"/&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>930e0125dbf91744cbe7fb37bf961921</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Build variable set and ui macro</target_name>
<type>Business Rule</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_e7c1bcd83196150053e0a5578f24cfe4</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom multi line input field used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_multiline_input_field&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services2_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-11 23:31:12&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;e7c1bcd83196150053e0a5578f24cfe4&lt;/sys_id&gt;&lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_multiline_input_field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_e7c1bcd83196150053e0a5578f24cfe4&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-02-09 04:55:03&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
   &lt;g:macro type="text" name="REQUIRED" label="REQUIRED" value="" onkeyup="" onchange="onChange('${jvar_name}');" onclick_label="" mandatory="false" size="" style="width: 100%" rows="5" readonly="false"/&gt;
   &lt;table class="wide"&gt;
     &lt;tr&gt;
       &lt;td id="label.${jvar_name}" class="label" nowrap="true" type="string" choice="0" oncontextmenu="${jvar_oncontextmenu}"&gt;
         &lt;g:inline template="cs_form_label" onclick="${jvar_onclick_label}" for="${jvar_name}"&gt; ${jvar_label}:&lt;/g:inline&gt;
       &lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
       &lt;td nowrap="true" style="width: 100%;"&gt;
         &lt;j:if test="${jvar_readonly == 'false'}"&gt;
	   &lt;textarea id="${jvar_name}" class="form-control" style="${jvar_style}" rows="${jvar_rows}" onkeyup="${jvar_onkeyup}" 
		name="${ref}" wrap="soft" onChange="${jvar_onchange}" size="${jvar_size}"&gt; 
		${jvar_value}&lt;/textarea&gt;
         &lt;/j:if&gt;
         &lt;j:if test="${jvar_readonly == 'true'}"&gt;
	   &lt;textarea class="form-control disabled" id="${jvar_name}" style="${jvar_style};border: 0px solid" rows="${jvar_rows}" onkeyup="${jvar_onkeyup}" name="${ref}" wrap="soft" onChange="${jvar_onchange}" size="${jvar_size}" readonly="readonly"&gt; 
		${jvar_value}&lt;/textarea&gt;
         &lt;/j:if&gt;
       &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>930e0125dbf91744cbe7fb37bf961924</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_multiline_input_field</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_choice_u_catalog_table_variable_u_button_position</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_choice action="INSERT_OR_UPDATE" field="u_button_position" table="u_catalog_table_variable" version="3"><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>u_button_position</element><hint/><inactive>false</inactive><label>Right</label><language>en</language><name>u_catalog_table_variable</name><sequence>10</sequence><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:29:09</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>8f35a7ed4f64130032617e918110c767</sys_id><sys_mod_count>1</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 14:07:46</sys_updated_on><value>right</value></sys_choice><sys_choice action="INSERT_OR_UPDATE"><dependent_value/><element>u_button_position</element><hint/><inactive>false</inactive><label>Left</label><language>en</language><name>u_catalog_table_variable</name><sequence>20</sequence><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:29:21</sys_created_on><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>325567ed4f64130032617e918110c75c</sys_id><sys_mod_count>1</sys_mod_count><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 14:07:50</sys_updated_on><value>left</value></sys_choice><sys_choice_set action="INSERT_OR_UPDATE"><element>u_button_position</element><name>u_catalog_table_variable</name><sys_class_name>sys_choice_set</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:29:09</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>c855afad4f64130032617e918110c779</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_button_position</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_choice_u_catalog_table_variable_u_button_position</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 03:29:09</sys_updated_on></sys_choice_set></sys_choice></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>970e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Button Position</target_name>
<type>Choice list</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_variable_u_button_position_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_button_position" label="Button Position" language="en" table="u_catalog_table_variable"><sys_documentation action="INSERT_OR_UPDATE"><element>u_button_position</element><help>Position of the action buttons in the table</help><hint>Position of the action buttons in the table</hint><label>Button Position</label><language>en</language><name>u_catalog_table_variable</name><plural>Button Positions</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:28:10</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>6515e3ed4f64130032617e918110c7aa</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Button Position</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_variable_u_button_position_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 15:01:04</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>970e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Button Position</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_c5fc3cf83146d10053e0a5578f24cf94</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom checkbox used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_custom_ui_checkbox&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;valor.poland@cs_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-01 03:21:44&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;c5fc3cf83146d10053e0a5578f24cf94&lt;/sys_id&gt;&lt;sys_mod_count&gt;12&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_custom_ui_checkbox&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_c5fc3cf83146d10053e0a5578f24cf94&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-05 20:39:34&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
  &lt;g:macro name="REQUIRED" readonly="false" label="" onchange="onChange('${jvar_name}');" /&gt;
	&lt;div class="sc_checkbox"&gt;
	&lt;span class="input-group-checkbox"&gt;
  &lt;j:if test="${jvar_readonly == 'false'}"&gt;
    &lt;j:if test="${jvar_value == 'true' || jvar_value == 'Yes'}"&gt;
      &lt;input type="checkbox" id="ni.${jvar_name}" name="ni.${jvar_name}" checked="checked" value="true" class="checkbox ${jvar_class}" onClick="setCheckBox(this);${jvar_onchange};" /&gt;
    &lt;/j:if&gt;

    &lt;j:if test="${!(jvar_value == 'true' || jvar_value == 'Yes')}"&gt;
      &lt;input type="checkbox" id="ni.${jvar_name}" name="ni.${jvar_name}" value="false" class="checkbox ${jvar_class}" onClick="setCheckBox(this);${jvar_onchange};" /&gt;
    &lt;/j:if&gt;
  &lt;/j:if&gt;
  &lt;j:if test="${jvar_readonly == 'true'}"&gt;
    &lt;j:if test="${jvar_value == 'true' || jvar_value == 'Yes'}"&gt;
      &lt;input type="checkbox" id="ni.${jvar_name}" name="ni.${jvar_name}" checked="checked" value="true" class="checkbox ${jvar_class}" onClick="setCheckBox(this);${jvar_onchange};"
        readonly="readonly" disabled="true"/&gt;
    &lt;/j:if&gt;

    &lt;j:if test="${!(jvar_value == 'true' || jvar_value == 'Yes')}"&gt;
      &lt;input type="checkbox" id="ni.${jvar_name}" name="ni.${jvar_name}" value="false" class="checkbox ${jvar_class}" onClick="setCheckBox(this);${jvar_onchange};" readonly="readonly" disabled="true" /&gt;
    &lt;/j:if&gt;
  &lt;/j:if&gt;
	&lt;span id="status.${jvar_name}" mandatory="false" oclass="" class=" required-marker"&gt;&lt;/span&gt;
    &lt;label aria-hidden="true" for="ni.${jvar_name}" id="ni.${jvar_name}_label" dir="ltr" class=" checkbox-label"&gt;
		${jvar_label}
	&lt;/label&gt;
	&lt;/span&gt;
  &lt;input type="hidden" id="${jvar_name}" name="${jvar_name}" value="${jvar_value}" class="${jvar_class}" /&gt;
	&lt;/div&gt;
&lt;/j:jelly&gt;]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>970e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_custom_ui_checkbox</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>m2m_sp_widget_dependency_dd3d42d64fe4130032617e918110c742</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="m2m_sp_widget_dependency"><m2m_sp_widget_dependency action="INSERT_OR_UPDATE"><sp_dependency display_value="SCVarTblUtil">90ec4e964fe4130032617e918110c704</sp_dependency><sp_widget display_value="Catalog Table Variable">03bbdcf24f10130032617e918110c73a</sp_widget><sys_class_name>m2m_sp_widget_dependency</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 04:59:40</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>dd3d42d64fe4130032617e918110c742</sys_id><sys_mod_count>0</sys_mod_count><sys_name>SCVarTblUtil.Catalog Table Variable</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>m2m_sp_widget_dependency_dd3d42d64fe4130032617e918110c742</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 04:59:40</sys_updated_on></m2m_sp_widget_dependency></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9b0e0125dbf91744cbe7fb37bf96191c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblUtil.Catalog Table Variable</target_name>
<type>Widget Dependency</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_field_u_read_only_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_read_only" label="Read Only" language="en" table="u_catalog_table_field"><sys_documentation action="INSERT_OR_UPDATE"><element>u_read_only</element><help/><hint/><label>Read Only</label><language>en</language><name>u_catalog_table_field</name><plural>Read Onlies</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:07:53</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>0b0e8a2d4fa0130032617e918110c70d</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Read Only</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_field_u_read_only_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:07:53</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9b0e0125dbf91744cbe7fb37bf96191f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column.Read Only</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_82c0f81c3196150053e0a5578f24cffa</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom input field used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_input_field&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services2_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-11 23:27:18&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;82c0f81c3196150053e0a5578f24cffa&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_input_field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_82c0f81c3196150053e0a5578f24cffa&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-02-09 04:55:38&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
   &lt;g:macro type="text" name="REQUIRED" label="REQUIRED" value="" onkeyup="" onchange="onChange('${jvar_name}');" onclick_label="" mandatory="false" size="" style="" readonly="false" maxlength=""/&gt;
   &lt;table&gt;
     &lt;tr&gt;
       &lt;td height="23px" id="label.${jvar_name}" class="label" nowrap="true" type="string" choice="0" oncontextmenu="${jvar_oncontextmenu}"&gt;
         &lt;g:inline template="cs_form_label" onclick="${jvar_onclick_label}" for="${jvar_name}"&gt; ${jvar_label}:&lt;/g:inline&gt;
       &lt;/td&gt;
       &lt;td nowrap="true" style="${jvar_style};"&gt;
         &lt;j:if test="${jvar_readonly == 'false'}"&gt;
           &lt;input type="${jvar_type}" name="${jvar_name}" id="${jvar_name}" value="${jvar_value}" onkeyup="${jvar_onkeyup}" class="form-control" onchange="${jvar_onchange}" size="${jvar_size}" style="${jvar_style}" maxlength="${jvar_maxlength}"/&gt;
         &lt;/j:if&gt;
         &lt;j:if test="${jvar_readonly == 'true'}"&gt;
           &lt;input type="${jvar_type}" class="form-control" readonly="readonly" name="${jvar_name}" id="${jvar_name}" value="${jvar_value}" onkeyup="${jvar_onkeyup}" onchange="${jvar_onchange}" size="${jvar_size}" style="border:0px;background:transparent" maxlength="${jvar_maxlength}"/&gt;
         &lt;/j:if&gt;
       &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9b0e0125dbf91744cbe7fb37bf961922</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_input_field</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_74f35d7c04c311003a07ea20df4f9f92</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="74f35d7c04c311003a07ea20df4f9f92" sys_domain="global" table="u_catalog_table_single_column" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>16f609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_catalog_table_variable</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>96f609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_id</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1af609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_label</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9af609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_type</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1ef609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_location</element><position>5</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9ef609634f24130032617e918110c7d2</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_show</element><position>6</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>12f609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_max_chars</element><position>7</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>92f609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>8</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>16f609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_order</element><position>9</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>96f609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_repeat_with_table</element><position>10</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1af609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_mandatory</element><position>11</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9af609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_give_focus</element><position>12</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1ef609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_read_only</element><position>13</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9ef609634f24130032617e918110c7d3</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_label_css</element><position>14</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>12f609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_cell_css</element><position>15</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>92f609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>16</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>16f609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>17</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>96f609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_referenced_table</element><position>18</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1af609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_reference_qualifier</element><position>19</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9af609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_icon</element><position>20</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>1ef609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_choice_list</element><position>21</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>9ef609634f24130032617e918110c7d4</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>22</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>12f609634f24130032617e918110c7d5</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>23</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>92f609634f24130032617e918110c7d5</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_on_change</element><position>24</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>16f609634f24130032617e918110c7d5</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_on_click</element><position>25</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-05 21:05:13</sys_created_on><sys_id>96f609634f24130032617e918110c7d5</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_single_column" sys_domain="global" view="Default view">74f35d7c04c311003a07ea20df4f9f92</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-05 21:05:13</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>u_catalog_table_single_column</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>snc-services_SHARE</sys_created_by><sys_created_on>2014-02-19 22:06:21</sys_created_on><sys_customer_update>false</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>74f35d7c04c311003a07ea20df4f9f92</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_catalog_table_single_column</sys_name><sys_overrides display_value="">global</sys_overrides><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_74f35d7c04c311003a07ea20df4f9f92</sys_update_name><sys_updated_by>snc-services_SHARE</sys_updated_by><sys_updated_on>2014-02-19 22:06:21</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9b0e0125dbf91744cbe7fb37bf961925</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_single_column</table>
<target_name>Catalog table single column</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_variable_u_focus_new_row</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_focus_new_row" table="u_catalog_table_variable"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice/><choice_field/><choice_table/><column_label>Focus New Row</column_label><comments/><create_roles/><default_value>true</default_value><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_focus_new_row</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="">boolean</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_variable</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:53:30</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>e4eaeba14fa4130032617e918110c7e2</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Focus New Row</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_variable_u_focus_new_row</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 03:53:46</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9f0e0125dbf91744cbe7fb37bf96191e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Focus New Row</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_action_4a6478ea4f6c130032617e918110c78a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_action"&gt;&lt;sys_ui_action action="INSERT_OR_UPDATE"&gt;&lt;action_name/&gt;&lt;active&gt;true&lt;/active&gt;&lt;client&gt;true&lt;/client&gt;&lt;comments/&gt;&lt;condition&gt;gs.hasRole("admin")&lt;/condition&gt;&lt;form_action&gt;true&lt;/form_action&gt;&lt;form_button&gt;false&lt;/form_button&gt;&lt;form_context_menu&gt;true&lt;/form_context_menu&gt;&lt;form_link&gt;false&lt;/form_link&gt;&lt;form_style/&gt;&lt;hint&gt;Export all Variable Data related to this variable for importing in another instance&lt;/hint&gt;&lt;list_action&gt;false&lt;/list_action&gt;&lt;list_banner_button&gt;false&lt;/list_banner_button&gt;&lt;list_button&gt;false&lt;/list_button&gt;&lt;list_choice&gt;false&lt;/list_choice&gt;&lt;list_context_menu&gt;false&lt;/list_context_menu&gt;&lt;list_link&gt;false&lt;/list_link&gt;&lt;list_save_with_form_button&gt;false&lt;/list_save_with_form_button&gt;&lt;list_style/&gt;&lt;name&gt;Export to XML&lt;/name&gt;&lt;onclick&gt;exportToXMLCTV()&lt;/onclick&gt;&lt;order&gt;200&lt;/order&gt;&lt;script&gt;&lt;![CDATA[function exportToXMLCTV() {
	var url = new GlideURL('export_ctv.do');
	url.addParam('sysparm_sys_id', gel("sys_uniqueValue").value);
	window.location.href=url.getURL();
}]]&gt;&lt;/script&gt;&lt;show_insert&gt;false&lt;/show_insert&gt;&lt;show_multiple_update&gt;false&lt;/show_multiple_update&gt;&lt;show_query&gt;false&lt;/show_query&gt;&lt;show_update&gt;true&lt;/show_update&gt;&lt;sys_class_name&gt;sys_ui_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-02 17:10:11&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;4a6478ea4f6c130032617e918110c78a&lt;/sys_id&gt;&lt;sys_mod_count&gt;0&lt;/sys_mod_count&gt;&lt;sys_name&gt;Export to XML&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_action_4a6478ea4f6c130032617e918110c78a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-02 17:10:11&lt;/sys_updated_on&gt;&lt;table&gt;u_catalog_table_variable&lt;/table&gt;&lt;ui11_compatible&gt;true&lt;/ui11_compatible&gt;&lt;ui16_compatible&gt;false&lt;/ui16_compatible&gt;&lt;/sys_ui_action&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9f0e0125dbf91744cbe7fb37bf961921</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Export to XML</target_name>
<type>UI Action</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_script_cc35a569fc4e01003a07c0c5e73ae7a3</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_script"&gt;&lt;sys_ui_script action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;description/&gt;&lt;global&gt;false&lt;/global&gt;&lt;name&gt;SCVarTblUtil&lt;/name&gt;&lt;script&gt;&lt;![CDATA[// Helper function to define a single table field

function SCVarTbl_defineTableField(id, label, type, mandatory, readOnly, giveFocus, onChangeFunc, reference, refQual, choiceOptions, cellCSS, labelCSS, show, onclick, imageSrc, maxLength) {
	var field = {
	};
	field.id = '';
	field.label = '';
	field.mandatory = '';
	field.readOnly = '';
	field.type = '';
	field.giveFocus = '';
	field.reference = '';
	field.choiceOptions = '';
	field.refQual = '';
	field.onChangeFunc = '';
	field.cellCSS = '';
	field.labelCSS = '';
	field.show = '';
	field.onclick = '';
	field.imageSrc = '';
	field.maxLength = '';
	
	field.id = id;
	
	if (label) {
		field.label = label;
	} else {
		field.label = id;
	}
	if (mandatory) {
		field.mandatory = mandatory;
	}
	if (mandatory != true) {
		field.readOnly = readOnly;
	}
	if (type) {
		field.type = type;
	}
	if (giveFocus) {
		field.giveFocus = giveFocus;
	}
	if (reference) {
		field.reference = reference;
	}
	if (choiceOptions) {
		// This should be a JSON string
		field.choiceOptions = choiceOptions.evalJSON();
	}
	if (refQual) {
		field.refQual = refQual;
		// alert("set rq=" + refQual);
	}
	if (onChangeFunc) {
		field.onChangeFunc = onChangeFunc;
		field.onChange = new Function('ctl', 'SCVarTbl', 'isSP', onChangeFunc);
	}
	if (cellCSS) {
		field.cellCSS = cellCSS;
	}
	if (labelCSS) {
		field.labelCSS = labelCSS;
	}
	if (show) {
		field.show = show;
	}
	if (onclick) {
		field.onclick = onclick;
		field.onClick = new Function('ctl', 'SCVarTbl', 'isSP', onclick);
	}
	if (imageSrc) {
		field.imageSrc = imageSrc;
	}
	if (maxLength) {
		field.maxLength = maxLength;
	}
	return field;
}

// Create the table handling object
function SCVarTbl_createTableUtil(tableProperties, tableFields, preTableRepeatFields, postTableRepeatFields, preTableFields, postTableFields) {
	SCVarTbl = new SCVarTblUtil(tableProperties, tableFields, preTableRepeatFields, postTableRepeatFields, preTableFields, postTableFields);
	return SCVarTbl;
}

function SCVarTbl_reflistOpen(target, elementName, refTableName, dependent, useQBE, refQualElements, additionalQual) {
	var url = reflistOpenUrl(target, target, elementName, refTableName, dependent, useQBE, refQualElements, additionalQual);
	SCVarTbl_popupOpenStandard(url, "lookup");
}

function SCVarTbl_popupOpenStandard(url, name) {
	var width = 700;
	var height = 480;
	var features = "width=" + width + ",height=" + height + ",toolbar=no,status=no,directories=no,menubar=no,resizable=yes,scrollbars=1";
	popupOpenFocus(url, name, width, height, features, snapToLastMousePosition, false);
}

function SCVarTbl_addEvent(evt, fn, useCapture) {
	if (this.addEventListener) {
		this.addEventListener(evt, fn, useCapture);
		return true;
	} else if (this.attachEvent) {
		var r = this.attachEvent('on' + evt, fn);
		return r;
	} else {
		this['on' + evt] = fn;
	}
}

var SCVarTblUtil = Class.create();

// these functions will be used to help facilitate multiple vars on a single page
SCVarTblUtil.instances = [];

// gets the SCVarTbl instance from an html element
SCVarTblUtil.getInstanceFromControl = function(ctl) {
	var ret = null;
	var prnt = $j(ctl).closest('.sc-var-container');
	if (prnt.length &gt; 0) {
		ret = SCVarTblUtil.getInstance(prnt[0].id);
	}
	return ret;
};

SCVarTblUtil.getInstance = function(key) {
	var ret = null;
	if (!key) {
		if (SCVarTblUtil.instances.length == 1) {
			ret = SCVarTblUtil.instances[0];
		}
		return ret;
	}
	key = key.toLowerCase();
	for (var i=0; i&lt;SCVarTblUtil.instances.length; i++) {
		if (SCVarTblUtil.instances[i].resultVariable.toLowerCase().indexOf(key) &gt;= 0) {
			ret = SCVarTblUtil.instances[i];
			break;
		}
		if (SCVarTblUtil.instances[i].tableMarker.toLowerCase().indexOf(key) &gt;= 0) {
			ret = SCVarTblUtil.instances[i];
			break;
		}
		// see if this is a table id and if it matches the instances base table name
		if (key.indexOf(SCVarTblUtil.instances[i].tableName.toLowerCase()) &gt;= 0) {
			ret = SCVarTblUtil.instances[i];
			break;
		}
	}
	return ret;
};

SCVarTblUtil.isValidDate = function(ctl) {
	var dateVal = ctl.value;
	if (dateVal &amp;&amp; dateVal !== '' &amp;&amp; !isDate(dateVal, this.userDateTimeFormat)) {
		alert("Invalid date value");
		ctl.focus();
		ctl.select();
	}
};
		
SCVarTblUtil.setAlert = function(tblID, msg, type) {
	var inst = SCVarTblUtil.getInstance(tblID);
	if (inst) {
		inst.setAlert(tblID, msg, type);
	}
};

SCVarTblUtil.clearAlert = function(tblID) {
	var inst = SCVarTblUtil.getInstance(tblID);
	if (inst) {
		inst.clearAlert(tblID);
	}
};

SCVarTblUtil.cellChanged = function(ctl) {
	var inst = SCVarTblUtil.getInstanceFromControl(ctl);
	if (inst) {
		inst.cellChanged(ctl);
	}
};

SCVarTblUtil.buttonClicked = function(ctl) {
	var inst = SCVarTblUtil.getInstanceFromControl(ctl);
	if (inst) {
		inst.buttonClicked(ctl);
	}
};

SCVarTblUtil.fieldChanged = function(ctl) {
	var inst = SCVarTblUtil.getInstanceFromControl(ctl);
	if (inst) {
		inst.fieldChanged(ctl);
	}
};

SCVarTblUtil.addInstance = function(scv) {
	if (!SCVarTblUtil.getInstance(scv.resultVariable)) {
		SCVarTblUtil.instances.push(scv);
	}
};

// resets all instances and reloads
// useful if you want to set the result var after initial load and
// force the tables to refresh
SCVarTblUtil.resetAll = function() {
	for (var i=0; i&lt;SCVarTblUtil.instances.length; i++) {
		if (SCVarTblUtil.instances[i] &amp;&amp; 
			typeof SCVarTblUtil.instances[i].onLoad == 'function') {
			SCVarTblUtil.instances[i].deleteTables();
			SCVarTblUtil.instances[i].onLoad();
		}
	}
};

SCVarTblUtil.setAllResults = function() {
	var ret = true;
	for (var i=0; i&lt;SCVarTblUtil.instances.length; i++) {
		if (SCVarTblUtil.instances[i] &amp;&amp; 
			typeof SCVarTblUtil.instances[i].getResult == 'function') {
			var test = SCVarTblUtil.instances[i].setResult();
			if (!test) {
				ret = false;
			}
		}
	}
	return ret;
};

SCVarTblUtil.prototype = {
	initialize: function(tableProperties, tableFields, preTableRepeatFields, postTableRepeatFields, preTableFields, postTableFields) {
		
		/*
 		* NOT YET IMPLEMENTED
 		* postTableRepeatFields, preTableFields, postTableFields
 		*/
		
		// this object holds any fields that are in the middle of changing
		// we need this to avoid infinite loops on change events
		this.changingFields = {
		};
		
		this.debug = false;
		
		this.userDateTimeFormat = g_user_date_format;
		
		this.tableFields = tableFields;
		this.preTableRepeatFields = preTableRepeatFields;
		this.postTableRepeatFields = postTableRepeatFields;
		this.preTableFields = preTableFields;
		this.postTableFields = postTableFields;
		
		// Set up table fields
		this.fieldNames = [];
		this.requiredFields = [];
		this.focusField = '';
		this.isOnLoad = false;
	
		var field;
		for (var i = 0; i &lt; this.tableFields.length; i++) {
			field = this.tableFields[i];
			this.fieldNames.push(field.id);
			if (field.mandatory) {
				this._setMandatory(this.requiredFields, field, i, true);
			}
			if (field.giveFocus) {
				this.focusField = i;
			}
		}
		
		// Set up pre-table fields
		this.preFieldNames = [];
		this.requiredPreFields = [];
		this.focusPreField = '';
		
		for (i = 0; i &lt; this.preTableRepeatFields.length; i++) {
			field = this.preTableRepeatFields[i];
			this.preFieldNames.push(field.id);
			if (field.mandatory) {
				this._setMandatory(this.requiredPreFields, field, i, true);
			}
			if (field.giveFocus) {
				this.focusPreField = i;
			}
		}
		
		this.tableMarker = tableProperties.tableMarker;
		this.tableLabel = tableProperties.tableLabel;
		this.tableName = tableProperties.tableName;
		this.ctvID = tableProperties.sysID;
		this.tableCount = 0;
		this.cellCount = this.fieldNames.length + 1; // There are 1 button icon cells
		this.movedRows = 0;
		this.totalRows = 0;
		this.headerRows = 1;
		this.unMoved = [];
		this.moved = [];
		this.resultVariable = tableProperties.resultVariable;
		this.doCheckMandatory = true;
		this.onDelete = null;
		if (tableProperties.onDelete &amp;&amp; tableProperties.onDelete != '') {
			this.onDelete = new Function('tableID', 'SCVarTbl', 'isSP', tableProperties.onDelete);
		}
		this.onAdd = null;
		if (tableProperties.onAdd &amp;&amp; tableProperties.onAdd != '') {
			this.onAdd = new Function('tableID', 'rowID', 'SCVarTbl', 'onLoad', 'isSP', tableProperties.onAdd);
		}
		this.allowMultiple = tableProperties.allowMultiple == 'true' ? true : false;
		this.allowCopy = tableProperties.allowCopy == 'true' ? true : false;
		this.disableAfterOrder = tableProperties.disableAfterOrdered == 'true' ? true : false;
		this.maxRows = parseInt(tableProperties.maxRows || 1000);
		if (this.maxRows &lt;= 0) {
			this.maxRows = 1000;
		}
		this.focusNew = tableProperties.focusNew == 'true' ? true : false;
		this.buttonPosition = tableProperties.buttonPosition || 'right';
		if (!this.focusNew) {
			this.focusField = '';
		}
		this.typeDefinition = [];
		
	},
	
	setFieldChanging: function(id, changing) {
		id = id.replace(/\./g, "_");
		this.changingFields[id] = changing;
	},
	
	isFieldChanging: function(id) {
		id = id.replace(/\./g, "_");
		return this.changingFields[id];
	},
	
	createTable: function(tableHeader, tableForElementID) {
		this.tableCount++;
		var self = this;
		var divID = 'div_' + this.tableName + "_" + this.tableCount;
		var tableID = this.tableName + "_" + this.tableCount;
		
		var tblSection = this.getTableMarker();
		if (!tblSection) {
			return;
		}
		
		var div = this._createDocumentElement('div');
		div.id = divID;
		div.className = 'sc-cat-var table-responsive';
		/*if (this.tableCount &gt; 1) {
			div.style.paddingTop = '20px';
		}*/
		
		tblSection.appendChild(div);
		
		var alertDiv = this._createDocumentElement('div');
		alertDiv.className = "alert alert-ctv alert-dismissible";
		alertDiv.style.display = "none";
		alertDiv.style.marginBottom = '5px';
		alertDiv.style.marginTop = '5px';
		alertDiv.innerHTML = '&lt;span class="close" style="cursor:pointer;" onclick="SCVarTblUtil.clearAlert(\'' + tableID + '\');" aria-label="Close"&gt;&lt;/span&gt;&lt;span class="alert-msg"&gt;&lt;/span&gt;';
		div.appendChild(alertDiv);
		
		var focusElement = null;
		
		if (tableHeader || this.allowMultiple) {
			var headerDiv = this._createDocumentElement('div');
			headerDiv.className = 'well well-sm clearfix sc-table-heading';
			headerDiv.style.padding = '5px';
			headerDiv.style.marginBottom = '0px';
			div.appendChild(headerDiv);
			
			var btn = this._createDocumentElement('button');
			btn.id = "add_table." + tableID;
			btn.className = "btn btn-default float-right actions-add-table";
			btn.innerHTML = "Add table";
			btn.type = "button";
			if (this.allowMultiple) {
				oc = function() {
					var table = self.createTable();
					self.addRow(table);
				};
				btn.onclick = oc;
			} else {
				btn.style.display = 'none';
			}
			
			headerDiv.appendChild(btn);
			
			if (this.tableCount &gt; 1) {
				btn = this._createDocumentElement('button');
				btn.id = "delete_table." + tableID;
				btn.className = "btn btn-default float-right actions-delete-table";
				btn.innerHTML = "Delete table";
				btn.type = "button";
				
				if (this.allowMultiple) {
					oc = function() {
						self.deleteTable(this);
					};
					btn.onclick = oc;
				} else {
					btn.style.display = 'none';
				}
				
				headerDiv.appendChild(btn);
			}
			
			if (tableHeader) {
				var headerSpan = this._createDocumentElement('h5');
				headerSpan.innerHTML = tableHeader;
				headerDiv.appendChild(headerSpan);
			}
			
			var oc = null;
		}
		var i;
		var field;
		if (this.preTableRepeatFields.length &gt; 0) {
			var preDiv = document.createElement('div');
			preDiv.className = 'panel panel-default sc-cat-prefields';
			div.appendChild(preDiv);
			var preDivBd = document.createElement('div');
			preDivBd.className = 'panel-body';
			preDiv.appendChild(preDivBd);
			for (i = 0; i &lt; this.preTableRepeatFields.length; i++) {
				field = this.preTableRepeatFields[i];
				if (!this._useField(field, this.tableCount)) {
					continue;
				}
				var newElement = this.createPreTableElement(field, this.tableCount, i);
				preDivBd.appendChild(newElement);
				if (i == this.focusField) {
					focusElement = newElement;
				}
			}
		}
		
		var table = document.createElement('table');
		//table.style.tableLayout = "fixed";
		table.className = "sc-var-table table table-bordered";
		div.appendChild(table);
		
		//table.cellPadding = "0";
		//table.cellSpacing = "0";
		table.id = tableID;
		table.style.marginBottom = "0px";
		table.setAttribute("table_rows", 0);
		table.setAttribute("table_seq", this.tableCount);
		if (tableHeader) {
			table.setAttribute("table_hdr", tableHeader);
		}
		if (tableForElementID) {
			table.setAttribute("for_element", tableForElementID);
		}
		
		// Create the header row
		var header = table.createTHead();
		var row = header.insertRow(0);
		//row.className = "header";
		
		var cellIdx = 0;
		
		// Add the header for the add button
		if (this.buttonPosition == 'left'/* &amp;&amp; (!this.disableAfterOrdered() || this.isCatalogForm())*/) {
			this.addAddRowButton(table, row, cellIdx++, "add_row", "Add row", '');
		}
		
		for (i = 0; i &lt; this.tableFields.length; i++) {
			field = this.tableFields[i];
			if (!this._useField(field, this.tableCount)) {
				continue;
			}
			this.addHeaderCell(row, cellIdx, field.type, field.id, field.label, field.labelCSS, field.mandatory);
			cellIdx++;
		}
		
		table.createTBody();
		
		// Add the header for the add button
		if (this.buttonPosition == 'right' /*&amp;&amp; (!this.disableAfterOrdered() || this.isCatalogForm())*/) {
			this.addAddRowButton(table, row, cellIdx++, "add_row", "Add row", '');
		}
		
		if (this._isTableDisplayed(table) &amp;&amp; focusElement &amp;&amp; this.focusNew) {
			focusElement.focus();
		}
		
		// put the alert at the top and bottom of the table
		alertDiv = this._createDocumentElement('div');
		alertDiv.className = "alert alert-ctv alert-dismissible";
		alertDiv.style.display = "none";
		alertDiv.style.marginBottom = '5px';
		alertDiv.style.marginTop = '5px';
		alertDiv.innerHTML = '&lt;span class="close" style="cursor:pointer;" onclick="SCVarTblUtil.clearAlert(\'' + tableID + '\');" aria-label="Close"&gt;&lt;/span&gt;&lt;span class="alert-msg"&gt;&lt;/span&gt;';
		div.appendChild(alertDiv);
		
		return table;
	},
	
	addAddRowButton: function(table, row, idx, id, label, labelCSS) {
		var cell = document.createElement('th');
		row.appendChild(cell);
		if (labelCSS) {
			cell.style.cssText = labelCSS;
		} else {
			cell.style.cssText = "text-align: right; white-space: nowrap;";
		}
		var self = this;
		var oc1 = function() {
			self.clearTable(table);
		};
		var btn = this._createDocumentElement('button');
		btn.id = id + '_' + this.tableName;
		btn.className = "btn btn-default icon-trash actions-clear";
		btn.onclick = oc1;
		btn.style.cssText = "margin-right: 5px;";
		btn.title = "Clear Table";
		btn.type = "button";
		cell.appendChild(btn);
		
		oc = function() {
			self.addRow(table);
		};
		
		btn = this._createDocumentElement('button');
		btn.id = id + '_' + this.tableName;
		btn.className = "btn btn-default icon-add actions-add";
		btn.onclick = oc;
		//btn.style.cssText = "margin-right: 2px;";
		btn.title = "Add Row";
		btn.type = "button";
		cell.appendChild(btn);
	},
	
	addHeaderCell: function(row, idx, type, id, label, labelCSS, mandatory) {
		var cell = document.createElement('th');
		row.appendChild(cell);
		var innerHTML = '&lt;span id="status.' + id + '"';
		if (mandatory &amp;&amp; type != 'button') {
			innerHTML += ' style="margin-right: 5px;" title="Mandatory - must be populated before Submit" mandatory="true" oclass="mandatory" class="mandatory" &gt;&amp;nbsp;&lt;/span&gt;';
		} else {
			innerHTML += ' title="" mandatory="false" oclass="" class="" &gt;&amp;nbsp;&lt;/span&gt;';
		}
		if (type != 'button') {
			innerHTML += label;
		}
		
		cell.innerHTML = innerHTML;
		if (labelCSS) {
			cell.style.cssText = labelCSS;
		}
	},
	
	deleteTable: function(element) {
		var parts = element.id.split('.');
		if (parts.length &lt; 2) {
			alert("Invalid or unknown element id " + element.id);
			return;
		}
		var tblDiv = this.getTableDivision(parts[1]);
		if (tblDiv) {
			tblDiv.parentNode.removeChild(tblDiv);
		}
	},
	
	addRow: function(table) {
		if (!table) {
			return;
		}
		var x = 0;
		var rowCounter = table.getAttribute("table_rows");
		var tableSeq = table.getAttribute("table_seq");
		
		try {
			if (table.tBodies[0].rows.length &gt;= this.maxRows) {
				return null;
			}
			var row = table.tBodies[0].insertRow(-1);
			rowCounter++;
			table.setAttribute("table_rows", rowCounter);
			row.setAttribute('row_seq', rowCounter);
			var rowID = tableSeq + "." + rowCounter;
			
			var cellIdx = 0;
			
			for (var i = 0; i &lt; this.tableFields.length; i++) {
				var field = this.tableFields[i];
				if (!this._useField(field, tableSeq)) {
					continue;
				}
				this.createElement(table, row, cellIdx, field.id, rowID, field.type, field);
				if (field.readOnly == true &amp;&amp; field.mandatory != true) {
					this.disableACell(null, field, true, tableSeq, rowCounter);
				}
				cellIdx++;
			}
			
			// Add Add cell
			//this.createElement(table, row, cellIdx++, 'add', rowID, 'add');
			
			// Add Remove cell
			var btnPos = 0;
			if (this.buttonPosition == 'right') {
				btnPos = cellIdx++;
			}
			this.createElement(table, row, btnPos, 'actions', rowID, 'actions');
			
			// Only set field focus if the table is being shown
			if (this._isTableDisplayed(table) &amp;&amp; this.focusField != '') {
				// Set focus, timeout was required - use 3 seconds to allow for all fields to render
				var focusField = '' + this.fieldNames[this.focusField] + rowID;
				setTimeout("if (gel('" + focusField + "')) gel('" + focusField + "').focus();", 3000);
			}
			var self = this;
			if (this.onAdd &amp;&amp; typeof this.onAdd == 'function' &amp;&amp; (!this.disableAfterOrdered() || this.isCatalogForm())) {
				this.onAdd(tableSeq, rowID, self, this.isOnLoad, false);
			}
			
			x = row.rowIndex;
		} catch (ex) {
			this.handle_exception('addRow', ex);
		}
		this.checkRowCount(table);
		return rowCounter;
	},
	
	checkRowCount: function(table) {
		if (table.tBodies[0].rows.length &gt;= this.maxRows) {
			// use jquery to show the alerts and disable the buttons
			$j('#div_' + table.id + ' .actions-add').prop('disabled', true);
			$j('#div_' + table.id + ' .actions-copy').prop('disabled', true);
			this.setAlert(table.id, "You have reached the maximum number of rows allowed (" + this.maxRows + ")", "warning");
			return true;
		} else {
			$j('#div_' + table.id + ' .actions-add').prop('disabled', false);
			$j('#div_' + table.id + ' .actions-copy').prop('disabled', false);
			this.clearAlert(table.id);
			return false;
		}
	},
	
	setAlert: function(tbl, msg, type) {
		var alert = $j('#div_' + tbl + ' .alert-ctv');
		alert.removeClass("alert-danger alert-info alert-warning alert-success");
		alert.addClass("alert-" + type);
		$j('#div_' + tbl + ' .alert-msg').html(msg);
		alert.show();
	},
	
	clearAlert: function(tbl) {
		$j('#div_' + tbl + ' .alert-ctv').hide();
	},
	
	copyRow: function(table, row) {
		var rw = this.addRow(table);
		if (!rw) {
			return;
		}
		var srcSeq = row.getAttribute('row_seq');
		var destSeq = rw;
		var tblSeq = table.getAttribute('table_seq');
		for (var f=0; f&lt;this.tableFields.length; f++) {
			if (this.tableFields[f].type == 'button') {
				// don't do anything here
				continue;
			}
			var fid = this.tableFields[f].id;
			var destid = fid+"."+tblSeq+"."+destSeq;
			var srcid = fid+"."+tblSeq+"."+srcSeq;
			// if we can get the display value do it here to save a round trip to the server
			var dv = $j('#display_hidden\\.'+fid+"\\."+tblSeq+"\\."+srcSeq).val();
			g_form.setValue(destid, g_form.getValue(srcid), dv);
		}
	},
	
	_registerField: function(field, id) {
		// this registers the field with g_form so the g_form functions will work properly
		try {
			if (typeof field == 'undefined' || !field) {
				return;
			}
			var type = field.type || '';
			if (type == 'number' || type == 'text' || type == 'choice') {
				type = 'string';
			} else if (type == 'datetime') {
				type = 'glide_date_time';
			} else if (type == 'date') {
				type = 'glide_date';
			} else if (type == 'checkbox') {
				type = 'boolean';
			} else if (type == 'button' || type == '') {
				// we don't need to register this type
				return;
			}
			if (g_sc_form &amp;&amp;
				SCUIElementFactory &amp;&amp;
			typeof g_sc_form.getSCUIElement(id) == 'undefined') {
				var nameElement = new NameMapEntry(id, id, '');
				g_form.addNameMapEntry(nameElement);
				var glideUIElement = new GlideUIElement('variable', id, type, false, field.reference || 'null', '', 'global');
				g_form.addGlideUIElement(glideUIElement);
				g_sc_form.addSCUIElement(id, SCUIElementFactory.createUIElement('variable', id, type, false, field.reference || 'null', '', 'global', id));
			}
		} catch(e) {
			this.handle_exception('_registerField', e);
		}
	},
	
	_useField: function(field, tableIdx) {
		// If this field is only on the first table and this is not the first table then skip it
		// If this field is not to be on the first table and this is the first table then skip it
		if (field.show !== '' &amp;&amp; field.show != 'always') {
			if (field.show == 'first' &amp;&amp; tableIdx &gt; 1) {
				return false;
			} else if (field.show == 'not_first' &amp;&amp; tableIdx == 1) {
				return false;
			}
		}
		return true;
	},
	
	setMandatory: function(fieldID, mandatory) {
		for (var i = 0; i &lt; this.tableFields.length; i++) {
			var field = this.tableFields[i];
			if (field.id == fieldID) {
				this._setMandatory(this.requiredFields, field, i, mandatory);
				break;
			}
		}
	},
	
	_setMandatory: function(requiredFields, field, fieldIdx, mandatory) {
		field.mandatory = mandatory;
		
		var isThere = false;
		for (var j = 0; j &lt; requiredFields.length; j++) {
			var cellIdx = requiredFields[j];
			if (this.buttonPosition == 'left') {
				cellIdx++;
			}
			if (cellIdx == fieldIdx) {
				isThere = true;
				break;
			}
		}
		if (mandatory &amp;&amp; !isThere) {
			requiredFields.push(fieldIdx);
		} else if (!mandatory &amp;&amp; isThere) {
			requiredFields.splice(j, 1);
		}
	},
	
	getHeaderRowCount: function() {
		return this.headerRows;
	},
	
	getDataRowCount: function(table) {
		return this.getRowCount(table) - this.headerRows;
	},
	
	getElement: function(row, fieldName) {
		return document.getElementById(fieldName + '' + row);
	},
	
	createElement: function(table, row, cellIdx, name, rowID, type, field) {
		
		// Implemented types:
		// checkbox
		// reference
		// date
		// datetime
		// text
		// button
		// Choice (drop down)
		// actions - special cell to hold removal and copy buttons
		// add - special button to add a row
		
		var reference = null;
		var choiceOptions = null;
		var refQual = null;
		var onChangeFunc = null;
		var cellCSS = null;
		var label = null;
		var imageSrc = null;
		var onclick = null;
		var origElm;
		var self = this;
		
		if (field) {
			reference = field.reference;
			choiceOptions = field.choiceOptions;
			refQual = field.refQual;
			onChangeFunc = field.onChangeFunc;
			cellCSS = field.cellCSS;
			label = field.label;
			onclick = field.onclick;
			imageSrc = field.imageSrc;
		}
		
		var element = null;
		var id = name + '.' + rowID + '';
		
		var tableIsShowing = this._isTableDisplayed(table);
		
		var isFocus = false;
		if (this.focusNew &amp;&amp; cellIdx == this.focusField &amp;&amp; tableIsShowing) {
			isFocus = true;
		}
		
		var cell = row.insertCell(cellIdx);
		cell.noWrap = "nowrap";
		
		if (cellCSS) {
			cell.style.cssText = cellCSS;
		}
		
		if (type == 'checkbox') {
			cell.style.textAlign = 'center';
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		if (type == 'reference') {
			// alert("rq=" + refQual);
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		if (type == 'date') {
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		if (type == 'datetime') {
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		if (type == 'text') {
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		if (type == 'choice') {
			this._getHTMLFromTemplate(id, cell, name, rowID, isFocus, field);
			this._registerField(field, id);
			return;
		}
		
		var oc;
		var span;
		var btn;
		var img;
		
		if (type == 'actions') {
			cell.scope = "row";
			cell.className = "item_action";
			
			oc = function() {
				self.deleteRow(table, row);
			};
			
			btn = this._createDocumentElement('button');
			btn.className = "filterTableAction btn btn-default icon-cross deleteButton";
			btn.onclick = oc;
			btn.title = "Delete Row";
			btn.type = "button";
			cell.appendChild(btn);
			if (this.allowCopy) {
				var oc1 = function() {
					self.copyRow(table, row);
				};
				btn = this._createDocumentElement('button');
				btn.className = "btn btn-default icon-copy actions-copy";
				btn.style.marginLeft = "5px";
				btn.onclick = oc1;
				btn.title = "Copy Row";
				btn.type = "button";
				cell.appendChild(btn);
			}
		} else if (type == 'add') {
			cell.scope = "row";
			cell.className = "item_action";
			
			img = this._createDocumentElement('img');
			img.width = "16";
			img.height = "16";
			img.src = "add_table_row.pngx";
			img.className = "clsshort button";
			img.title = "Add row";
			img.id = "add_row." + rowID;
			
			oc = function() {
				self.addRow(table);
			};
			img.onclick = oc;
			
			cell.appendChild(img);
			
			var img2 = this._createDocumentElement('img');
			img2.width = "0";
			img2.height = "16";
			img2.src = "images/s.gifx";
			img2.className = "clsshort button";
			cell.appendChild(img2);
		} else if (type == 'button') {
			cell.scope = "row";
			cell.className = "item_action";
			if (!imageSrc) {
				btn = this._createDocumentElement('button');
				btn.id = id;
				btn.type = "button";
				btn.className = "btn btn-default";
				btn.setAttribute('onclick', "SCVarTblUtil.buttonClicked(this)");
				btn.style.cssText = "white-space: nowrap";
				btn.innerHTML = label;
				cell.appendChild(btn);
			} else {
				span = this._createDocumentElement('span');
				var link = this._createDocumentElement('a');
				link.id = id;
				link.className = "request_catalog_button_with_icon";
				link.style.cssText = "text-align: center;padding: 0px;";
				link.setAttribute('onclick', "SCVarTblUtil.buttonClicked(this)");
				link.title = label;
				link.style.cssText = "text-align: left; border: none;";
				img = this._createDocumentElement('img');
				img.src = imageSrc;
				link.appendChild(img);
				link.href = "javascript:void(0);";
				span.appendChild(link);
				cell.appendChild(span);
			}
		} else if (type == 'number') {
			element = this._createDocumentElement('input', id);
			element.type = "number";
			element.name = id;
			element.id = id;
			element.className = "form-control";
			if (cellCSS) {
				element.style.cssText = cellCSS;
			}
			if (field &amp;&amp; field.maxLength != '') {
				element.setAttribute('maxlength', field.maxLength);
			}
			oc = "SCVarTblUtil.cellChanged(this);";
			element.setAttribute('onchange', oc);
			
			cell.appendChild(element);
			origElm = this._createDocumentElement('input', 'sys_original.' + id);
			origElm.type = 'hidden';
			origElm.id = 'sys_original.' + id;
		} else { // Assume text
			element = this._createDocumentElement('input', id);
			element.type = "text";
			element.name = id;
			element.id = id;
			element.className = "form-control";
			if (cellCSS) {
				element.style.cssText = cellCSS;
			}
			if (field &amp;&amp; field.maxLength != '') {
				element.setAttribute('maxlength', field.maxLength);
			}
			oc = "SCVarTblUtil.cellChanged(this);";
			element.setAttribute('onchange', oc);
			cell.appendChild(element);
			origElm = this._createDocumentElement('input', 'sys_original.' + id);
			origElm.type = 'hidden';
			origElm.id = 'sys_original.' + id;
		}
		this._registerField(field, id);
		// Only set field focus if the table is being shown
		if (isFocus) {
			gel(id).focus();
		}
	},
	
	_getHTMLFromTemplate: function(id, cell, name, rowID, isFocus, field) {
		
		// Look for a template element first
		var html = '';
		var ctl = gel('zztemplate' + name + '.' + this.ctvID + '.zz');
		if (ctl) {
			html = ctl.innerHTML;
		}
		
		if (html !== '') {
			html = html.replace(/__row__/g, rowID);
			cell.innerHTML = html;
			ctl = gel(id);
			if (ctl &amp;&amp; field &amp;&amp; field.maxLength != '' &amp;&amp; 
				(field.type == 'text' || field.type == 'number')) {
				ctl.setAttribute('maxlength', field.maxLength);
			}
			if (isFocus) {
				// check for reference field
				ctl = gel('sys_display.' + id);
				if (ctl &amp;&amp; ctl.focus) {
					ctl.focus();
				} else {
					ctl = gel(id);
					if (ctl &amp;&amp; ctl.focus) {
						ctl.focus();
					}
				}
			}
		}
	},
	
	createPreTableElement: function(field, tIdx, fIdx) {
		
		// Implemented types:
		// checkbox
		// reference
		// date
		// datetime
		// text
		// multiline text
		// Choice (drop down)
		
		var label = null;
		var reference = null;
		var choiceOptions = null;
		var refQual = null;
		var onChangeFunc = null;
		var cellCSS = null;
		var type = null;
		var imageSrc = null;
		var onclick = null;
		if (field) {
			label = field.label;
			reference = field.reference;
			choiceOptions = field.choiceOptions;
			refQual = field.refQual;
			onChangeFunc = field.onChangeFunc;
			cellCSS = field.cellCSS;
			type = field.type;
			onclick = field.onclick;
			imageSrc = field.imageSrc;
		}
		
		var element = null;
		var id = field.id + '.' + tIdx + '';
		
		var div = this._createDocumentElement('div');
		div.className = "form-group";
		if (field.mandatory) {
			div.className += " is-required";
		}
		if (type == 'button') {
			var span = this._createDocumentElement('span');
			var link = this._createDocumentElement('a');
			link.id = id;
			link.className = "btn btn-default";
			if (cellCSS) {
				link.style.cssText += cellCSS;
			}
			
			link.setAttribute('onclick', "SCVarTblUtil.buttonClicked(this)");
			link.title = label;
			if (imageSrc) {
				link.style.cssText = "text-align: left; border: none;";
				img = this._createDocumentElement('img');
				img.src = imageSrc;
				link.appendChild(img);
			} else {
				link.innerHTML = label;
			}
			link.href = "javascript:void(0);";
			
			span.appendChild(link);
			div.appendChild(span);
		} else {
			this._getPreTableHTMLFromTemplate(id, div, field.id, tIdx);
		}
		
		return div;
	},
	
	_getPreTableHTMLFromTemplate: function(id, div, name, tableID) {
		
		// Look for a template element first
		var html = '';
		var ctl = gel('zzprezztemplate' + name + '.' + this.ctvID + '.zz');
		if (ctl) {
			html = ctl.innerHTML;
		}
		
		if (html !== '') {
			html = html.replace(/__table__/g, tableID);
			div.innerHTML = html;
		}
	},
	
	_createDocumentElement: function(tagName, name) {
		var element = null;
		
		element = document.createElement(tagName);
		if (typeof name != "undefined") {
			element.name = name;
		}
		return element;
	},
	
	isValidDate: function(ctl) {
		// moved this to a static function
		// just calling that from here now
		SCVarTblUtil.isValidDate(ctl);
	},
	
	getTableDivision: function(tableID) {
		return document.getElementById('div_' + tableID);
	},
	
	getTableElement: function(tableID) {
		return document.getElementById(tableID);
	},
	
	getTableMarker: function() {
		return document.getElementById(this.tableMarker);
	},
	
	getCellCount: function() {
		return this.cellCount;
	},
	
	getRowCount: function(table) {
		return table.rows.length;
	},
	
	clearTable: function(tbl) {
		if (confirm("Are you sure you want to clear all rows from this table?")) {
			var rws = tbl.tBodies[0].rows.length;
			for (var r=0; r&lt;rws; r++) {
				this.deleteRow(tbl, tbl.tBodies[0].rows[0]);
			}
		}
	},
	
	deleteRow: function(table, e) {
		try {
			var i = e.rowIndex;
			var tableSeq = table.getAttribute("table_seq");
			table.deleteRow(i);
			var self = this;
			if (this.onDelete &amp;&amp; typeof this.onDelete == 'function') {
				this.onDelete(tableSeq, self, false);
			}
			
			if (this.getDataRowCount(table) === 0) {
				this.addRow(table);
			}
			this.checkRowCount(table);
		} catch (ex) {
			this.handle_exception('deleteRow', ex);
		}
	},
	
	getClassName: function() {
		return "SCVarTblUtil";
	},
	
	// use this function if you want to recall
	// onload after setting some data
	deleteTables: function() {
		var tblSection = $j('#' + this.getTableMarker().id + ' div.sc-cat-var');
		tblSection.remove();
		this.tableCount = 0;
		this.totalRows = 0;
	},
	
	disableAllRows: function() {
		var i;
		try {
			var tblSection = this.getTableMarker();
			var tables = tblSection.getElementsByTagName("table");
			for (var tIdx = 0; tIdx &lt; tables.length; tIdx++) {
				var table = tables[tIdx];
				
				// We only want tables with our table seq specified
				// Any pre table fields might also be in a table
				var seq = table.getAttribute("table_seq");
				if (!seq) {
					continue;
				}
				
				// Hide image buttons for creating duplicate tables
				this.hideAnElement('add_table.' + table.id, true);
				this.hideAnElement('delete_table.' + table.id, true);
				
				// Disable all pre table fields
				for (i = 0; i &lt; this.preTableRepeatFields.length; i++) {
					var preField = this.preTableRepeatFields[i];
					
					if (!this._useField(preField, seq)) {
						continue;
					}
					
					this.disableAField(preField, seq, true);
				}
				
				// Disable all table rows
				for (i = this.headerRows; i &lt; table.rows.length; i++) {
					var rowNum = i - this.headerRows + 1;
					var dataRow = table.rows[rowNum];
					var rowSeq = dataRow.getAttribute("row_seq");
					if (rowSeq == '') {
						rowSeq = rowNum;
					}
					this.disableARow(dataRow, true, seq, rowSeq);
				}
				if (this.headerRows &gt; 0) {
					var headRow = table.rows[0];
					var cellIdx = headRow.cells.length - 1;
					if (this.buttonPosition == 'left') {
						cellIdx = 0;
					}
					var cell = headRow.cells[cellIdx];
					cell.style.display = 'none';
				}
			}
		} catch (ex) {
			this.handle_exception('disableAllRows', ex);
		}
	},
	
	disableARow: function(dataRow, disable, tableSeq, rowID) {
		var disp = 'none';
		var cell;
		
		if (!disable) {
			disp = 'block';
		}
		
		try {
			for (var fIdx = 0; fIdx &lt; this.tableFields.length; fIdx++) {
				var field = this.tableFields[fIdx];
				
				if (!this._useField(field, tableSeq)) {
					continue;
				}
				
				var cellIdx = fIdx;
				if (this.buttonPosition == 'left') {
					cellIdx++;
				}
				
				cell = dataRow.cells[cellIdx];
				
				this.disableACell(cell, field, disable, tableSeq, rowID);
			}
			
			// Hide the action buttons
			var cellCtr = dataRow.cells.length - 1;
			if (this.buttonPosition == 'left') {
				cellCtr = 0;
			}
			
			cell = dataRow.cells[cellCtr];
			if (cell) {
				cell.style.display = disp;
			}
		} catch (ex) {
			this.handle_exception('disableARow', ex);
		}
	},
	
	disableACell: function(cell, field, disable, tableSeq, rowID) {
		
		var type = field.type;
		var fldID = field.id + '.' + tableSeq + '.' + rowID;
		this._registerField(field, fldID);
		var displayElement = g_form.getControl(fldID);
		var ctl = g_form.getDisplayBox(fldID);
		if (ctl) {
			displayElement = ctl;
		}
		if (type == 'checkbox') {
			displayElement = $('ni.' + fldID);
		}
		if (displayElement) {
			var disp = 'none';
			if (disable) {
				displayElement.setAttribute("disabled", "disabled");
			} else {
				displayElement.removeAttribute("disabled");
				disp = 'block';
			}
			// Hide/show the icons
			var aEl = displayElement.parentNode.getElementsByTagName("a");
			for (var i = 0; i &lt; aEl.length; i++) {
				var el = aEl[i];
				el.style.display = disp;
			}
		}
	},
	
	disableAField: function(field, tableSeq, disable) {
		
		var type = field.type;
		
		var fldID = field.id + '.' + tableSeq + '';
		var disableElement = document.getElementById(fldID);
		this._registerField(field, fldID);
		var displayElement = g_form.getControl(fldID);
		var ctl = g_form.getDisplayBox(fldID);
		if (ctl) {
			displayElement = ctl;
		}
		if (!disableElement) {
			return;
		}
		
		if (type == 'checkbox') {
			disableElement = document.getElementById('ni.' + fldID);
		} else if (type == 'reference') {
			disableElement = document.getElementById('sys_display.' + fldID);
		}
		if (disableElement) {
			var disp = 'none';
			if (disable) {
				disableElement.setAttribute("disabled", "disabled");
			} else {
				disableElement.removeAttribute("disabled");
				disp = 'block';
			}
			
			if (typeof displayElement != 'undefined' &amp;&amp; displayElement) {
				// Hide/show the icons
				var aEl = displayElement.parentNode.getElementsByTagName("a");
				for (var i = 0; i &lt; aEl.length; i++) {
					var el = aEl[i];
					el.style.display = disp;
				}
			}
		}
	},
	
	hideAnElement: function(fldID, hide) {
		// use jquery to select the correct element in the table
		var parnt = $j(this.getTableMarker());
		if (parnt.length == 0) {
			return;
		}
		fldID = fldID.replace(/\./g, "\\.");
		var hideElement = parnt.find('#' + fldID);
		if (hideElement) {
			if (hide) {
				hideElement.hide();
			} else {
				hideElement.show();
			}
		}
	},
	
	getResult: function() {
		var a = '';
		var tableArray = [];
		var i;
		
		try {
			var tblSection = this.getTableMarker();
			var tables = tblSection.getElementsByTagName("table");
			for (var tIdx = 0; tIdx &lt; tables.length; tIdx++) {
				var table = tables[tIdx];
				
				// We only want tables with our table seq specified
				// Any pre table fields might also be in a table
				var seq = table.getAttribute("table_seq");
				if (!seq) {
					continue;
				}
				
				// If the table is hidden forget it.
				// JON BARNES: this has been commented because it causes issues if 
				// the CTV is on a tab in the SC_REQ_ITEM or any other
				// table and that tab is hidden
				// I don't think this actually impacts anything anyway.
				//if (!this._isTableDisplayed(table)) {
					//continue;
				//}
				
				tableObj = {
				};
				
				var hdr = table.getAttribute("table_hdr");
				if (!hdr) {
					hdr = '';
				}
				
				tableObj.hdr = hdr;
				
				var forElement = table.getAttribute("for_element");
				if (!forElement) {
					forElement = '';
				}
				tableObj.forElement = forElement;
				
				// Get pre field values
				var preFieldArray = [];
				
				for (i = 0; i &lt; this.preTableRepeatFields.length; i++) {
					var preField = this.preTableRepeatFields[i];
					
					if (!this._useField(preField, seq)) {
						continue;
					}
					var preObj = this._getPreFieldObject(preField, seq);
					preFieldArray.push(preObj);
				}
				tableObj.preFields = preFieldArray;
				
				// Get table row values
				var rowArray = [];
				for (i = this.headerRows; i &lt; table.rows.length; i++) {
					var dataRow = table.rows[i].getAttribute("row_seq");
					if (!dataRow || dataRow == "") {
						continue;
					}
					var cellArray = [];
					for (var fIdx = 0; fIdx &lt; this.tableFields.length; fIdx++) {
						try {
							var field = this.tableFields[fIdx];
							var ufield = this._useField(field, seq);
							var obj = this._getCellObject(dataRow, fIdx, field, ufield, seq);
							cellArray.push(obj);
						} catch (ex1) {
							this.handle_exception('getResult: field loop', ex1);
						}
					}
					rowArray.push(cellArray);
				}
				tableObj.rows = rowArray;
				tableArray.push(tableObj);
			}
		} catch (ex) {
			this.handle_exception('getResult', ex);
			rowArray = [];
		}
		var tableText = Object.toJSON(tableArray);
		return tableText;
	},
	
	_isTableDisplayed: function(table) {
		return this._isVisible(table);
	},
	
	_isVisible: function(element) {
		var style;
		
		if (element == document) {
			return true;
		}
		
		if (!element) {
			return false;
		}
		
		if (!element.parentNode) {
			return false;
		}
		
		if (element.style) {
			if (element.style.display == 'none') {
				return false;
			}
			
			if (element.style.visibility == 'hidden') {
				return false;
			}
		}
		
		//Try the computed style in a standard way
		if (window.getComputedStyle) {
			style = window.getComputedStyle(element, "");
			if (style.display == 'none') {
				return false;
			}
			if (style.visibility == 'hidden') {
				return false;
			}
		}
		
		//Or get the computed style using IE's silly proprietary way
		style = element.currentStyle;
		if (style) {
			if (style.display == 'none') {
				return false;
			}
			if (style.visibility == 'hidden') {
				return false;
			}
		}
		
		return this._isVisible(element.parentNode);
	},
	
	_getCellObject: function(ri, ci, field, useField, tblSeq) {
		var fldID = field.id + "." + tblSeq + "." + ri;
		return this._setFieldProperties(fldID, field, tblSeq);
	},
	
	_setFieldProperties: function(fieldID, fieldProps, tblSeq) {
		var obj = {
		};
		obj.field = fieldProps.id;
		obj.label = fieldProps.label;
		obj.mandatory = fieldProps.mandatory;
		obj.type = fieldProps.type;
		obj.giveFocus = fieldProps.giveFocus;
		obj.reference = fieldProps.reference;
		obj.choiceOptions = fieldProps.choiceOptions;
		obj.refQual = fieldProps.refQual;
		obj.onChangeFunc = fieldProps.onChangeFunc;
		obj.cellCSS = fieldProps.cellCSS;
		obj.labelCSS = fieldProps.labelCSS;
		obj.show = fieldProps.show;
		obj.imageSrc = fieldProps.imageSrc;
		obj.value = '';
		obj.display = '';
		obj.relatedTable = '';
		obj.disabled = false;
		
		var type = fieldProps.type;
		
		// If this field is not shown on this table then return empty object
		var useField = this._useField(fieldProps, tblSeq);
		if (!useField) {
			return obj;
		}
		this._registerField(fieldProps, fieldID);
		var fieldValue = g_form.getValue(fieldID);
		var fieldElement = g_form.getControl(fieldID);
		if (!fieldElement) {
			fieldElement = $(fieldID);
		}
		relatedTable = fieldElement.readAttribute('related_table');
		var fieldDisplayElement = g_form.getDisplayBox(fieldID);
		
		if (type == 'checkbox') {
			if (fieldValue == 'true') {
				obj.value = 'Yes';
			} else {
				obj.value = 'No';
			}
		} else if (type == 'date' || type == 'datetime') {
			obj.value = fieldValue;
		} else if (type == 'reference') {
			obj.value = fieldValue;
			obj.display = fieldDisplayElement.value || '';
		} else if (type == 'choice') {
			obj.value = fieldValue;
			var selectedIndex = fieldElement.selectedIndex;
			if (selectedIndex != -1) {
				var options = fieldElement.options;
				var option = options[selectedIndex];
				obj.display = option.text;
			}
		} else if (type == 'button') {
			// do nothing
		} else {
			// Assume text
			obj.value = fieldValue;
		}
		
		if (obj.display.trim() === '') {
			obj.display = obj.value;
		}
		
		if (fieldDisplayElement) {
			if (fieldDisplayElement.disabled) {
				obj.disabled = true;
			}
		}
		
		if (obj.display.trim() === '') {
			obj.display = obj.value;
		}
		
		if (relatedTable &amp;&amp; relatedTable != 'undefined') {
			table = this.getTableElement(relatedTable);
			if (table &amp;&amp; this._isTableDisplayed(table)) {
				obj.relatedTable = relatedTable;
			}
		}
		return obj;
	},
	
	_getPreFieldObject: function(preField, seq) {
		
		var fldID = preField.id + '.' + seq + '';
		return this._setFieldProperties(fldID, preField, seq);
	},
	
	getValue: function(fieldName, tblSeq, rowID) {
		var value = '';
		var field = null;
		var type = 'field';
		var id = fieldName + tblSeq;
		if (rowID) {
			id += "." + rowID;
			type = 'cell';
			field = this._getFieldDefinition(this.tableFields, fieldName);
		} else {
			field = this._getFieldDefinition(this.preTableRepeatFields, fieldName);
		}
		if (!field) {
			return value;
		}
		var valueEl = document.getElementById(id);
		
		if (!valueEl) {
			return value;
		}
		
		type = field.type;
		
		if (type == 'checkbox') {
			if (valueEl.value == "true") {
				value = 'Yes';
			} else {
				value = 'No';
			}
		} else if (type == 'date' || type == 'datetime') {
			value = valueEl.value;
		} else if (type == 'reference') {
			value = valueEl.value;
		} else if (type == 'choice') {
			var selectedIndex = valueEl.selectedIndex;
			var options = valueEl.options;
			var option = options[selectedIndex];
			value = option.value;
		} else {
			// Assume text
			value = valueEl.value;
		}
		return value.trim();
	},
	
	_getFieldDefinition: function(fields, fieldName) {
		for (var i = 0; i &lt; fields.length; i++) {
			var field = fields[i];
			if (field.id == fieldName) {
				return field;
			}
		}
		return null;
	},
	
	setMandatoryCheck: function(bool) {
		this.doCheckMandatory = bool;
	},
	
	_checkMandatoryFields: function() {
		
		var nbr, i, fldIdx, preField, reqList, field, cellIdx;
		
		if (!this.doCheckMandatory) {
			return true;
		}
		
		var someMissing = false;
		
		var missingList = '';
		
		// Check table mandatory fields
		try {
			var tblSection = this.getTableMarker();
			var tables = tblSection.getElementsByTagName("table");
			for (var tIdx = 0; tIdx &lt; tables.length; tIdx++) {
				var table = tables[tIdx];
				
				// We only want tables with our table seq specified
				// Any pre table fields might also be in a table
				var seq = table.getAttribute("table_seq");
				if (!seq) {
					continue;
				}
				
				// If the table is hidden forget it.
				//if (!this._isTableDisplayed(table)) {
					//continue;
				//}
				
				// Validate that all required pre fields have values
				for (i = 0; i &lt; this.requiredPreFields.length; i++) {
					fldIdx = this.requiredPreFields[i];
					preField = this.preTableRepeatFields[fldIdx];
					
					if (!this._useField(preField, seq)) {
						continue;
					}
					var preObj = this._getPreFieldObject(preField, seq);
					if (preObj.disabled) {
						continue;
					}
					if (preObj &amp;&amp; preObj.value.trim() === '') {
						someMissing = true;
						if (missingList !== '') {
							missingList += ';';
						}
						missingList += 'Table ' + seq + '/' + preField.label;
					} else if (preObj &amp;&amp; preObj.type == 'number') {
						nbr = parseFloat(preObj.value);
						if (nbr == 'NaN' || nbr === 0) {
							someMissing = true;
							if (missingList !== '') {
								missingList += ';';
							}
							missingList += 'Table ' + seq + '/' + preField.label;
						}
					}
				}
				
				// Validate that all required fields are filled in (except header row)
				for (var rowIdx = this.headerRows; rowIdx &lt; table.rows.length; rowIdx++) {
					for (i = 0; i &lt; this.requiredFields.length; i++) {
						cellIdx = this.requiredFields[i];
						/*if (this.buttonPosition == 'left') {
							cellIdx++;
						}*/
						field = this.tableFields[cellIdx];
						
						if (!this._useField(field, seq)) {
							continue;
						}
						
						var rowSeq = table.rows[rowIdx].getAttribute("row_seq");
						if (!rowSeq || rowSeq == '') {
							rowSeq = rowIdx;
						}
						var obj = this._getCellObject(rowSeq, cellIdx, field, true, seq);
						if (obj.disabled) {
							continue;
						}
						if (obj &amp;&amp; (!obj.value || obj.value.trim() === '')) {
							someMissing = true;
							if (missingList !== '') {
								missingList += ';';
							}
							missingList += 'Table ' + seq + '/Row ' + rowIdx + '/' + field.label;
						} else if (obj &amp;&amp; obj.type == 'number') {
							nbr = parseFloat(obj.value);
							if (nbr == 'NaN' || nbr === 0) {
								someMissing = true;
								if (missingList !== '') {
									missingList += ';';
								}
								missingList += 'Table ' + seq + '/Row ' + rowIdx + '/' + field.label;
							}
						}
					}
				}
			}
		} catch (ex) {
			this.handle_exception('_checkMandatoryFields', ex);
		}
		
		if (someMissing) {
			reqList = '';
			for (i = 0; i &lt; this.requiredPreFields.length; i++) {
				fldIdx = this.requiredPreFields[i];
				preField = this.preTableRepeatFields[fldIdx];
				if (reqList !== '') {
					reqList += ',';
				}
				reqList += preField.label;
			}
			for (i = 0; i &lt; this.requiredFields.length; i++) {
				cellIdx = this.requiredFields[i];
				field = this.tableFields[cellIdx];
				if (reqList !== '') {
					reqList += ',';
				}
				reqList += field.label;
			}
			alert('Some of the following mandatory table cell values are not filled in:\n' + missingList);
			return false;
		}
		
		return true;
	},
	
	setResult: function() {
		
		if (!this._checkMandatoryFields()) {
			return false;
		}
		
		var resultVarName = this.resultVariable;
		if (g_form.getControl(resultVarName) === undefined) {
			resultVarName = 'variables.' + this.resultVariable;
		}
		g_form.setValue(resultVarName, this.getResult());
		return true;
	},
	
	onLoad: function(tblHeader) {
		var formName = this.resultVariable;
		var text = g_form.getValue(this.resultVariable).trim();
		if (!text || text === '') {
			text = g_form.getValue('variables.' + this.resultVariable).trim();
			formName = 'variables.' + this.resultVariable;
		}
		
		this.isOnLoad = true;
		if (!text || text === '') {
			var table = this.createTable(tblHeader);
			this.addRow(table);
		} else {
			this._initializeTable(text);
		}
		this.isOnLoad = false;
		
		g_form.setDisplay(formName, false);
		
		if (this.disableAfterOrdered() &amp;&amp; !this.isCatalogForm()) {
			this.disableAllRows();
		}
	},
	
	isCatalogForm: function() {
		var rc = true;
		var ctl = g_form.getControl(this.resultVariable);
		if (!ctl) {
			rc = false;
		}
		return rc;
	},
	
	_initializeTable: function(text) {
		
		var i;
		
		var tables = text.evalJSON(true);
		for (var tIdx = 0; tIdx &lt; tables.length; tIdx++) {
			var tableObj = tables[tIdx];
			var hdr = tableObj.hdr;
			var forElement = tableObj.forElement;
			var table = this.createTable(hdr, forElement);
			var tableSeq = table.getAttribute("table_seq");
			
			// Set existing values in pre table fiedls
			var preFields = tableObj.preFields;
			this._setCurrentPreFieldValues(preFields);
			
			for (i = 0; i &lt; this.preTableRepeatFields.length; i++) {
				var preField = this.preTableRepeatFields[i];
				
				if (!this._useField(preField, tableSeq)) {
					continue;
				}
				
				this._setPreFieldValue(preField, tableSeq);
			}
			
			// Set existing values in table
			var tableRows = tableObj.rows;
			
			for (var rIdx = 0; rIdx &lt; tableRows.length; rIdx++) {
				var tableRow = tableRows[rIdx];
				
				if (!tableRow || tableRow === "") {
					continue;
				}
				
				this._setRowCurrentValues(tableRow);
				
				var rowCtr = this.addRow(table);
				
				var row = table.rows[table.rows.length - 1];
				
				try {
					for (i = 0; i &lt; this.tableFields.length; i++) {
						var field = this.tableFields[i];
						this._setCellValue(field, row, i, tableSeq, rowCtr);
					}
				} catch (ex) {
					this.handle_exception('_initializeTable', ex);
				}
			}
		}
	},
	
	_setCellValue: function(field, row, cIdx, tableSeq, rowCtr) {
		try {
			var fldID = field.id + "." + tableSeq + "." + rowCtr;
			this._setFieldValue(fldID, field);
		} catch (ex) {
			this.handle_exception('_setCellValue', ex);
		}
	},
	
	_setFieldValue: function(fieldID, field) {
		this._registerField(field, fieldID);
		var fieldElement = g_form.getControl(fieldID);
		var fieldElementDisplay = g_form.getDisplayBox(fieldID);
		if (field.relatedTable) {
			fieldElement.setAttribute('related_table', field.relatedTable);
		}
		
		if (field.type == 'checkbox') {
			g_form.setValue(fieldID, field.value == 'Yes');
			if (fieldElement) {
				fieldElement.checked = field.value == 'Yes';
			}
			var ctl = $('ni.' + fieldID);
			if (ctl) {
				ctl.checked = field.value == 'Yes';
			}
		} else if (field.type == 'reference') {
			g_form.setValue(fieldID, field.value, field.display);
			//fieldElementDisplay.style.width = "150px";
		} else if (field.type == 'choice') {
			g_form.setValue(fieldID, field.value);
			for (j = 0; j &lt; fieldElement.options.length; j++) {
				if (fieldElement.options[j].value == field.value) {
					break;
				}
			}
			// If we didn't find the entry then add it
			if (j &gt;= fieldElement.options.length) {
				g_form.addOption(fieldID, field.value, field.display);
			}
		} else if (field.type == 'date' || field.type == 'datetime') {
			g_form.setValue(fieldID, field.value);
		} else { // Assume it's text
			g_form.setValue(fieldID, field.value);
		}
	},
	
	_setPreFieldValue: function(preField, tableSeq) {
		try {
			var fldID = preField.id + '.' + tableSeq + '';
			this._setFieldValue(fldID, preField);
		} catch (ex) {
			this.handle_exception('_initializeTable', ex);
		}
	},
	
	_setCurrentPreFieldValues: function(preFields) {
		try {
			for (var i = 0; i &lt; preFields.length; i++) {
				var savedPreField = preFields[i];
				for (var j = 0; j &lt; this.preTableRepeatFields.length; j++) {
					var preField = this.preTableRepeatFields[j];
					if (preField.id == savedPreField.field) {
						preField.value = savedPreField.value;
						preField.display = savedPreField.display;
						break;
					}
				}
			}
		} catch (ex) {
			this.handle_exception('_setCurrentPreFieldValues', ex);
		}
	},
	
	_setRowCurrentValues: function(cells) {
		try {
			for (var i = 0; i &lt; cells.length; i++) {
				var cell = cells[i];
				
				var field = this.tableFields[i];
				if (field.id == cell.field) {
					field.value = cell.value;
					field.display = cell.display;
				}
			}
		} catch (ex) {
			this.handle_exception('_setRowCurrentValues', ex);
		}
	},
	
	getCellValue: function(fieldName, tableSeq, rowNum) {
		var id = fieldName + '.' + tableSeq + "." + rowNum;
		var ctl = gel(id);
		if (ctl) {
			return ctl.value;
		}
		return '';
	},
	
	setCellValue: function(fieldName, fieldValue, tableSeq, rowNum) {
		var id = fieldName + '.' + tableSeq + "." + rowNum;
		var ctl = gel(id);
		if (ctl) {
			ctl.value = fieldValue;
		}
	},
	
	disableAfterOrdered: function() {
		return this.disableAfterOrder;
	},
	
	getTableNumberFromID: function(id) {
		// Get the number from the end of the id value. This tells us the table number
		var tableNum = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.tableSeq !== '') {
			tableNum = elementParts.tableSeq;
		}
		return tableNum;
	},
	
	getRowIDFromRow: function(dataRow, tableSeq) {
		var field;
		var firstField = null;
		for (var fIdx = 0; fIdx &lt; this.tableFields.length; fIdx++) {
			field = this.tableFields[fIdx];
			
			if (this._useField(field, tableSeq)) {
				firstField = fIdx * 1;
				break;
			}
		}
		
		if (firstField !== null) {
			var cell = dataRow.cells[firstField];
			var cellNodes = cell.childNodes;
			var cellNode = cellNodes[0];
			var type = field.type;
			
			if (field.type == 'date' || field.type == 'datetime') {
				cellNode = cellNodes[1];
			}
			
			if (cellNode !== null) {
				return this.getRowID(cellNode.id);
			}
		}
		return '-1';
	},
	
	getRowNumber: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		var rowNbr = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.rowNumber !== '') {
			rowNbr = elementParts.rowNumber;
		}
		return rowNbr;
	},
	
	getRowID: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		var rowID = '-1';
		var elementParts = this._getElementIDParts(id);
		if (elementParts.tableSeq !== '') {
			rowID = elementParts.tableSeq;
			if (elementParts.rowNumber !== '') {
				rowID += '.' + elementParts.rowNumber;
			}
		}
		return rowID;
	},
	
	_getElementIDParts: function(id) {
		// All id's have a format of fieldname.tableSeq.rowNumber.
		// Non table fields won't have a .rowNumber
		if (id.substr(0, 3) == 'ni.') {
			id = id.substr(3);
		}
		var parts = id.split('.');
		
		var elementParts = {
		};
		elementParts.fieldName = parts[0];
		elementParts.tableSeq = '';
		elementParts.rowNumber = '';
		
		if (parts.length &gt; 1) {
			elementParts.tableSeq = parts[1];
			if (parts.length &gt; 2) {
				elementParts.rowNumber = parts[2];
			}
		}
		return elementParts;
	},
	
	connectElementToTable: function(el, table) {
		el.setAttribute('related_table', table.id);
	},
	
	toggleTableDisplay: function(tableID, onOff) {
		var table = this.getTableElement(tableID);
		if (table) {
			var parentDiv = table.parentNode;
			this.toggleDisplay(parentDiv, onOff);
		}
	},
	
	toggleDisplay: function(ctl, onOff) {
		var display = 'none';
		if (onOff) {
			display = 'block';
		}
		ctl.style.display = display;
	},
	
	handle_exception: function(func, ex) {
		if (this.debug) {
			if (ex instanceof Error) {
				console.warn('Exception caught in function ' + func + ':\nName:' + ex.name + "\nMessage:" + ex.message);
			} else {
				console.warn('Exception caught in function ' + func + ':\n' + ex);
			}
		}
	},
	
	addChangeHandlerRef: function(id) {
		g_form.getControl(id).onchange = function(event) {
			alert(id + ": has changed.");
		};
	},
	
	_getRealFieldID: function(fieldName) {
		var realName = fieldName;
		var parts = realName.split('.');
		if (parts.length &gt; 1) {
			realName = parts[1];
		}
		realName = realName.replace(/[._0-9]+$/, '');
		return realName;
	},
	
	cellChanged: function(ctl) {
		// At some point we'll have status bars on the column headers and they will need to be changed here. also, we will trigger the onchange events from here
		var self = this, found = false, f;
		var parts = this._getElementIDParts(ctl.id);
		if (parts.fieldName &amp;&amp; parts.fieldName != '') {
			for (f=0; f&lt;this.tableFields.length; f++) {
				if (this.tableFields[f].id == parts.fieldName) {
					// this is the field
					// call the onchange function
					found = true;
					if (typeof this.tableFields[f].onChange == 'function') {
						this.tableFields[f].onChange(ctl, self, false);
					}
					break;
				}
			}
			if (!found) {
				for (f=0; f&lt;this.preTableRepeatFields.length; f++) {
					if (this.preTableRepeatFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.preTableRepeatFields[f].onChange == 'function') {
							try {
								this.preTableRepeatFields[f].onChange(ctl, self, false);
							} catch (onchangeex) {
								console.warn('error calling onchange function: ' + onchangeex.message);
							}
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.preTableFields.length; f++) {
					if (this.preTableFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.preTableFields[f].onChange == 'function') {
							try {
								this.preTableFields[f].onChange(ctl, self, false);
							} catch (onchangeex) {
								console.warn('error calling onchange function: ' + onchangeex.message);
							}
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.postTableFields.length; f++) {
					if (this.postTableFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.postTableFields[f].onChange == 'function') {
							try {
								this.postTableFields[f].onChange(ctl, self, false);
							} catch (onchangeex) {
								console.warn('error calling onchange function: ' + onchangeex.message);
							}
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.postTableRepeatFields.length; f++) {
					if (this.postTableRepeatFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.postTableRepeatFields[f].onChange == 'function') {
							try {
								this.postTableRepeatFields[f].onChange(ctl, self, false);
							} catch (onchangeex) {
								console.warn('error calling onchange function: ' + onchangeex.message);
							}
						}
						break;
					}
				}
			}
		}
	},
	
	buttonClicked: function(ctl) {
		// At some point we'll have status bars on the column headers and they will need to be changed here. also, we will trigger the onchange events from here
		var self = this, found = false, f;
		var parts = this._getElementIDParts(ctl.id);
		if (parts.fieldName &amp;&amp; parts.fieldName != '') {
			for (f=0; f&lt;this.tableFields.length; f++) {
				if (this.tableFields[f].id == parts.fieldName) {
					// this is the field
					// call the onchange function
					found = true;
					if (typeof this.tableFields[f].onClick == 'function') {
						this.tableFields[f].onClick(ctl, self, false);
					}
					break;
				}
			}
			if (!found) {
				for (f=0; f&lt;this.preTableFields.length; f++) {
					if (this.preTableFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.preTableFields[f].onClick == 'function') {
							this.preTableFields[f].onClick(ctl, self, false);
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.postTableFields.length; f++) {
					if (this.postTableFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.postTableFields[f].onClick == 'function') {
							this.postTableFields[f].onClick(ctl, self, false);
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.preTableRepeatFields.length; f++) {
					if (this.preTableRepeatFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.preTableRepeatFields[f].onClick == 'function') {
							this.preTableRepeatFields[f].onClick(ctl, self, false);
						}
						break;
					}
				}
			}
			if (!found) {
				for (f=0; f&lt;this.postTableRepeatFields.length; f++) {
					if (this.postTableRepeatFields[f].id == parts.fieldName) {
						// this is the field
						// call the onchange function
						found = true;
						if (typeof this.postTableRepeatFields[f].onClick == 'function') {
							this.postTableRepeatFields[f].onClick(ctl, self, false);
						}
						break;
					}
				}
			}
		}
	},
	
	fieldChanged: function(ctl) {
		var fieldName = this._getRealFieldID(ctl.id);
		var tableSeq = this.getTableNumberFromID(ctl.id);
		if (tableSeq == '-1') {
			// No number found
			this.handle_exception('fieldChanged', 'ERROR Table seq not found on control ' + ctl.id);
			return;
		}
		// fire the custom on change event
		this.cellChanged(ctl);
		var mandatory = false;
		var nValue = this.getValue(fieldName, tableSeq);
		var fType = ctl.className;
		
		var original = gel('sys_original.' + ctl.id);
		var oValue = 'unknown';
		if (original)
			oValue = original.value;
		
		var newClass = 'changed';
		var oldClass = '';
		var sl = this._getStatusElement(fieldName, tableSeq);
		if (!sl) {
			return;
		}
		
		if (sl.className == 'mandatory' || sl.getAttribute('oclass') == 'mandatory' || sl.className == 'mandatory_populated' || sl.getAttribute('oclass') == 'mandatory_populated') {
			mandatory = true;
		}
		
		oldClass = sl.className;
		
		if (mandatory &amp;&amp; nValue === '') {
			newClass = 'mandatory';
		} else if (mandatory &amp;&amp; fType == "cat_item_option" &amp;&amp; nValue == "false") {
			newClass = 'mandatory';
		} else if (oValue == nValue) {
			newClass = sl.getAttribute("oclass");
		}
		
		sl.className = newClass;
		
		if (oldClass != newClass) {
			sl.setAttribute("oclass", oldClass);
		}
	},
	
	_getStatusElement: function(fieldName, tblSeq, rowID) {
		var el = '';
		var id = fieldName + tblSeq;
		if (rowID) {
			id += "." + rowID;
		}
		el = $('status.' + id);
		return el;
	},
	
	type: "SCVarTblUtil"
};]]&gt;&lt;/script&gt;&lt;script_name/&gt;&lt;sys_class_name&gt;sys_ui_script&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2013-06-18 18:03:31&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;cc35a569fc4e01003a07c0c5e73ae7a3&lt;/sys_id&gt;&lt;sys_mod_count&gt;399&lt;/sys_mod_count&gt;&lt;sys_name&gt;SCVarTblUtil&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_script_cc35a569fc4e01003a07c0c5e73ae7a3&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-04-02 20:10:13&lt;/sys_updated_on&gt;&lt;use_scoped_format&gt;false&lt;/use_scoped_format&gt;&lt;/sys_ui_script&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>9f0e0125dbf91744cbe7fb37bf961924</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblUtil</target_name>
<type>UI Script</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sp_widget_03bbdcf24f10130032617e918110c73a</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sp_widget"&gt;&lt;sp_widget action="INSERT_OR_UPDATE"&gt;&lt;category&gt;custom&lt;/category&gt;&lt;client_script&gt;&lt;![CDATA[function($scope, $rootScope, $sce, glideFormFactory) {
	/* widget controller */
	var c = this;
	c.tables = [];
	c.scripts = '';
	c.maxTable = 0;
	c.isReadOnly = false;
	c.checkMandatory = true;
	c.SCVarTbl = null;
	c.isLoading = false;
	c.changingFields = {
	};
	
	// TODO:
	// Fix onChange scripts because they don't work properly with g_form.setValue() (digest cycle issue)
	
	c.addTable = function(idx) {
		c.tables.push({
			idx: idx || c.tables.length + 1,
			maxRows: 0,
			rows: [],
			nonTableFields: {
			},
			status: {
				message: "",
				state: "info",
			}
		});
		c.maxTable++;
		for (var i=0; i&lt;c.data.nonTableFields.length; i++) {
			if (c.data.nonTableFields[i].type == 'button') {
				continue;
			}
			var fld = angular.copy(c.data.nonTableFields[i]);
			if (c.isReadOnly) {
				fld.sys_readonly = true;
				fld.readonly = true;
				fld.read_only = true;
			}
			var name = fld.variable_name + "." + c.tables[c.tables.length-1].idx;
			c.tables[c.tables.length-1].nonTableFields[fld.name] = fld;
			c.tables[c.tables.length-1].nonTableFields[fld.name].variable_name = name;
			c.tables[c.tables.length-1].nonTableFields[fld.name].ed.name = name;
			c.tables[c.tables.length-1].nonTableFields[fld.name].id = name;
			fld.name = fld.name + "_" + c.tables[c.tables.length-1].idx;
			$scope.formModel._fields[fld.name] = fld;
		}
		var fields = [];
		for (var f in $scope.formModel._fields) {
			fields.push($scope.formModel._fields[f]);
		}
		c.addRow(c.tables.length-1);
	};
	
	c.setCheckMandatory = function(check) {
		c.checkMandatory = check;
	};
	
	c.clearTable = function(tbl) {
		if (confirm("Are you sure you want to clear all data from this table?")) {
			var rws = tbl.rows.length;
			for (var r=0; r&lt;rws; r++) {
				c.removeRow(tbl, tbl.rows[0]);
			}
			if (tbl.rows.length == 0) {
				c.addRow(tbl);
			}
		}
	};
	
	c.removeTable = function(idx) {
		if (!c.tables[idx]) {
			return;
		}
		if (c.tables.length == 1) {
			return;
		}
		c.tables.splice(idx, 1);
	};
	
	c.addRow = function(tbl, idx) {
		if (c.tables[tbl].rows.length &gt;= c.data.maxRows) {
			return null;
		}
		var row = {
			idx: idx || c.tables[tbl].maxRows + 1,
			fields: {
			}
		};
		for (var i=0; i&lt;c.data.fields.length; i++) {
			if (c.data.fields[i].type == 'button') {
				continue;
			}
			var fld = angular.copy(c.data.fields[i]);
			if (c.isReadOnly) {
				fld.sys_readonly = true;
				fld.readonly = true;
				fld.read_only = true;
			}
			var name = fld.variable_name + "." + c.tables[tbl].idx + "." + row.idx;
			row.fields[fld.name] = fld;
			row.fields[fld.name].variable_name = name;
			row.fields[fld.name].ed.name = name;
			row.fields[fld.name].id = name;
			fld.name = fld.name + "_" + c.tables[tbl].idx + "_" + row.idx;
			$scope.formModel._fields[fld.name] = fld;
		}
		var fields = [];
		for (var f in $scope.formModel._fields) {
			fields.push($scope.formModel._fields[f]);
		}
		var opts = {
		};
		if ($scope.g_form) {
			opts = {
				itemSysId: $scope.g_form.$private.options('itemSysId'),
				getFieldSequence: $scope.g_form.$private.options('getFieldSequence'),
				getFieldParams: $scope.g_form.$private.options('getFieldParams'),
				isInitialized: $scope.g_form.$private.options('isInitialized'),
				getMappedField: $scope.g_form.$private.options('getMappedField')
			};
		}
		$scope.g_form = glideFormFactory.create($scope, null, $scope.formModel.sys_id, fields, null);
		c.SCVarTbl.setGlideForm($scope.g_form);
		c.SCVarTbl.setScope($scope);
		$scope.g_form.$private.options(opts);
		$scope.g_form.$private.events.on("change", function(fieldName, oldValue, newValue) {
			var selFld, fld, fldName;
			for (fld in $scope.formModel._fields) {
				if ($scope.formModel._fields[fld].name == fieldName) {
					selFld = $scope.formModel._fields[fld];
					$scope.formModel._fields[fld].stagedValue = newValue;
				}
			}
			if (selFld &amp;&amp; oldValue != newValue &amp;&amp; !c.isReadOnly) {
				var fn;
				for (fld=0; fld&lt;c.data.fields.length; fld++) {
					if (c.data.fields[fld].var_name == selFld.var_name &amp;&amp;
						typeof c.data.fields[fld].onChange == 'function') {
						if (!c.isFieldChanging(fieldName)) {
							fn = c.data.fields[fld].onChange;
						}
						break;
					}
				}
				if (!fn) {
					for (fld=0; fld&lt;c.data.nonTableFields.length; fld++) {
						if (c.data.nonTableFields[fld].var_name == selFld.var_name &amp;&amp;
							typeof c.data.nonTableFields[fld].onChange == 'function') {
							if (!c.isFieldChanging(fieldName)) {
								fn = c.data.nonTableFields[fld].onChange;
							}
							break;
						}
					}
				}
				if (fn) {
					c.setFieldChanging(fieldName, true);
					$scope.$evalAsync(function() {
						try {
							fn(selFld, $scope.g_form, c.SCVarTbl, oldValue, newValue, true);
						} catch (ex) {
							console.warn("Error calling onchange script: " + ex.message);
						}
						c.setFieldChanging(fieldName, false);
					});
				}
			}
		});
		c.tables[tbl].rows.push(row);
		if (typeof $scope.onAddRow == 'function') {
			$scope.onAddRow(c.tables[tbl].idx, c.tables[tbl].idx + "." + c.tables[tbl].rows[c.tables[tbl].rows.length-1].idx, c.isLoading, $scope.g_form, c.SCVarTbl, true);
		}
		c.checkRows(tbl);
		c.tables[tbl].maxRows++;
		return row;
	};
	
	c.setFieldChanging = function(id, changing) {
		id = id.replace(/\./g, "_");
		c.changingFields[id] = changing;
	},
	
	c.isFieldChanging = function(id) {
		id = id.replace(/\./g, "_");
		return c.changingFields[id];
	},
		
	c.click = function(fld, rowID) {
		var found = false, f, selFld;
		for (f=0; f&lt;c.data.fields.length; f++) {
			if (c.data.fields[f].var_name == fld.var_name &amp;&amp; typeof c.data.fields[f].onClick == 'function') {
				found = true;
				selFld = angular.copy(fld);
				selFld.id = selFld.var_name + "." + rowID;
				c.data.fields[f].onClick(selFld, $scope.g_form, c.SCVarTbl, true);
				break;
			}
		}
		if (!found) {
			for (f=0; f&lt;c.data.nonTableFields.length; f++) {
				if (c.data.nonTableFields[f].var_name == fld.var_name &amp;&amp; typeof c.data.nonTableFields[f].onClick == 'function') {
					selFld = angular.copy(fld);
					selFld.id = selFld.var_name + "." + rowID;
					c.data.nonTableFields[f].onClick(selFld, $scope.g_form, c.SCVarTbl, true);
					break;
				}
			}
		}
	};
	
	c.checkRows = function(tbl) {
		if (c.tables[tbl].rows.length &gt;= c.data.maxRows) {
			c.tables[tbl].status.state = "warning";
			c.tables[tbl].status.message = "You have reached the maximum number of rows allowed (" + c.data.maxRows + ")";
		} else {
			c.tables[tbl].status.state = "info";
			c.tables[tbl].status.message = "";
		}
	};
	
	c.removeRow = function(tbl, row) {
		var ridx = -1, tidx = -1;
		if (tbl) {
			for (var r=0; r&lt;tbl.rows.length; r++) {
				if (tbl.rows[r].idx == row.idx) {
					ridx = r;
					break;
				}
			}
		}
		if (ridx &gt;= 0) {
			tbl.rows.splice(ridx, 1);
		}
		for (var t=0; t&lt;c.tables.length; t++) {
			if (c.tables[t].idx == tbl.idx) {
				tidx = t;
				break;
			}
		}
		if (typeof $scope.onDeleteRow == 'function') {
			$scope.onDeleteRow(tbl.idx, $scope.g_form, c.SCVarTbl, true);
		}
		if (tidx &gt;= 0) {
			if (tbl.rows.length == 0) {
				c.addRow(tidx);
			}
			c.checkRows(tidx);
		}
	};
	
	c.copyRow = function(tbl, row) {
		var tidx = -1;
		for (var t=0; t&lt;c.tables.length; t++) {
			if (c.tables[t].idx == tbl.idx) {
				tidx = t;
				break;
			}
		}
		if (tidx &gt;= 0) {
			var rw = c.addRow(tidx);
			if (rw) {
				for (var fld in rw.fields) {
					if (row.fields[fld]) {
						rw.fields[fld].value = row.fields[fld].value;
						rw.fields[fld].display_value = row.fields[fld].display_value;
						rw.fields[fld].stagedValue = row.fields[fld].stagedValue;
						rw.fields[fld].displayValue = row.fields[fld].displayValue;
					}
				}
			}
		}
	};
	
	// gets the JSON string from the variable and fills in all fields
	c.getResult = function() {
		if (c.savedData) {
			var fld, f;
			for (var t=0; t&lt;c.savedData.length; t++) {
				if (!c.tables[t]) {
					c.addTable();
				}
				for (f=0; f&lt;c.savedData[t].preFields.length; f++) {
					for (fld in c.tables[t].nonTableFields) {
						if (c.savedData[t].preFields[f].field == c.tables[t].nonTableFields[fld].var_name) {
							c.tables[t].nonTableFields[fld].value = c.savedData[t].preFields[f].value;
							c.tables[t].nonTableFields[fld].displayValue = c.savedData[t].preFields[f].display;
							c.tables[t].nonTableFields[fld].display_value = c.savedData[t].preFields[f].display;
						}
					}
				}
				for (var r=0; r&lt;c.savedData[t].rows.length; r++) {
					if (!c.tables[t].rows[r]) {
						c.addRow(t, (r+1));
					}
					for (f=0; f&lt;c.savedData[t].rows[r].length; f++) {
						for (fld in c.tables[t].rows[r].fields) {
							if (c.savedData[t].rows[r][f].field == c.tables[t].rows[r].fields[fld].var_name) {
								c.tables[t].rows[r].fields[fld].value = c.savedData[t].rows[r][f].value;
								c.tables[t].rows[r].fields[fld].displayValue = c.savedData[t].rows[r][f].display;
								c.tables[t].rows[r].fields[fld].display_value = c.savedData[t].rows[r][f].display;
							}
						}
					}
				}
			}
		}
	};
	
	// gets the values of all elements and sets the values accordingly
	c.setResult = function() {
		if (!c.isReadOnly) {
			var res = c.buildResult(true);
			if (!res.passMandatory) {
				return false;
			}
			$scope.g_form.setValue("IO:"+c.data.resultVar, JSON.stringify(res.result));
		}
		return true;
	};
	
	c.buildResult = function(checkMandatory) {
		var ret = {
			passMandatory: true,
			result: []
		};
		for (var t=0; t&lt;c.tables.length; t++) {
			var hasErrors = false;
			var md = [];
			var tbl = {
				hdr: '',
				forElement: '',
				preFields: [],
				rows: []
			};
			var flds, f;
			for (f=0; f&lt;c.data.nonTableFields.length; f++) {
				flds = [];
				if (c.data.nonTableFields[f].location != 'before' || !c.data.nonTableFields[f].repeat) {
					continue;
				}
				if (c.data.nonTableFields[f].type == 'button') {
					continue;
				}
				if (c.checkMandatory &amp;&amp; c.data.nonTableFields[f].mandatory &amp;&amp;
					c.tables[t].nonTableFields[c.data.nonTableFields[f].catalogFieldName] &amp;&amp;
					c.tables[t].nonTableFields[c.data.nonTableFields[f].catalogFieldName].value == '') {
					md.push(c.data.nonTableFields[f].label);
					ret.passMandatory = false;
					hasErrors = true;
				}
					tbl.preFields.push(c.buildFieldObject(c.tables[t].nonTableFields[c.data.nonTableFields[f].catalogFieldName], c.data.nonTableFields[f]));
			}
			for (var r=0; r&lt;c.tables[t].rows.length; r++) {
				var rw = "Row " + (r+1);
				flds = [];
				for (f=0; f&lt;c.data.fields.length; f++) {
					if (c.data.fields[f].type == 'button') {
						continue;
					}
					if (c.checkMandatory &amp;&amp; c.data.fields[f].mandatory &amp;&amp;
						c.tables[t].rows[r].fields[c.data.fields[f].catalogFieldName] &amp;&amp;
					c.tables[t].rows[r].fields[c.data.fields[f].catalogFieldName].value == '') {
						md.push(rw + " / " + c.data.fields[f].label);
						ret.passMandatory = false;
						hasErrors = true;
					}
					flds.push(c.buildFieldObject(c.tables[t].rows[r].fields[c.data.fields[f].catalogFieldName], c.data.fields[f]));
				}
				tbl.rows.push(flds);
			}
			if (checkMandatory &amp;&amp; hasErrors) {
				c.tables[t].status.state = "danger";
				c.tables[t].status.message = "Please fill in the following mandatory fields: " + md.join(", ");
			} else {
				c.tables[t].status.state = "info";
				c.tables[t].status.message = "";
			}
			ret.result.push(tbl);
		}
		return ret;
	};
	
	c.buildFieldObject = function(fld, def, tbl) {
		var obj = {
		};
		obj.field = def.var_name;
		obj.label = def.label;
		obj.mandatory = def.mandatory;
		obj.type = def.origType;
		obj.giveFocus = def.giveFocus;
		obj.reference = def.reference;
		obj.choiceOptions = def.choiceOptions;
		obj.refQual = def.refQual;
		obj.onChangeFunc = def.onChangeFunc;
		obj.cellCSS = def.cellCSS;
		obj.labelCSS = def.labelCSS;
		obj.show = def.show;
		obj.imageSrc = def.imageSrc;
		obj.value = fld.value;
		obj.display = fld.displayValue;
		obj.relatedTable = '';
		obj.disabled = false;
		return obj;
	};
	
	$scope.g_form = null;
	$scope.formModel = null;
	
	$scope.getGlideForm = function() {
		return $scope.g_form;
	};
	
	c.initialize = function() {
		c.isLoading = true;
		// setup the event triggers
		try {
			if (c.data.onAddRow) {
				$scope.onAddRow = new Function('tableID', 'rowID', 'onLoad', 'g_form', 'SCVarTbl', 'isSP', c.data.onAddRow);
			}
			if (c.data.onDeleteRow) {
				$scope.onDeleteRow = new Function('tableID', 'g_form', 'SCVarTbl', 'isSP',  c.data.onDeleteRow);
			}
			for (var i=0; i&lt;c.data.fields.length; i++) {
				if (c.data.fields[i].onChangeScript) {
					c.data.fields[i].onChange = new Function('ctl', 'g_form', 'SCVarTbl', 'oldValue', 'newValue', 'isSP', c.data.fields[i].onChangeScript);
				}
				if (c.data.fields[i].onClickScript) {
					c.data.fields[i].onClick = new Function('ctl', 'g_form', 'SCVarTbl', 'isSP',  c.data.fields[i].onClickScript);
				}
			}
			for (var i=0; i&lt;c.data.nonTableFields.length; i++) {
				if (c.data.nonTableFields[i].onChangeScript) {
					c.data.nonTableFields[i].onChange = new Function('ctl', 'g_form', 'SCVarTbl', 'oldValue', 'newValue', 'isSP', c.data.nonTableFields[i].onChangeScript);
				}
				if (c.data.nonTableFields[i].onClickScript) {
					c.data.nonTableFields[i].onClick = new Function('ctl', 'g_form', 'SCVarTbl', 'isSP',  c.data.nonTableFields[i].onClickScript);
				}
			}
		} catch(ex) {
			console.warn(ex);
		}
		
		// get the form model, g_form from a parent scope
		try {
			var t = 0;
			var par = $scope.$parent;
			var foundAll = false;
			// navigate max 20 parents up to find some data that we need.
			// if we find it sooner, we will exit the loop.
			while (par &amp;&amp; t &lt; 20) {
				if (!$scope.formModel &amp;&amp; par.formModel) {
					$scope.formModel = par.formModel;
				}
				if (!$scope.g_form &amp;&amp; par.page &amp;&amp; par.page.g_form) {
					$scope.g_form = par.page.g_form;
				}
				if (typeof par.triggerUIAction != 'undefined' &amp;&amp; typeof par.data.f != 'undefined') {
					c.isReadOnly = c.data.disableAfterOrder &amp;&amp; par.data.f.table != 'sc_cat_item';
					if ($scope.g_form &amp;&amp; $scope.formModel) {
						break;
					}
				}
				par = par.$parent;
			}
		} catch(ex) {
			console.warn(ex);
		}
		
		try {
			if ($scope.g_form) {
				$scope.g_form.$private.events.on('submit', c.setResult);
				$scope.g_form.setVisible("IO:"+c.data.resultVar, false);
				c.SCVarTbl = new SPSCVarTblUtil($scope, $scope.g_form);
				var dt = $scope.g_form.getValue("IO:" + c.data.resultVar);
				c.savedData = null;
				if (dt != '') {
					c.savedData = JSON.parse(dt);
					c.getResult();
				}
			}
		} catch(ex) {
			console.warn(ex);
		}
		
		if (c.tables.length == 0) {
			c.addTable();
		}
		c.isLoading = false;
	};
	
	c.initialize();
}]]&gt;&lt;/client_script&gt;&lt;controller_as&gt;c&lt;/controller_as&gt;&lt;css&gt;/*div.sc-cat-var input.form-control, div.sc-cat-var select.form-control {&amp;#13;
	min-width:100px;&amp;#13;
}*/&amp;#13;
		&amp;#13;
div.sc-cat-var {&amp;#13;
	padding-top: 10px;&amp;#13;
}&amp;#13;
		&amp;#13;
div.sc-cat-var:nth-of-type(1) {&amp;#13;
	padding-top: 0px;&amp;#13;
}&amp;#13;
		&amp;#13;
.sc-var-table th {&amp;#13;
	font-size: 1em; &amp;#13;
	white-space: nowrap;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-var-table th:last-of-type {&amp;#13;
	font-size: 1em;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-var-table {&amp;#13;
  margin-bottom: 0px;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-var-table td label.field-label {&amp;#13;
  display: none;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-var-table td span.type-boolean label &amp;gt; span {&amp;#13;
  display: none;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-var-table .form-group {&amp;#13;
 margin-bottom: 0px; &amp;#13;
}&amp;#13;
&amp;#13;
.sc-cat-var &amp;gt; .well {&amp;#13;
  padding: 5px; &amp;#13;
  margin-bottom: 0px;&amp;#13;
  border-bottom-left-radius: 0px;&amp;#13;
  border-bottom-right-radius: 0px;&amp;#13;
  border-bottom-width: 0px;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-cat-var .field-has-reference {&amp;#13;
  display: block;&amp;#13;
  table-layout: inherit;&amp;#13;
}&amp;#13;
&amp;#13;
.panel-heading h4 {&amp;#13;
  margin-top: 0px;&amp;#13;
  margin-bottom: 0px;&amp;#13;
}&amp;#13;
&amp;#13;
.alert {&amp;#13;
  margin-top: 5px !important;&amp;#13;
  margin-bottom: 5px !important;&amp;#13;
  margin-left: 0px !important;&amp;#13;
  margin-right: 0px !important;&amp;#13;
}&amp;#13;
&amp;#13;
.item_action {&amp;#13;
  white-space: nowrap;&amp;#13;
  text-align: right;&amp;#13;
}&amp;#13;
&amp;#13;
.fa-copy {&amp;#13;
  font-size: .8em;&amp;#13;
}&amp;#13;
&amp;#13;
.action-button {&amp;#13;
  text-align: right; &amp;#13;
  white-space: nowrap; &amp;#13;
  width: 15px;&amp;#13;
}&amp;#13;
&amp;#13;
.action-button-left .action-button:first-of-type, &amp;#13;
.action-button-right .action-button:last-of-type {&amp;#13;
  display: table-cell;&amp;#13;
}&amp;#13;
&amp;#13;
.action-button-right .action-button:first-of-type, &amp;#13;
.action-button-left .action-button:last-of-type {&amp;#13;
  display: none;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-cat-read-only .action-button {&amp;#13;
  display: none !important;&amp;#13;
}&amp;#13;
&amp;#13;
.sc-cat-prefields {&amp;#13;
  border-top-width: 0px;&amp;#13;
  border-bottom-width: 0px;&amp;#13;
  margin-top: 0px;&amp;#13;
  margin-bottom: 0px;&amp;#13;
  border-radius: 0px;&amp;#13;
}&amp;#13;
		&amp;#13;
.sc-cat-prefields .panel-body {&amp;#13;
  padding: 5px;&amp;#13;
}&amp;#13;
/* this section of CSS makes the tables stack vertically like a regular form on small screens */&amp;#13;
@media screen and (max-width: 468px) {&amp;#13;
  .sc-var-table &amp;gt; tbody &amp;gt; tr:nth-of-type(odd) {&amp;#13;
    background-color: #f9f9f9;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .sc-cat-var .table-responsive {&amp;#13;
    margin-bottom: 0px !important;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .sc-var-table tr, .sc-var-table td {&amp;#13;
    display: block;&amp;#13;
    border-width: 0px;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .sc-var-table th {&amp;#13;
    display: none;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .action-button:first-of-type {&amp;#13;
    display: block !important;&amp;#13;
    border-width: 0px;&amp;#13;
    width: 100%;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .action-button:last-of-type,&amp;#13;
  .sc-cat-read-only .action-button {&amp;#13;
    display: none !important;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .sc-var-table td label.field-label {&amp;#13;
  	display: initial !important;&amp;#13;
  }&amp;#13;
&amp;#13;
  .sc-var-table td span.type-boolean label &amp;gt; span {&amp;#13;
    display: initial !important;&amp;#13;
  }&amp;#13;
  &amp;#13;
  .btn-field {&amp;#13;
    display: block;&amp;#13;
    width: 100%;&amp;#13;
  }&amp;#13;
}&lt;/css&gt;&lt;data_table&gt;sp_instance&lt;/data_table&gt;&lt;demo_data/&gt;&lt;description&gt;This will render a table from catalog table variable&lt;/description&gt;&lt;docs/&gt;&lt;field_list/&gt;&lt;has_preview&gt;false&lt;/has_preview&gt;&lt;id&gt;catalog-table-variable&lt;/id&gt;&lt;internal&gt;false&lt;/internal&gt;&lt;link/&gt;&lt;name&gt;Catalog Table Variable&lt;/name&gt;&lt;option_schema/&gt;&lt;public&gt;false&lt;/public&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[(function() {
	/* populate the 'data' object */
	/* e.g., data.table = $sp.getValue('table'); */
	var tableVarGR = new GlideRecord('u_catalog_table_variable');
	data.fields = [];
	data.nonTableFields = [];
	if (tableVarGR.get(options.var_id)) {
		data.title = tableVarGR.getValue('u_title');
		data.initialTableHeader = tableVarGR.getValue('u_initial_table_header');
		data.var_id = tableVarGR.getUniqueValue();
		data.allowMulti = tableVarGR.getValue('u_allow_multiple_occurrences') == "1" ? true : false;
		data.buttonPosition = tableVarGR.u_button_position.nil() ? "right" : tableVarGR.getValue('u_button_position');
		data.focusNew = tableVarGR.getValue('u_focus_new_row') == "1" ? true : false;
		data.maxRows = tableVarGR.u_max_rows.nil() ? 1000 : parseInt(tableVarGR.getValue('u_max_rows'));
		data.allowCopy = tableVarGR.getValue('u_allow_copy') == "1" ? true : false;
		data.resultVar = tableVarGR.getValue('u_result_variable');
		data.disableAfterOrder = tableVarGR.getValue("u_disable_after_ordered") == "1" ? true : false;
		if (!tableVarGR.u_when_row_deleted.nil()) {
			data.onDeleteFunc = data.var_id + '_onDelete';
			data.onDeleteRow = tableVarGR.getValue('u_when_row_deleted');
		}
		if (!tableVarGR.u_when_row_added.nil()) {
			data.onAddFunc = data.var_id + '_onAdd';
			data.onAddRow = tableVarGR.getValue('u_when_row_added');
		}
		// Get all table columns
		var tableColumnList = [];
		var nonTableFieldList = [];
		var tableColumnGR = new GlideRecord('u_catalog_table_field');
		tableColumnGR.addQuery('u_catalog_table_variable', tableVarGR.sys_id);
		tableColumnGR.orderBy('u_order');
		tableColumnGR.query();
		while (tableColumnGR.next()) {
			data.fields.push(setupField(tableColumnGR));
		}
		var nonColumnGR = new GlideRecord('u_catalog_table_single_column');
		nonColumnGR.addQuery('u_catalog_table_variable', tableVarGR.sys_id);
		nonColumnGR.orderBy('u_order');
		nonColumnGR.query();
		while (nonColumnGR.next()) {
			data.nonTableFields.push(setupField(nonColumnGR));
		}
	}
	
	function setupField(colGR) {
		var field = {
			displayValue: '',
			display_value: '',
			value: '',
			sys_id: colGR.getUniqueValue(),
			attributes: {
			},
			choice: 0,
			lookup_label: "",
			lookup_value: "",
			readonly: false,
			read_only: false,
			sys_readonly: false,
			_cat_variable: true,
			visible: true,
			ed: {
			}
		};
		field.name = "IO:" + field.sys_id;
		field.catalogFieldName = field.name;
		field.type = 'string';
		field.origType = colGR.getValue('u_type');
		if (!colGR.u_type.nil()) {
			field.type = colGR.getValue('u_type');
		}
		if (field.type == 'number' || field.type == 'text') {
			field.type = 'string';
		} else if (field.type == 'datetime') {
			field.type = 'glide_date_time';
		} else if (field.type == 'date') {
			field.type = 'glide_date';
		} else if (field.type == 'checkbox') {
			field.type = 'boolean';
		} else if (field.type == 'choice') {
			field.choice = 1;
		}
		if (!colGR.u_max_chars.nil()) {
			field.max_length = parseInt(colGR.getValue('u_max_chars'));
		}
		field.variable_name = colGR.getValue('u_id');
		field.var_name = field.variable_name;
		field.label = colGR.getValue('u_label');
		field.cellCSS = colGR.getValue('u_cell_css');
		field.labelCSS = colGR.getValue('u_label_css');
		field.show = 'always';
		if (!colGR.u_show.nil()) {
			field.show = colGR.getValue('u_show');
		}
		field.mandatory = colGR.getValue('u_mandatory') == "1" ? true : false;
		if (!field.mandatory) {
			// we can only make a field read only
			// if it isn't mandatory
			field.readonly = colGR.getValue('u_read_only') == "1" ? true : false;
			field.read_only = field.readonly;
			field.sys_readonly = field.readonly;
		}
		field.giveFocus = colGR.getValue('u_give_focus') == "1" ? true : false;
		field.reference = colGR.getValue('u_referenced_table') || '';
		field.refTable = field.reference;
		field.stagedValue = "";
		field.refQual = colGR.getValue('u_reference_qualifier') || '';
		field.reference_qual = field.refQual;
		field.location = 'table';
		if (colGR.isValidField('u_location')) {
			field.location = colGR.getValue('u_location');
		}
		field.repeat = true;
		if (colGR.isValidField('u_repeat_with_table')) {
			field.repeat = colGR.getValue('u_repeat_with_table') == "1" ? true : false;
		}
		field.choiceOptions = [];
		if (!colGR.u_choice_list.nil()) {
			// execute the script
			try {
				var answer = [];
				if (!colGR.u_choice_list.nil()) {
					var globals = GlideStringUtil.decodeAttributes("answer");
					globals.put("answer", answer);
					answer = GlideEvaluator.evaluateStringWithGlobals(colGR.getValue("u_choice_list"), globals);
				}
				field.choiceOptions = answer;
				field.choices = answer;
				if (field.choices &amp;&amp; field.choices.length) {
					for (var c=0; c&lt;field.choices.length; c++) {
						field.choices[c].price = 0;
						field.choices[c].priceLabel = "";
						field.choices[c].recurring_price = 0;
					}
				}
			} catch (chcEx) {
			}
		}
		
		field.onChangeFunc = '';
		if (!colGR.u_on_change.nil()) {
			field.onChangeScript = colGR.getValue('u_on_change');
		}
		
		field.onclick = '';
		if (!colGR.u_on_click.nil()) {
			field.onclick = field.sys_id + '_' + 'onClick';
			field.onClickScript = colGR.getValue('u_on_click');
		}
		
		field.img = '';
		if (colGR.u_icon.getDisplayValue() != '') {
			field.img = '' + colGR.u_icon.getDisplayValue();
		}
		field.ed.name = field.variable_name;
		field.ed.reference = field.refTable;
		field.ed.qualifier = field.reference_qual;
		if (JSUtil.notNil(field.ed.qualifier)) {
			field.ed.queryString = field.ed.qualifier;
		}
		field.ed.defaultOperator = 'STARTSWITH';
		field.reference_key = 'sys_id';
		if (JSUtil.notNil(field.refTable)) {
			var grRef = new GlideRecord(field.refTable);
			if (grRef.isValid()) {
				field.ed.searchField = grRef.getDisplayName();
			}
		}
		return field;
	}
})();]]&gt;&lt;/script&gt;&lt;servicenow&gt;false&lt;/servicenow&gt;&lt;sys_class_name&gt;sp_widget&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-02-18 23:48:55&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;03bbdcf24f10130032617e918110c73a&lt;/sys_id&gt;&lt;sys_mod_count&gt;260&lt;/sys_mod_count&gt;&lt;sys_name&gt;Catalog Table Variable&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sp_widget_03bbdcf24f10130032617e918110c73a&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-20 01:49:49&lt;/sys_updated_on&gt;&lt;template&gt;&lt;![CDATA[&lt;div class="panel panel-default" ng-class="{'sc-cat-read-only':c.isReadOnly}"&gt;
  &lt;div class="panel-heading"&gt;
    &lt;h4&gt;{{c.data.title}}&lt;/h4&gt;
  &lt;/div&gt;
  &lt;div class="panel-body" style="padding: 5px;"&gt;
    &lt;div class="sc-cat-var" ng-repeat="tbl in c.tables"&gt;
      &lt;div ng-show="tbl.status.message != ''" class="alert alert-dismissible alert-{{tbl.status.state}}"&gt;
        &lt;button type="button" class="close" ng-click="tbl.status.message=''" aria-label="Close"&gt;&lt;span aria-hidden="true"&gt;&lt;/span&gt;&lt;/button&gt;
        {{tbl.status.message}}
      &lt;/div&gt;
      &lt;div class="well well-sm clearfix" ng-show="c.data.allowMulti"&gt;
        &lt;div class="pull-right"&gt;
          &lt;button ng-if="$index&gt;0&amp;&amp;!c.isReadOnly" ng-click="c.removeTable($index)" style="margin-right:5px;" class="btn btn-default" type="button"&gt;Delete table&lt;/button&gt;
          &lt;button ng-if="!c.isReadOnly &amp;&amp; c.data.allowMulti" ng-click="c.addTable()" class="btn btn-default" type="button"&gt;Add table&lt;/button&gt;
        &lt;/div&gt;
        &lt;h5&gt;&lt;span ng-if="$index==0 &amp;&amp; c.data.initialTableHeader"&gt;{{c.data.initialTableHeader}}&lt;/span&gt;&amp;nbsp;&lt;/h5&gt;
      &lt;/div&gt;
      &lt;div ng-show="c.data.nonTableFields.length &gt; 0" class="panel panel-default sc-cat-prefields"&gt;
        &lt;div class="panel-body"&gt;
          &lt;div ng-repeat="prefld in c.data.nonTableFields" ng-if="prefld.repeat &amp;&amp; (prefld.show=='always' || prefld.show=='' || (prefld.show=='first' &amp;&amp; $parent.$index==0) || (prefld.show=='not_first' &amp;&amp; $parent.$index&gt;0))" style="{{prefld.cellCSS}}"&gt;
            &lt;div ng-if="prefld.type=='button'"&gt;
              &lt;button ng-disabled="c.isReadOnly" type="button" ng-click="c.click(prefld, tbl.idx+'.'+rw.idx)" class="btn btn-default btn-field"&gt;
                &lt;span ng-if="prefld.img &amp;&amp; prefld.img != ''" title="{{prefld.label}}"&gt;
                  &lt;img ng-src="prefld.img" /&gt;
                &lt;/span&gt;
                &lt;span ng-if="!prefld.img || prefld.img == ''"&gt;{{prefld.label}}&lt;/span&gt;
              &lt;/button&gt;
            &lt;/div&gt;
            &lt;div ng-if="prefld.type!='button'"&gt;
              &lt;sp-form-field form-model="formModel" field="formModel._fields[prefld.name+'_'+tbl.idx]" glide-form="getGlideForm()" ng-show="true"&gt;&lt;/sp-form-field&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class="table-responsive"&gt;
        &lt;table class="sc-var-table table table-bordered table-condensed" ng-class="{'action-button-left':c.data.buttonPosition=='left','action-button-right':c.data.buttonPosition=='right'}"&gt;
          &lt;thead&gt;
            &lt;tr&gt;
              &lt;th class="action-button"&gt;
                &lt;button class="btn btn-default" title="Clear Table" type="button" style="position: relative;" ng-click="c.clearTable(tbl);"&gt;
                  &lt;i class=" fa fa-trash"&gt;&lt;/i&gt;
                &lt;/button&gt;
                &lt;button class="btn btn-default" ng-disabled="tbl.rows.length &gt;= c.data.maxRows" title="Add Row" type="button" style="white-space: nowrap; position: relative; margin-right: 0px;" ng-click="c.addRow($index)"&gt;
                  &lt;i class=" fa fa-plus"&gt;&lt;/i&gt;
                &lt;/button&gt;
              &lt;/th&gt;
              &lt;th ng-repeat="fld in c.data.fields" ng-if="fld.show=='always' || fld.show=='' || (fld.show=='first' &amp;&amp; $parent.$index==0) || (fld.show=='not_first' &amp;&amp; $parent.$index&gt;0)" style="{{fld.labelCSS}}"&gt;
                {{fld.label}}
                &lt;span ng-if="fld.mandatory" title="Mandatory - must be populated before Submit" class="fa fa-asterisk mandatory"&gt;&lt;/span&gt;
              &lt;/th&gt;
              &lt;th class="action-button"&gt;
                &lt;button class="btn btn-default" title="Clear Table" type="button" style="position: relative;" ng-click="c.clearTable(tbl);"&gt;
                  &lt;i class=" fa fa-trash"&gt;&lt;/i&gt;
                &lt;/button&gt;
                &lt;button class="btn btn-default" ng-disabled="tbl.rows.length &gt;= c.data.maxRows" title="Add Row" type="button" style="white-space: nowrap; position: relative; margin-right: 0px;" ng-click="c.addRow($index)"&gt;
                  &lt;i class=" fa fa-plus"&gt;&lt;/i&gt;
                &lt;/button&gt;
              &lt;/th&gt;
            &lt;/tr&gt;
          &lt;/thead&gt;
          &lt;tbody&gt;
            &lt;tr ng-repeat="rw in tbl.rows"&gt;
               &lt;td class="item_action action-button"&gt;
                 &lt;button ng-click="c.removeRow(tbl, rw)" href="javascript: void(0);" title="Delete Row" class="btn btn-default"&gt;
                   &lt;i class="fa fa-times"&gt;&lt;/i&gt;
                 &lt;/button&gt;
                 &lt;button ng-show="c.data.allowCopy" ng-disabled="tbl.rows.length&gt;=c.data.maxRows" ng-click="c.copyRow(tbl, rw)" href="javascript: void(0);" title="Copy Row" class="btn btn-default"&gt;
                   &lt;i class="fa fa-copy"&gt;&lt;/i&gt;
                 &lt;/button&gt;
              &lt;/td&gt;
              &lt;td ng-repeat="fld in c.data.fields" ng-if="fld.show=='always' || fld.show=='' || (fld.show=='first' &amp;&amp; $parent.$parent.$index==0) || (fld.show=='not_first' &amp;&amp; $parent.$parent.$index&gt;0)" style="{{fld.cellCSS}}"&gt;
                &lt;div ng-if="fld.type=='button'"&gt;
                  &lt;button ng-disabled="c.isReadOnly" type="button" ng-click="c.click(fld, tbl.idx+'.'+rw.idx)" class="btn btn-default btn-field"&gt;
                    &lt;span ng-if="fld.img &amp;&amp; fld.img != ''" title="{{fld.label}}"&gt;
                      &lt;img ng-src="fld.img" /&gt;
                    &lt;/span&gt;
                    &lt;span ng-if="!fld.img || fld.img == ''"&gt;{{fld.label}}&lt;/span&gt;
                  &lt;/button&gt;
                &lt;/div&gt;
                &lt;div ng-if="fld.type!='button'"&gt;
                  &lt;sp-form-field form-model="formModel" field="formModel._fields[fld.name+'_'+tbl.idx+'_'+rw.idx]" glide-form="getGlideForm()" ng-show="true"&gt;&lt;/sp-form-field&gt;
                &lt;/div&gt;
              &lt;/td&gt;
              &lt;td class="item_action action-button"&gt;
                &lt;button ng-click="c.removeRow(tbl, rw)" href="javascript: void(0);" title="Delete Row" class="btn btn-default"&gt;
                  &lt;i class="fa fa-times"&gt;&lt;/i&gt;
                &lt;/button&gt;
                &lt;button ng-show="c.data.allowCopy" ng-disabled="tbl.rows.length&gt;=c.data.maxRows" ng-click="c.copyRow(tbl, rw)" href="javascript: void(0);" title="Copy Row" class="btn btn-default"&gt;
                  &lt;i class="fa fa-copy"&gt;&lt;/i&gt;
                &lt;/button&gt;
              &lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/div&gt;
      &lt;div ng-show="tbl.status.message != ''" class="alert alert-dismissible alert-{{tbl.status.state}}"&gt;
        &lt;button type="button" class="close" ng-click="tbl.status.message=''" aria-label="Close"&gt;&lt;span aria-hidden="true"&gt;&lt;/span&gt;&lt;/button&gt;
        {{tbl.status.message}}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;script type="text/javascript" ng-bind="c.scripts"&gt;&lt;/script&gt;]]&gt;&lt;/template&gt;&lt;/sp_widget&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d30e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>Catalog Table Variable</target_name>
<type>Widget</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_variable_u_allow_copy_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_allow_copy" label="Allow Copy" language="en" table="u_catalog_table_variable"><sys_documentation action="INSERT_OR_UPDATE"><element>u_allow_copy</element><help>Allow user to copy rows</help><hint>Allow user to copy rows</hint><label>Allow Copy</label><language>en</language><name>u_catalog_table_variable</name><plural>Allow Copys</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 14:59:00</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>9933c67d4fe8130032617e918110c707</sys_id><sys_mod_count>1</sys_mod_count><sys_name>Allow Copy</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_variable_u_allow_copy_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 15:00:16</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d30e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Allow Copy</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_bfd5301c3196150053e0a5578f24cf61</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Custom choice input field used by Table variable.&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_choice_input_field&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services2_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2014-01-11 23:48:59&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;bfd5301c3196150053e0a5578f24cf61&lt;/sys_id&gt;&lt;sys_mod_count&gt;3&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_choice_input_field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_bfd5301c3196150053e0a5578f24cf61&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-02-09 04:54:17&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
   &lt;g:macro name="REQUIRED" label="REQUIRED" value="" onchange="onChange('${jvar_name}');" onclick_label="" mandatory="false"/&gt;
   &lt;table class="wide"&gt;
     &lt;tr&gt;
       &lt;td id="label.${jvar_name}" class="label" nowrap="true" type="string" choice="0" oncontextmenu="${jvar_oncontextmenu}"&gt;
         &lt;g:inline template="cs_form_label" onclick="${jvar_onclick_label}" for="${jvar_name}"&gt; ${jvar_label}:&lt;/g:inline&gt;
       &lt;/td&gt;
       &lt;td nowrap="true" style="width:100%"&gt;
	&lt;select name="${jvar_name}" id="${jvar_name}" class="form-control" onChange="${jvar_onchange}"&gt;		 
		&lt;!-- xml for element type inserted here... --&gt;
		&lt;g:insert/&gt;
	&lt;/select&gt;
       &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/table&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d30e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_choice_input_field</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>m2m_sp_dependency_js_include_060d4ad24fe4130032617e918110c73b</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="m2m_sp_dependency_js_include"><m2m_sp_dependency_js_include action="INSERT_OR_UPDATE"><order>100</order><sp_dependency display_value="SCVarTblUtil">90ec4e964fe4130032617e918110c704</sp_dependency><sp_js_include display_value="SCVarTblUtil">22fc8e964fe4130032617e918110c73b</sp_js_include><sys_class_name>m2m_sp_dependency_js_include</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 04:58:54</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>060d4ad24fe4130032617e918110c73b</sys_id><sys_mod_count>0</sys_mod_count><sys_name>SCVarTblUtil.SCVarTblUtil</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>m2m_sp_dependency_js_include_060d4ad24fe4130032617e918110c73b</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 04:58:54</sys_updated_on></m2m_sp_dependency_js_include></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d70e0125dbf91744cbe7fb37bf96191c</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>SCVarTblUtil.SCVarTblUtil</target_name>
<type>Dependency JS Includes</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_documentation_u_catalog_table_field_u_max_chars_en</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_documentation element="u_max_chars" label="Max Chars" language="en" table="u_catalog_table_field"><sys_documentation action="INSERT_OR_UPDATE"><element>u_max_chars</element><help/><hint/><label>Max Chars</label><language>en</language><name>u_catalog_table_field</name><plural>Max Chars</plural><sys_class_name>sys_documentation</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>87bb5de24fec130032617e918110c775</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Max Chars</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_documentation_u_catalog_table_field_u_max_chars_en</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><url/><url_target/></sys_documentation></sys_documentation></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d70e0125dbf91744cbe7fb37bf96191f</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column.Max Chars</target_name>
<type>Field Label</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_35e46569fc4e01003a07c0c5e73ae782</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Table variable base macro.&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;sc_var_table&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;snc-services_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2013-06-18 18:02:27&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;35e46569fc4e01003a07c0c5e73ae782&lt;/sys_id&gt;&lt;sys_mod_count&gt;172&lt;/sys_mod_count&gt;&lt;sys_name&gt;sc_var_table&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_35e46569fc4e01003a07c0c5e73ae782&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-06 20:03:03&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide"&gt;
  &lt;g:evaluate var="jvar_stamp"&gt;
        var gr = new GlideRecord('sys_ui_script');
        gr.orderByDesc('sys_updated_on');
        gr.query();
        gr.next();
        gr.getValue('sys_updated_on');
  &lt;/g:evaluate&gt;
  &lt;g:requires name="SCVarTblUtil.jsdbx" params="cache=${jvar_stamp}" /&gt;
  &lt;g:macro catalog_table_id="" /&gt;
	&lt;style&gt;
		@media screen and (max-width: 767px) {
		  /*.table-responsive {
            width: 100%;
            margin-bottom: 15px;
            overflow-y: hidden;
            -ms-overflow-style: -ms-autohiding-scrollbar;
            border: 1px solid #ddd;
          }
		  
		  .table-responsive&gt;.table {
            margin-bottom: 0;
          }*/
		}
		
		.table-responsive {
		  min-height: .01%;
		  overflow-x: auto;
		}
		
		/*div.sc-cat-var input.form-control, div.sc-cat-var select.form-control {
		  min-width:100px;
		}*/
		
		div.sc-cat-var {
		  padding-top: 10px;
		}
		
		div.sc-cat-var:nth-of-type(1) {
		  padding-top: 0px;
		}
		
		.sc-var-table th {
		  font-size: 1em; 
		  white-space: nowrap;
		}
		
		.sc_editor .panel-ctv {
		  margin-left: 15px;
		  margin-right: 15px;
		}
		
		.panel-ctv .panel-heading h4 {
		  margin-top: 0px;
		  margin-bottom: 0px;
		}
		
		.item_action {
		  white-space: nowrap !important;
		  text-align: right !important;
		}
		
		.sc-cat-var .icon-add {
		  margin-right: 0px !important;
		}
		
		.sc-cat-prefields {
		  border-top-width: 0px;
		  border-bottom-width: 0px;
		  margin-top: 0px;
		  margin-bottom: 0px;
		  border-radius: 0px;
		}
		
		.sc-cat-prefields .panel-body {
		  padding: 5px;
		}
		
		.sc-cat-prefields .form-group {
		  margin-left: 0px;
		  margin-right: 0px;
		}
	&lt;/style&gt;
  &lt;g:evaluate&gt;
    var tableVarGR = new GlideRecord('u_catalog_table_variable');
    tableVarGR.get('${jvar_catalog_table_id}');
    //gs.log("Table var gr rows=" + tableVarGR.getRowCount()  + " id=${jvar_catalog_table_id}", "sc_var_table");

    // Get all table columns
    var tableColumnList = [];
	var ctvSysID = tableVarGR.getUniqueValue();
    var tableColumnGR = new GlideRecord('u_catalog_table_field');
    tableColumnGR.addQuery('u_catalog_table_variable', tableVarGR.sys_id);
    tableColumnGR.orderBy('u_order');
    tableColumnGR.query();
    //gs.log("Table columns=" +  tableColumnGR.getRowCount(), "sc_var_table");
    while (tableColumnGR.next()) {
      var field = {};

      field.type = 'text';
      if (!tableColumnGR.u_type.nil()) {
        field.type = '' + tableColumnGR.u_type;
      }

      field.id = '';
      if (!tableColumnGR.u_id.nil()) {
        field.id = '' + tableColumnGR.u_id;
      }

      field.label = '';
      if (!tableColumnGR.u_label.nil()) {
        field.label = '' + tableColumnGR.u_label;
      }

      field.cellCSS = '';
      if (!tableColumnGR.u_cell_css.nil()) {
        field.cellCSS = '' + tableColumnGR.u_cell_css;
      }

      field.labelCSS = '';
      if (!tableColumnGR.u_label_css.nil()) {
        field.labelCSS = '' + tableColumnGR.u_label_css;
      }

      field.show = 'always';
      if (!tableColumnGR.u_show.nil()) {
        field.show = '' + tableColumnGR.u_show;
      }

      field.mandatory = 'false';
      if (tableColumnGR.u_mandatory) {
        field.mandatory = 'true';
      }
	  
	  field.readOnly = 'false';
      if (tableColumnGR.u_read_only &amp;amp;&amp;amp; field.mandatory == 'false') {
        field.readOnly = 'true';
      }

      field.giveFocus = 'false';
      if (tableColumnGR.u_give_focus) {
        field.giveFocus = 'true';
      }

      field.reference = '';
      if (!tableColumnGR.u_referenced_table.nil()) {
        field.reference = '' + tableColumnGR.u_referenced_table;
      }

      field.refQual = '';
      if (!tableColumnGR.u_reference_qualifier.nil()) {
        field.refQual = '' + tableColumnGR.u_reference_qualifier;
      }

	  field.max_length = '';
	  if (!tableColumnGR.u_max_chars.nil()) {
	    field.max_length = tableColumnGR.getValue('u_max_chars');
	  }
	  
      field.choiceOptions = [];
      if (!tableColumnGR.u_choice_list.nil()) {
        // execute the script
        var answer = [];
        if (! tableColumnGR.u_choice_list.nil()) {
          //var globalNames = ['answer'];
          //var globalValues = [answer];
          //answer = GlideEvaluator.evaluateString(tableColumnGR.getValue("u_choice_list"), globalNames, globalValues);
          var globals = GlideStringUtil.decodeAttributes("answer");
          globals.put("answer", answer);
          answer = GlideEvaluator.evaluateStringWithGlobals(tableColumnGR.getValue("u_choice_list"), globals);
          //gs.log("Choice script=" + tableColumnGR.getValue("u_choice_list") + " answer=" + answer);
        }
        field.choiceOptions = answer;
      }
    
	  var json = new JSON();
      field.choiceOptions = json.encode(field.choiceOptions);

      field.onChangeFunc = '';
      if (!tableColumnGR.u_on_change.nil()) {
	    field.onChangeFunc = 'try { if (SCVarTbl.isFieldChanging(ctl.id) || (SCVarTbl.disableAfterOrdered() ${AND} !SCVarTbl.isCatalogForm())) { return; } SCVarTbl.setFieldChanging(ctl.id, true); ' + tableColumnGR.getValue('u_on_change') + ' } catch(onchangeex) { } SCVarTbl.setFieldChanging(ctl.id, false);';
      }

      field.onClickFunc = '';
      if (!tableColumnGR.u_on_click.nil()) {
        field.onClickFunc = 'if (SCVarTbl.disableAfterOrdered() ${AND} !SCVarTbl.isCatalogForm()) { return; } ' + tableColumnGR.getValue('u_on_click');
      }

      field.img = '';
      if (tableColumnGR.u_icon.getDisplayValue() != '') {
        field.img = '' + tableColumnGR.u_icon.getDisplayValue();
      }

      //gs.log("field=" + field.label + " choice options=" + field.choiceOptions);
      tableColumnList.push(field);
    }

    // Get all non-table fields
    var preFieldList = [];
    var postFieldList = [];
    var preFieldRepeatList = [];
    var postFieldRepeatList = [];
    var nonTableColumnGR = new GlideRecord('u_catalog_table_single_column');
    nonTableColumnGR.addQuery('u_catalog_table_variable', tableVarGR.sys_id);
    nonTableColumnGR.orderBy('u_order');
    nonTableColumnGR.query();
    while (nonTableColumnGR.next()) {
      field = {};

      field.type = 'text';
      if (!nonTableColumnGR.u_type.nil()) {
        field.type = '' + nonTableColumnGR.u_type;
      }

      field.id = '';
      if (!nonTableColumnGR.u_id.nil()) {
        field.id = '' + nonTableColumnGR.u_id;
      }

      field.label = '';
      if (!nonTableColumnGR.u_label.nil()) {
        field.label = '' + nonTableColumnGR.u_label;
      }

      field.cellCSS = '';
      if (!nonTableColumnGR.u_cell_css.nil()) {
        field.cellCSS = '' + nonTableColumnGR.u_cell_css;
      }

      field.labelCSS = '';
      if (!nonTableColumnGR.u_label_css.nil()) {
        field.labelCSS = '' + nonTableColumnGR.u_label_css;
      }

      field.show = 'always';
      if (!nonTableColumnGR.u_show.nil()) {
        field.show = '' + nonTableColumnGR.u_show;
      }

      field.mandatory = 'false';
      if (nonTableColumnGR.u_mandatory) {
        field.mandatory = 'true';
      }

      field.giveFocus = 'false';
      if (nonTableColumnGR.u_give_focus) {
        field.giveFocus = 'true';
      }

      field.reference = '';
      if (!nonTableColumnGR.u_referenced_table.nil()) {
        field.reference = '' + nonTableColumnGR.u_referenced_table;
      }

      field.refQual = '';
      if (!nonTableColumnGR.u_reference_qualifier.nil()) {
        field.refQual = '' + nonTableColumnGR.u_reference_qualifier;
      }

      field.choiceOptions = [];
      if (!nonTableColumnGR.u_choice_list.nil()) {
        // execute the script
        var answer = [];
        if (! nonTableColumnGR.u_choice_list.nil()) {
          //globalNames = ['answer'];
          //globalValues = [answer];
          //answer = GlideEvaluator.evaluateString(nonTableColumnGR.getValue("u_choice_list"), globalNames, globalValues);
          globals = GlideStringUtil.decodeAttributes("answer");
          globals.put("answer", answer);
          answer = GlideEvaluator.evaluateStringWithGlobals(nonTableColumnGR.getValue("u_choice_list"), globals);
          //gs.log("Choice script=" + nonTableColumnGR.getValue("u_choice_list") + " answer=" + answer);
        }
        field.choiceOptions = answer;
      }
	  
      var json = new JSON();
      field.choiceOptions = json.encode(field.choiceOptions);

      field.onChangeFunc = '';
      if (!nonTableColumnGR.u_on_change.nil()) {
        field.onChangeFunc = 'try {if (SCVarTbl.isFieldChanging(ctl.id) || (SCVarTbl.disableAfterOrdered() ${AND} ! SCVarTbl.isCatalogForm())) { return; } SCVarTbl.setFieldChanging(ctl.id, true); ' + nonTableColumnGR.getValue('u_on_change') + ' } catch(onchangeex) { } SCVarTbl.setFieldChanging(ctl.id, false);';
      }

      field.onClickFunc = '';
      if (!nonTableColumnGR.u_on_click.nil()) {
        field.onClickFunc = 'if (SCVarTbl.disableAfterOrdered() ${AND} ! SCVarTbl.isCatalogForm()) { return; } ' + nonTableColumnGR.getValue('u_on_click');
      }

      field.img = '';
      if (nonTableColumnGR.u_icon.getDisplayValue() != '') {
        field.img = '' + nonTableColumnGR.u_icon.getDisplayValue();
      }

      //gs.log("Non-table field=" + field.label + " choice options=" + field.choiceOptions);

      // Put the field in the appropriate array
      if (nonTableColumnGR.u_location == 'before') {
        if (nonTableColumnGR.u_repeat_with_table) {
          preFieldRepeatList.push(field);
        } else {
          preFieldList.push(field);
        }
      } else {
        if (nonTableColumnGR.u_repeat_with_table) {
          postFieldRepeatList.push(field);
        } else {
          postFieldList.push(field);
        }
      }
    }
  &lt;/g:evaluate&gt;

  &lt;j:set var="jvar_table_id" value="scvartbl_${ctvSysID}" /&gt;
  &lt;j:set var="jvar_table_marker" value="var_tables_${ctvSysID}" /&gt;

  &lt;g:evaluate var="jvar_odScript" jelly="true"&gt;
    var odScript = '';
    if (!tableVarGR.u_when_row_deleted.nil()) {
      odScript = tableVarGR.getValue('u_when_row_deleted');
    }
    odScript;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_oaScript" jelly="true"&gt;
    var oaScript = '';
    if (!tableVarGR.u_when_row_added.nil()) {
      oaScript = tableVarGR.getValue('u_when_row_added');
    }
    oaScript;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_initial_table_hdr" jelly="true"&gt;
    var table_hdr = '';
    if (! tableVarGR.u_initial_table_header.nil()) {
      table_hdr = tableVarGR.u_initial_table_header;
    }
    table_hdr;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_table_title" jelly="true"&gt;
    var title = '';
    if (! tableVarGR.u_title.nil()) {
      title = tableVarGR.u_title;
    }
    title;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_result_var" jelly="true"&gt;
    var rVar = 'table_store';
    if (! tableVarGR.u_result_variable.nil()) {
      rVar = tableVarGR.u_result_variable.name;
    }
    rVar;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_disable_table" jelly="true"&gt;
    var disableTbl = false;
    if (tableVarGR.u_disable_after_ordered) {
      disableTbl = true;
    }
    disableTbl;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_allow_multiple" jelly="true"&gt;
    var allowMultiple = false;
    if (tableVarGR.u_allow_multiple_occurrences) {
      allowMultiple = true;
    }
    allowMultiple;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_focus_new" jelly="true"&gt;
    var focusNew = false;
    if (tableVarGR.u_focus_new_row) {
      focusNew = true;
    }
    focusNew;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_button_pos" jelly="true"&gt;
    var buttonPos = 'right';
    if (tableVarGR.u_button_position == 'left') {
      buttonPos = 'left';
    }
    buttonPos;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_max_rows" jelly="true"&gt;
    var maxRows = 0;
    if (!tableVarGR.u_max_rows.nil()) {
      maxRows = tableVarGR.u_max_rows;
    }
    maxRows;
  &lt;/g:evaluate&gt;
  &lt;g:evaluate var="jvar_allow_copy" jelly="true"&gt;
    var allowCopy = false;
    if (tableVarGR.u_allow_copy) {
      allowCopy = true;
    }
    allowCopy;
  &lt;/g:evaluate&gt;
	
  &lt;j:forEach items="${tableColumnList}" var="jvar_field"&gt;
    &lt;g:evaluate jelly="true"&gt;
      var field = jelly.jvar_field;
      var id = field.id + '.';
      var type = field.type;
      var templateid = 'zztemplate' + id + ctvSysID + '.zz';
      var rowmarkerid = id + '__row__';
      var onChangeFunc = field.onChangeFunc;
      var onClickFunc = field.onClickFunc;
      var reference = field.reference;
      var refQual = field.refQual;
      var cellCSS = field.cellCSS;
      var labelCSS = field.labelCSS;
      var choiceOptions = field.choiceOptions;
      var json = new JSON();
      choiceOptions = json.decode(choiceOptions);
      var show = field.show;
    &lt;/g:evaluate&gt;
	&lt;div id="${templateid}" style="display:none"&gt;
    &lt;div id="element.${rowmarkerid}"&gt;
    &lt;j:if test="${type == 'reference'}"&gt;
        &lt;g:inline template="cs_custom_ui_reference" name="${rowmarkerid}" id="${rowmarkerid}" table="${reference}" query="${refQual}"
          onchange="SCVarTblUtil.cellChanged(this);" /&gt;
    &lt;/j:if&gt;

    &lt;j:if test="${type == 'checkbox'}"&gt;
		&lt;input id="sys_original.${rowmarkerid}" name="sys_original.${rowmarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_custom_ui_checkbox" name="${rowmarkerid}" onchange="SCVarTblUtil.cellChanged(gel('${rowmarkerid}'));" /&gt;
    &lt;/j:if&gt;

    &lt;j:if test="${type == 'date'}"&gt;
		&lt;input id="sys_original.${rowmarkerid}" name="sys_original.${rowmarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_ui_date" name="${rowmarkerid}" onchange="SCVarTblUtil.cellChanged(this);" onblur="SCVarTblUtil.isValidDate(this)" /&gt;
    &lt;/j:if&gt;

    &lt;j:if test="${type == 'datetime'}"&gt;
		&lt;input id="sys_original.${rowmarkerid}" name="sys_original.${rowmarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_ui_date_time" name="${rowmarkerid}" onchange="SCVarTblUtil.cellChanged(this);" onblur="SCVarTblUtil.isValidDate(this)" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'text'}"&gt;
		&lt;input id="sys_original.${rowmarkerid}" name="sys_original.${rowmarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_ui_text_field" name="${rowmarkerid}" style="${cellCSS}"
          onchange="SCVarTblUtil.cellChanged(this);" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'choice'}"&gt;
        &lt;g:inline template="cs_ui_cell_choice_input_field" name="${rowmarkerid}" class="questionSetWidget" style="${cellCSS}"
          onchange="SCVarTblUtil.cellChanged(this);"&gt;
          &lt;j:forEach items="${choiceOptions}" var="jvar_choice"&gt;
            &lt;g:evaluate jelly="true"&gt;
              var option = jelly.jvar_choice;
            &lt;/g:evaluate&gt;
            &lt;j:if test="${! option.selected}"&gt;
              &lt;option value="${option.value}"&gt;${option.label}&lt;/option&gt;
            &lt;/j:if&gt;
            &lt;j:if test="${option.selected}"&gt;
              &lt;option value="${option.value}" selected="true"&gt;${option.label}&lt;/option&gt;
            &lt;/j:if&gt;
          &lt;/j:forEach&gt;
        &lt;/g:inline&gt;
    &lt;/j:if&gt;
	&lt;/div&gt;
	&lt;/div&gt;
  &lt;/j:forEach&gt;

  &lt;j:forEach items="${preFieldRepeatList}" var="jvar_prefield"&gt;
    &lt;g:evaluate jelly="true"&gt;
      var preField = jelly.jvar_prefield;
      var id = preField.id + '.';
      var label = preField.label;
      var mandatory = preField.mandatory;
      var type = preField.type;
      var templateid = 'zzprezztemplate' + id + ctvSysID + '.zz';
      var tablemarkerid = id + '__table__';
      var onChangeFunc = preField.onChangeFunc;
      var onClickFunc = preField.onClickFunc;
      var reference = preField.reference;
      var refQual = preField.refQual;
      var cellCSS = preField.cellCSS;
      var labelCSS = preField.labelCSS;
      var show = preField.show;
      var choiceOptions = preField.choiceOptions;
      var json = new JSON();
      choiceOptions = json.decode(choiceOptions);
    &lt;/g:evaluate&gt;
    &lt;div id="${templateid}" style="display:none"&gt;
    &lt;div id="element.${tablemarkerid}"&gt;
    &lt;j:if test="${type == 'reference'}"&gt;
        &lt;g:inline template="cs_form_label" onclick="" mandatory="${mandatory}" for="${tablemarkerid}"&gt;${label}&lt;/g:inline&gt;
        &lt;g:inline template="cs_custom_ui_reference" name="${tablemarkerid}" id="${tablemarkerid}" table="${reference}" query="${refQual}"
          onchange="SCVarTblUtil.fieldChanged(this);" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'checkbox'}"&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_custom_ui_checkbox" label="${label}" name="${tablemarkerid}" onchange="SCVarTblUtil.fieldChanged(this);" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'date'}"&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_form_label" onclick="" mandatory="${mandatory}" for="${tablemarkerid}"&gt;${label}:&lt;/g:inline&gt;
        &lt;g:inline template="cs_ui_date" name="${tablemarkerid}" onchange="SCVarTblUtil.fieldChanged(this);" onblur="SCVarTblUtil.isValidDate(this)" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'datetime'}"&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_form_label" onclick="" mandatory="${mandatory}" for="${tablemarkerid}"&gt;${label}:&lt;/g:inline&gt;
        &lt;g:inline template="ui_date_time" name="${tablemarkerid}" onchange="SCVarTblUtil.fieldChanged(this);" onblur="SCVarTblUtil.isValidDate(this)" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'multiline_text'}"&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_ui_multiline_input_field" name="${tablemarkerid}" label="${label}" mandatory="${mandatory}" style="${cellCSS}" onchange="SCVarTblUtil.fieldChanged(this);" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'text'}"&gt;
		&lt;g:inline template="cs_form_label" onclick="" mandatory="${mandatory}" for="${tablemarkerid}"&gt;${label}:&lt;/g:inline&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
        &lt;g:inline template="cs_ui_text_field" name="${tablemarkerid}" label="${label}" mandatory="${mandatory}" style="${cellCSS}"
          onchange="SCVarTblUtil.fieldChanged(this);" /&gt;
    &lt;/j:if&gt;
    &lt;j:if test="${type == 'choice'}"&gt;
		&lt;input id="sys_original.${tablemarkerid}" name="sys_original.${tablemarkerid}" type="HIDDEN" value="" /&gt;
		&lt;g:inline template="cs_form_label" onclick="" mandatory="${mandatory}" for="${tablemarkerid}"&gt;${label}:&lt;/g:inline&gt;
        &lt;g:inline template="cs_ui_cell_choice_input_field" name="${tablemarkerid}" label="${label}" mandatory="${mandatory}" style="${cellCSS}"
          onchange="SCVarTblUtil.fieldChanged(this);"&gt;
          &lt;j:forEach items="${choiceOptions}" var="jvar_choice"&gt;
            &lt;g:evaluate jelly="true"&gt;
              var option = jelly.jvar_choice;
            &lt;/g:evaluate&gt;
            &lt;j:if test="${! option.selected}"&gt;
              &lt;option value="${option.value}"&gt;${option.label}&lt;/option&gt;
            &lt;/j:if&gt;
            &lt;j:if test="${option.selected}"&gt;
              &lt;option value="${option.value}" selected="true"&gt;${option.label}&lt;/option&gt;
            &lt;/j:if&gt;
          &lt;/j:forEach&gt;
        &lt;/g:inline&gt;
    &lt;/j:if&gt;
	&lt;/div&gt;
	&lt;/div&gt;	
  &lt;/j:forEach&gt;
  &lt;div class="panel panel-default panel-ctv"&gt;
    &lt;j:if test="${jvar_table_title != ''}"&gt;
	  &lt;div class="panel-heading"&gt;&lt;h4&gt;${jvar_table_title}&lt;/h4&gt;&lt;/div&gt;
    &lt;/j:if&gt;
    &lt;div id="${jvar_table_marker}" class="panel-body sc-var-container" style="padding: 5px;"&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;script language="javascript"&gt;
    addLoadEvent(function() {
	  // setup the fields
	  var tableFields = new Array();
      &lt;j:forEach items="${tableColumnList}" var="jvar_field"&gt;
        &lt;g:evaluate jelly="true" object="true"&gt;
          var field = jelly.jvar_field;
          var id = field.id;
          var label = field.label;
          var type = field.type;
          var mandatory = field.mandatory;
		  var readOnly = field.readOnly;
          var giveFocus = field.giveFocus;
          var onChangeFunc = field.onChangeFunc;
          var onClickFunc = field.onClickFunc;
          var reference = field.reference;
          var refQual = field.refQual;
          var choiceOptions = field.choiceOptions;
          var cellCSS = field.cellCSS;
          var labelCSS = field.labelCSS;
		  var maxLength = field.max_length;
          var show = field.show;
          var img = field.img;
        &lt;/g:evaluate&gt;
        tableFields.push(SCVarTbl_defineTableField('${id}', '${label}', '${type}', ${mandatory}, ${readOnly}, ${giveFocus}, '${JS:onChangeFunc}', '${reference}', '${refQual}', '${choiceOptions}', '${cellCSS}', '${labelCSS}', '${show}', '${JS:onClickFunc}', '${img}', '${maxLength}'));
      &lt;/j:forEach&gt;
	  var preTableRepeatFields = new Array();
      &lt;j:forEach items="${preFieldRepeatList}" var="jvar_prefield"&gt;
        &lt;g:evaluate jelly="true" object="true"&gt;
          var preField = jelly.jvar_prefield;
          var id = preField.id;
          var label = preField.label;
          var type = preField.type;
          var mandatory = preField.mandatory;
          var giveFocus = preField.giveFocus;
          var onChangeFunc = preField.onChangeFunc;
          var onClickFunc = preField.onClickFunc;
          var reference = preField.reference;
          var refQual = preField.refQual;
          var choiceOptions = preField.choiceOptions;
          var cellCSS = preField.cellCSS;
          var labelCSS = preField.labelCSS;
          var show = preField.show;
          var img = field.img;
        &lt;/g:evaluate&gt;
        preTableRepeatFields.push(SCVarTbl_defineTableField('${id}', '${label}', '${type}', ${mandatory}, 'false', ${giveFocus}, '${JS:onChangeFunc}', '${reference}', '${refQual}', '${choiceOptions}', '${cellCSS}', '${labelCSS}', '${show}', '${JS:onClickFunc}', '${img}'));
      &lt;/j:forEach&gt;
	  // setup the SCVarTbl
	  // Not yet implemented but still passed as parameters
      var postTableRepeatFields = new Array();
      var preTableFields = new Array();
      var postTableFields = new Array();

      var tableProperties = {};
      tableProperties.tableName = "${jvar_table_id}";
	  tableProperties.sysID = "${ctvSysID}";
      tableProperties.tableLabel = "${jvar_table_title}";
      tableProperties.tableMarker = "${jvar_table_marker}";
      tableProperties.resultVariable = "${jvar_result_var}";
      tableProperties.onAdd = "${JS:jvar_oaScript}";
      tableProperties.onDelete = "${JS:jvar_odScript}";
      tableProperties.allowMultiple = "${jvar_allow_multiple}";
	  tableProperties.maxRows = "${jvar_max_rows}";
	  tableProperties.buttonPosition = "${jvar_button_pos}";
	  tableProperties.focusNew = "${jvar_focus_new}";
      tableProperties.disableAfterOrdered = "${jvar_disable_table}";
	  tableProperties.allowCopy = "${jvar_allow_copy}";
	  var inst = SCVarTbl_createTableUtil(tableProperties, tableFields, preTableRepeatFields, postTableRepeatFields, preTableFields, postTableFields);
	  inst.onLoad("${jvar_initial_table_hdr}");
	  SCVarTblUtil.addInstance(inst);
	  // setup the submit event
	  if (g_form.addCatalogSubmit) {
        g_form.addCatalogSubmit(function() {
		  var ret = SCVarTblUtil.setAllResults();
		  return ret;
	    });
      } else if (addOnSubmitEvent) {
        var form = g_form.getFormElement();
        if (form) {
          addOnSubmitEvent(form, function() {
		    var ret = SCVarTblUtil.setAllResults();
		    return ret;
	      });
        }
      }
	});
  &lt;/script&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d70e0125dbf91744cbe7fb37bf961922</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>sc_var_table</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_section_66bd507804c311003a07ea20df4f9f46</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_ui_section caption="" section_id="66bd507804c311003a07ea20df4f9f46" sys_domain="global" table="u_catalog_table_field" version="3" view=""><sys_ui_element action="INSERT_OR_UPDATE"><element>u_catalog_table_variable</element><position>0</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>8fbb5de24fec130032617e918110c77e</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.begin_split</element><position>1</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>47bb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type>.begin_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_id</element><position>2</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>c7bb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_label</element><position>3</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>4bbb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_type</element><position>4</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>cbbb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_icon</element><position>5</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>4fbb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_referenced_table</element><position>6</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>cfbb5de24fec130032617e918110c77f</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_reference_qualifier</element><position>7</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>43bb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_show</element><position>8</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>c3bb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_max_chars</element><position>9</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>47bb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.split</element><position>10</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>c7bb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type>.split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_order</element><position>11</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>4bbb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_mandatory</element><position>12</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>cbbb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_read_only</element><position>13</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>4fbb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_give_focus</element><position>14</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>cfbb5de24fec130032617e918110c780</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_cell_css</element><position>15</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>43bb5de24fec130032617e918110c781</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_label_css</element><position>16</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>c3bb5de24fec130032617e918110c781</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>.end_split</element><position>17</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>47bb5de24fec130032617e918110c781</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type>.end_split</type></sys_ui_element><sys_ui_element action="INSERT_OR_UPDATE"><element>u_on_click</element><position>18</position><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:02:00</sys_created_on><sys_id>c7bb5de24fec130032617e918110c781</sys_id><sys_mod_count>0</sys_mod_count><sys_ui_formatter/><sys_ui_section caption="NULL" display_value="" name="u_catalog_table_field" sys_domain="global" view="Default view">66bd507804c311003a07ea20df4f9f46</sys_ui_section><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:02:00</sys_updated_on><sys_user/><type/></sys_ui_element><sys_ui_section action="INSERT_OR_UPDATE"><caption/><header>false</header><name>u_catalog_table_field</name><roles/><sys_class_name>sys_ui_section</sys_class_name><sys_created_by>snc-services_SHARE</sys_created_by><sys_created_on>2014-02-19 18:09:27</sys_created_on><sys_customer_update>true</sys_customer_update><sys_domain>global</sys_domain><sys_domain_path>/</sys_domain_path><sys_id>66bd507804c311003a07ea20df4f9f46</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_catalog_table_field</sys_name><sys_overrides display_value="">global</sys_overrides><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_section_66bd507804c311003a07ea20df4f9f46</sys_update_name><sys_updated_by>snc-services_SHARE</sys_updated_by><sys_updated_on>2014-02-19 18:09:27</sys_updated_on><sys_user/><title>true</title><view display_value="Default view" name="NULL">Default view</view><view_name/></sys_ui_section></sys_ui_section></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>d70e0125dbf91744cbe7fb37bf961925</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column</target_name>
<type>Form Layout</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_variable_u_button_position</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_button_position" table="u_catalog_table_variable"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes>edge_encryption_enabled=true</attributes><audit>false</audit><calculation/><choice>3</choice><choice_field/><choice_table/><column_label>Button Position</column_label><comments/><create_roles/><default_value>right</default_value><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_button_position</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="String">string</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_variable</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-28 03:28:10</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>e115e3ed4f64130032617e918110c7a9</sys_id><sys_mod_count>3</sys_mod_count><sys_name>Button Position</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_variable_u_button_position</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-28 14:07:38</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>db0e0125dbf91744cbe7fb37bf96191e</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Catalog Table Variable.Button Position</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_action_2d7a8b804fb8530032617e918110c7ed</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update sys_domain="global" table="sys_ui_action"&gt;&lt;sys_ui_action action="INSERT_OR_UPDATE"&gt;&lt;action_name/&gt;&lt;active&gt;true&lt;/active&gt;&lt;client&gt;false&lt;/client&gt;&lt;comments/&gt;&lt;condition&gt;current.canWrite()&lt;/condition&gt;&lt;form_action&gt;true&lt;/form_action&gt;&lt;form_button&gt;false&lt;/form_button&gt;&lt;form_context_menu&gt;true&lt;/form_context_menu&gt;&lt;form_link&gt;false&lt;/form_link&gt;&lt;form_style/&gt;&lt;hint&gt;Checks if there are any Variable Conflicts (Variables must be unique to use multiple Vars on a single Cat Item)&lt;/hint&gt;&lt;list_action&gt;false&lt;/list_action&gt;&lt;list_banner_button&gt;false&lt;/list_banner_button&gt;&lt;list_button&gt;false&lt;/list_button&gt;&lt;list_choice&gt;false&lt;/list_choice&gt;&lt;list_context_menu&gt;false&lt;/list_context_menu&gt;&lt;list_link&gt;false&lt;/list_link&gt;&lt;list_save_with_form_button&gt;false&lt;/list_save_with_form_button&gt;&lt;list_style/&gt;&lt;name&gt;Check Conflicts&lt;/name&gt;&lt;onclick/&gt;&lt;order&gt;180&lt;/order&gt;&lt;script&gt;&lt;![CDATA[var duplicates = [];
/*{
	table: [],
	nonTable: [],
	ctvs: [],
	vars: []
};*/
var conflicts = [];
var au = new ArrayUtil();

// check for duplicate IDs on the table fields
var grCol = new GlideAggregate('u_catalog_table_field');
grCol.addNotNullQuery('u_id');
grCol.addNotNullQuery('u_catalog_table_variable');
grCol.addAggregate('COUNT', 'u_id');
grCol.query();
while (grCol._next()) {
	if (grCol.getAggregate('COUNT', 'u_id') &gt; 1) {
		duplicates.push({
			field: grCol.getValue('u_id'),
			type: grCol.getTableName(),
			ctvs: [],
			vars: [],
			catItems: [],
		});
	}
}

// check for duplicate IDs on the non-table fields
grCol = new GlideAggregate('u_catalog_table_single_column');
grCol.addNotNullQuery('u_id');
grCol.addNotNullQuery('u_catalog_table_variable');
grCol.addAggregate('COUNT', 'u_id');
grCol.query();
while (grCol._next()) {
	if (grCol.getAggregate('COUNT', 'u_id') &gt; 1) {
		duplicates.push({
			field: grCol.getValue('u_id'),
			type: grCol.getTableName(),
			ctvs: [],
			vars: [],
			catItems: []
		});
	}
}
var msg = [];
for (var d=0; d&lt;duplicates.length; d++) {
	var grVars = new GlideRecord(duplicates[d].type);
	grVars.addQuery('u_id', duplicates[d].field);
	grVars.query();
	while (grVars.next()) {
		duplicates[d].ctvs.push({
			value: grVars.getValue('u_catalog_table_variable'),
			displayValue: grVars.u_catalog_table_variable.getDisplayValue()
		});
		duplicates[d].vars.push(grVars.u_catalog_table_variable.u_variable_set.toString());
	}
	var grSets = new GlideAggregate('io_set_item');
	grSets.addAggregate('COUNT', 'sc_cat_item');
	grSets.addQuery('variable_set', 'IN', duplicates[d].vars.join(','));
	grSets.query();
	while (grSets.next()) {
		if (grSets.getAggregate('COUNT', 'sc_cat_item') &gt; 1) {
			duplicates[d].catItems.push(grSets.sc_cat_item.getDisplayValue());
		}
	}
	if (duplicates[d].catItems.length &gt; 0) {
		msg.push("The following Catalog Items have conflicts for Field Name '" + duplicates[d].field + "': " + duplicates[d].catItems.join(", "));
	}
}
var type='error';
if (msg.length == 0) {
	msg.push('There are no conflicts. You are good to go');
	type = 'info';
}
if (type=='error') {
	gs.addErrorMessage(msg.join("&lt;br /&gt;"));
} else {
	gs.addInfoMessage(msg.join("&lt;br /&gt;"));
}
action.setRedirectURL(current);]]&gt;&lt;/script&gt;&lt;show_insert&gt;false&lt;/show_insert&gt;&lt;show_multiple_update&gt;false&lt;/show_multiple_update&gt;&lt;show_query&gt;false&lt;/show_query&gt;&lt;show_update&gt;true&lt;/show_update&gt;&lt;sys_class_name&gt;sys_ui_action&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-07 21:56:58&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_domain&gt;global&lt;/sys_domain&gt;&lt;sys_domain_path&gt;/&lt;/sys_domain_path&gt;&lt;sys_id&gt;2d7a8b804fb8530032617e918110c7ed&lt;/sys_id&gt;&lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;&lt;sys_name&gt;Check Conflicts&lt;/sys_name&gt;&lt;sys_overrides/&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_action_2d7a8b804fb8530032617e918110c7ed&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-07 21:59:57&lt;/sys_updated_on&gt;&lt;table&gt;u_catalog_table_variable&lt;/table&gt;&lt;ui11_compatible&gt;true&lt;/ui11_compatible&gt;&lt;ui16_compatible&gt;false&lt;/ui16_compatible&gt;&lt;/sys_ui_action&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>db0e0125dbf91744cbe7fb37bf961921</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_variable</table>
<target_name>Check Conflicts</target_name>
<type>UI Action</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_policy_action_dc0c51264fec130032617e918110c754</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_ui_policy_action"><sys_ui_policy_action action="INSERT_OR_UPDATE"><disabled>ignore</disabled><field>u_max_chars</field><mandatory>ignore</mandatory><sys_class_name>sys_ui_policy_action</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-03-02 20:03:21</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>dc0c51264fec130032617e918110c754</sys_id><sys_mod_count>0</sys_mod_count><sys_name>u_max_chars</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_ui_policy_action_dc0c51264fec130032617e918110c754</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-03-02 20:03:21</sys_updated_on><table>u_catalog_table_field</table><ui_policy display_value="Show Max Chars">4ceb55624fac130032617e918110c7b2</ui_policy><visible>true</visible></sys_ui_policy_action></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>db0e0125dbf91744cbe7fb37bf961924</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>u_max_chars</target_name>
<type>UI Policy Action</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_dictionary_u_catalog_table_field_u_read_only</name>
<payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update><sys_dictionary action="INSERT_OR_UPDATE" element="u_read_only" table="u_catalog_table_field"><active>true</active><array>false</array><array_denormalized>false</array_denormalized><attributes/><audit>false</audit><calculation/><choice>0</choice><choice_field/><choice_table/><column_label>Read Only</column_label><comments/><create_roles/><default_value/><defaultsort/><delete_roles/><dependent/><dependent_on_field/><display>false</display><dynamic_creation>false</dynamic_creation><dynamic_creation_script/><dynamic_default_value/><dynamic_ref_qual/><element>u_read_only</element><element_reference>false</element_reference><foreign_database/><function_definition/><function_field>false</function_field><internal_type display_value="">boolean</internal_type><mandatory>false</mandatory><max_length>40</max_length><name>u_catalog_table_field</name><next_element/><primary>false</primary><read_only>false</read_only><read_roles/><reference/><reference_cascade_rule/><reference_floats>false</reference_floats><reference_key/><reference_qual/><reference_qual_condition/><reference_type/><sizeclass/><spell_check>false</spell_check><staged>false</staged><sys_class_name>sys_dictionary</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2018-02-27 21:07:53</sys_created_on><sys_customer_update>false</sys_customer_update><sys_id>070e8a2d4fa0130032617e918110c70c</sys_id><sys_mod_count>0</sys_mod_count><sys_name>Read Only</sys_name><sys_package display_value="Global" source="global">global</sys_package><sys_policy/><sys_replace_on_upgrade>false</sys_replace_on_upgrade><sys_scope display_value="Global">global</sys_scope><sys_update_name>sys_dictionary_u_catalog_table_field_u_read_only</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2018-02-27 21:07:53</sys_updated_on><table_reference>false</table_reference><text_index>false</text_index><unique>false</unique><use_dependent_field>false</use_dependent_field><use_dynamic_default>false</use_dynamic_default><use_reference_qualifier>simple</use_reference_qualifier><virtual>false</virtual><widget/><write_roles/><xml_view>false</xml_view></sys_dictionary></record_update>]]></payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>df0e0125dbf91744cbe7fb37bf96191d</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table>u_catalog_table_field</table>
<target_name>Catalog Table Column.Read Only</target_name>
<type>Dictionary</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_processor_fb52b0ea4f6c130032617e918110c785</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_processor"&gt;&lt;sys_processor action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;class_name/&gt;&lt;description/&gt;&lt;interactive&gt;false&lt;/interactive&gt;&lt;name&gt;ExportCTV&lt;/name&gt;&lt;parameters/&gt;&lt;params_endpoint/&gt;&lt;path&gt;export_ctv&lt;/path&gt;&lt;path_endpoint/&gt;&lt;require_csrf&gt;false&lt;/require_csrf&gt;&lt;roles/&gt;&lt;script&gt;&lt;![CDATA[var sysid = g_request.getParameter('sysparm_sys_id');
var exporter = new ExportWithRelatedLists('u_catalog_table_variable', sysid);
exporter.addRelatedList("u_catalog_table_field", "u_catalog_table_variable");
exporter.addRelatedList("u_catalog_table_single_column", "u_catalog_table_variable");
exporter.addRelatedList("u_catalog_table_column_choice", "u_catalog_table_column.u_catalog_table_variable");
exporter.addRelatedList("u_catalog_table_single_choice", "u_catalog_table_single_column.u_catalog_table_variable");
var grCTV = new GlideRecord('u_catalog_table_variable');
if (grCTV.get(sysid)) {
	// get the variables
	if (!grCTV.u_variable_set.nil()) {
		exporter.addQuerySet('item_option_new_set', 'sys_id=' + grCTV.getValue('u_variable_set') || '');
		exporter.addQuerySet('item_option_new', 'variable_set=' + grCTV.getValue('u_variable_set') || '');
	}
	if (!grCTV.u_ui_macro_name.nil()) {
		// get the macro
		exporter.addQuerySet('sys_ui_macro', 'sys_id=' + grCTV.getValue('u_ui_macro_name') || '');
		// get the widget
		var grVar = new GlideRecord('item_option_new');
		if (grVar.get('macro', grCTV.getValue('u_ui_macro_name') || '') &amp;&amp; grVar.isValidField('sp_widget')) {
			exporter.addQuerySet('sp_widget', 'sys_id=' + grVar.getValue('sp_widget') || '');
		}
	}
}
//include attachments
exporter.setAttachments(true);
exporter.exportRecords(g_response);]]&gt;&lt;/script&gt;&lt;sys_class_name&gt;sys_processor&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2018-03-02 17:01:18&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;false&lt;/sys_customer_update&gt;&lt;sys_id&gt;fb52b0ea4f6c130032617e918110c785&lt;/sys_id&gt;&lt;sys_mod_count&gt;6&lt;/sys_mod_count&gt;&lt;sys_name&gt;ExportCTV&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_processor_fb52b0ea4f6c130032617e918110c785&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-03-08 19:47:34&lt;/sys_updated_on&gt;&lt;type&gt;script&lt;/type&gt;&lt;/sys_processor&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>df0e0125dbf91744cbe7fb37bf961920</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>ExportCTV</target_name>
<type>Processor</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
<sys_update_xml action="INSERT_OR_UPDATE">
<action>INSERT_OR_UPDATE</action>
<application display_value="Global">global</application>
<category>customer</category>
<comments/>
<name>sys_ui_macro_e74f8fda0fffb500d7ebc09ce1050e29</name>
<payload>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;record_update table="sys_ui_macro"&gt;&lt;sys_ui_macro action="INSERT_OR_UPDATE"&gt;&lt;active&gt;true&lt;/active&gt;&lt;category&gt;general&lt;/category&gt;&lt;description&gt;Creates a text input field&amp;#13;
&amp;#13;
Attributes: &amp;#13;
type=the type for the input field, defaults to text&amp;#13;
name= name of the input field&amp;#13;
label=the label of the field&amp;#13;
value= initial value of the field&amp;#13;
onkeyup=the javascript to call onkeyup&amp;#13;
onchange=the javascript to call onchange&amp;#13;
onclick_label=the javascript to call onclick of the label&amp;#13;
mandatory=whether or not this field is madatory, defaults to false&amp;#13;
size=the size of the field&amp;#13;
style=the style of the input field&amp;#13;
readonly=make the input field readonly, defaults to false&amp;#13;
&lt;/description&gt;&lt;media_type/&gt;&lt;name&gt;cs_ui_text_field&lt;/name&gt;&lt;scoped_name/&gt;&lt;sys_class_name&gt;sys_ui_macro&lt;/sys_class_name&gt;&lt;sys_created_by&gt;admin_SHARE&lt;/sys_created_by&gt;&lt;sys_created_on&gt;2015-05-05 22:05:35&lt;/sys_created_on&gt;&lt;sys_customer_update&gt;true&lt;/sys_customer_update&gt;&lt;sys_id&gt;e74f8fda0fffb500d7ebc09ce1050e29&lt;/sys_id&gt;&lt;sys_mod_count&gt;4&lt;/sys_mod_count&gt;&lt;sys_name&gt;cs_ui_text_field&lt;/sys_name&gt;&lt;sys_package display_value="Global" source="global"&gt;global&lt;/sys_package&gt;&lt;sys_policy/&gt;&lt;sys_replace_on_upgrade&gt;false&lt;/sys_replace_on_upgrade&gt;&lt;sys_scope display_value="Global"&gt;global&lt;/sys_scope&gt;&lt;sys_update_name&gt;sys_ui_macro_e74f8fda0fffb500d7ebc09ce1050e29&lt;/sys_update_name&gt;&lt;sys_updated_by&gt;admin&lt;/sys_updated_by&gt;&lt;sys_updated_on&gt;2018-02-09 04:12:09&lt;/sys_updated_on&gt;&lt;xml&gt;&lt;![CDATA[&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;j:jelly trim="true" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null"&gt;
   &lt;g:macro type="text" name="REQUIRED" value="" onkeyup="" onchange="onChange('${jvar_name}');" mandatory="false" size="" style="" readonly="false" maxlength=""/&gt;
   &lt;j:if test="${jvar_readonly == 'false'}"&gt;
     &lt;input type="${jvar_type}" name="${jvar_name}" id="${jvar_name}" value="${jvar_value}" onkeyup="${jvar_onkeyup}" onchange="${jvar_onchange}" class="form-control" size="${jvar_size}" style="${jvar_style}" maxlength="${jvar_maxlength}"/&gt;
   &lt;/j:if&gt;
   &lt;j:if test="${jvar_readonly == 'true'}"&gt;
     &lt;input type="${jvar_type}" readonly="readonly" name="${jvar_name}" id="${jvar_name}" value="${jvar_value}" onkeyup="${jvar_onkeyup}" class="form-control" onchange="${jvar_onchange}" size="${jvar_size}" style="border:0px;background:transparent" maxlength="${jvar_maxlength}"/&gt;
   &lt;/j:if&gt;
&lt;/j:jelly&gt;
]]&gt;&lt;/xml&gt;&lt;/sys_ui_macro&gt;&lt;/record_update&gt;</payload>
<remote_update_set display_value="2nd Service Catalog Table Variable - Kingston Fixes + Service Portal STRY0032027">d30e8de1dbf91744cbe7fb37bf96198e</remote_update_set>
<replace_on_upgrade>false</replace_on_upgrade>
<sys_created_by>zmbaker</sys_created_by>
<sys_created_on>2018-04-30 19:46:47</sys_created_on>
<sys_id>df0e0125dbf91744cbe7fb37bf961923</sys_id>
<sys_mod_count>0</sys_mod_count>
<sys_updated_by>zmbaker</sys_updated_by>
<sys_updated_on>2018-04-30 19:46:47</sys_updated_on>
<table/>
<target_name>cs_ui_text_field</target_name>
<type>Macro</type>
<update_domain>global</update_domain>
<update_set display_value=""/>
<view/>
</sys_update_xml>
</unload>
